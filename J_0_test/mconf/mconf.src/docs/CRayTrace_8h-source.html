<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>MConf: CRayTrace.h Source File</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <meta name="author" content="Yuriy Turkin">
  <meta name="keywords" content="stellarator, w7x, W7-X, W7-X software">
  <meta name="description" content="W7-X Software">
  <link href="myCss.css" rel="stylesheet" type="text/css">
  <link href="tabs.css" rel="stylesheet" type="text/css" >
</head>
<body>
  <div class="centerAll" id="TopOfPage">
    <div class="bodyForAll">
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_8a58aa3034da50da28943871e9137c86.html">include</a>
  </div>
</div>
<div class="contents">
<h1>CRayTrace.h</h1><a href="CRayTrace_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef MC_CRAYTRACE_</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define MC_CRAYTRACE_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include "<a class="code" href="CStconfig_8h.html">CStconfig.h</a>"</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include "<a class="code" href="CArray1d_8h.html">CArray1d.h</a>"</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "<a class="code" href="CArray2d_8h.html">CArray2d.h</a>"</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="keyword">namespace </span>MConf {
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="comment">//****************************************************************************</span>
<a name="l00011"></a>00011 <span class="comment">//                          2004-2005,   Author: yuriy turkin at ipp.mpg.de</span>
<a name="l00012"></a>00012 <span class="comment">// Magnetic configuration of a stellarator</span>
<a name="l00028"></a><a class="code" href="classMConf_1_1CRayTrace.html">00028</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classMConf_1_1CRayTrace.html" title="Find intersections of straight ray with the flux surfaces, this class is obsolete...">CRayTrace</a> : <span class="keyword">public</span> <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> {
<a name="l00029"></a>00029 <span class="keyword">protected</span>:
<a name="l00030"></a><a class="code" href="classMConf_1_1CRayTrace.html#2f14870145817f0d48a47b7e45222197">00030</a>   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CRayTrace.html#2f14870145817f0d48a47b7e45222197" title="origin of ray=rayR0+rayRd*len">rayR0</a>;           
<a name="l00031"></a><a class="code" href="classMConf_1_1CRayTrace.html#91653bb942500d91e5eb82da0535924e">00031</a>   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CRayTrace.html#91653bb942500d91e5eb82da0535924e" title="direction of ray=rayR0+rayRd*len">rayRd</a>;           
<a name="l00032"></a><a class="code" href="classMConf_1_1CRayTrace.html#d0a060915cd706d9d9da14b64068b623">00032</a>   <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;Vector3d&gt;</a> <a class="code" href="classMConf_1_1CRayTrace.html#d0a060915cd706d9d9da14b64068b623" title="2d-array to hold vertixes of the surface">svertex</a>;  
<a name="l00033"></a><a class="code" href="classMConf_1_1CRayTrace.html#02f9e02d0cf3112075f9205d157bc185">00033</a>   <a class="code" href="classMConf_1_1CArray1d.html">CArray1d&lt;Vector3d&gt;</a> <a class="code" href="classMConf_1_1CRayTrace.html#02f9e02d0cf3112075f9205d157bc185" title="array of intersection points of the ray with the surfaces">Rxyz</a>;  
<a name="l00034"></a><a class="code" href="classMConf_1_1CRayTrace.html#7196ea29423dd2365836a1a93b277ea8">00034</a>   <a class="code" href="classMConf_1_1CArray1d.html">CArray1d&lt;double&gt;</a> <a class="code" href="classMConf_1_1CRayTrace.html#7196ea29423dd2365836a1a93b277ea8" title="array of distances from Ray Origin to intersection points">len</a>;     
<a name="l00035"></a><a class="code" href="classMConf_1_1CRayTrace.html#cd25a67433016523a80443a609c6f98f">00035</a>   <a class="code" href="classMConf_1_1CArray1d.html">CArray1d&lt;double&gt;</a> <a class="code" href="classMConf_1_1CRayTrace.html#cd25a67433016523a80443a609c6f98f" title="radius reff, which corresponds intersection points">reffc</a>;   
<a name="l00036"></a><a class="code" href="classMConf_1_1CRayTrace.html#a3f4ee24a6a404ca7203d12199d3d404">00036</a>   <a class="code" href="classMConf_1_1CArray1d.html">CArray1d&lt;double&gt;</a> <a class="code" href="classMConf_1_1CRayTrace.html#a3f4ee24a6a404ca7203d12199d3d404" title="volume inside a surface">vol</a>;     
<a name="l00037"></a><a class="code" href="classMConf_1_1CRayTrace.html#4b788e35210ddddf6002282eed782f58">00037</a>   <a class="code" href="classMConf_1_1CArray1d.html">CArray1d&lt;int&gt;</a> <a class="code" href="classMConf_1_1CRayTrace.html#4b788e35210ddddf6002282eed782f58" title="array of surface numbers">snumber</a>;    
<a name="l00038"></a><a class="code" href="classMConf_1_1CRayTrace.html#16c914e9d34c7be62343f6229dd7fb42">00038</a>   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CRayTrace.html#16c914e9d34c7be62343f6229dd7fb42" title="max number of allocated elements in above arrays">maxTrace</a>;                
<a name="l00039"></a><a class="code" href="classMConf_1_1CRayTrace.html#b1496ea11c1cfe528e2ef5876ecb9f90">00039</a>   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CRayTrace.html#b1496ea11c1cfe528e2ef5876ecb9f90" title="number of actual intersections">sizeTrace</a>;               
<a name="l00040"></a><a class="code" href="classMConf_1_1CRayTrace.html#585d61584c59d0775036f95487d0ff62">00040</a>   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CRayTrace.html#585d61584c59d0775036f95487d0ff62" title="number of surfaces to trace">mNsurf</a>;                  
<a name="l00041"></a>00041 
<a name="l00042"></a>00042   <span class="keywordtype">void</span>   <a class="code" href="classMConf_1_1CRayTrace.html#09bbb73aa0e6ff4e76b1604ca8a6654d" title="Free all memory used by CRayTrace.">freeTrace</a>();
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="keyword">public</span>:
<a name="l00046"></a>00046   <a class="code" href="classMConf_1_1CRayTrace.html#1da8485144ebc7668876c7e63fe311fd" title="The constructor creates an empty instance of CRayTrace.">CRayTrace</a>();
<a name="l00048"></a><a class="code" href="classMConf_1_1CRayTrace.html#c51e403f01cc42c76b104869f959f202">00048</a>   <span class="keyword">virtual</span> <a class="code" href="classMConf_1_1CRayTrace.html#c51e403f01cc42c76b104869f959f202" title="The destructor is a virtual method that frees all memory used.">~CRayTrace</a>() {
<a name="l00049"></a>00049     <a class="code" href="classMConf_1_1CRayTrace.html#09bbb73aa0e6ff4e76b1604ca8a6654d" title="Free all memory used by CRayTrace.">freeTrace</a>(); }
<a name="l00051"></a>00051   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CRayTrace.html#95aa49f9ded7193e7d01a76c7b9e11c3" title="This method frees trace arrays.">clearTrace</a>();
<a name="l00053"></a>00053   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CRayTrace.html#ae048282c7011eedc2e0492f6421ea73" title="This method frees all internal arrays (including base class) and makes this object...">clear</a>();
<a name="l00054"></a>00054 
<a name="l00075"></a>00075   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CRayTrace.html#765e58d91119f8a16b4acdfc8b1b56a7" title="The method traces the Last Closed Magnetic Surface (LCMS).">traceLCMS</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;r1,<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;r2, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;entrypoint,
<a name="l00076"></a>00076          <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;exitpoint, <span class="keywordtype">double</span> dpol=1.,<span class="keywordtype">double</span> dtor=1.);
<a name="l00085"></a>00085   <span class="keywordtype">void</span>   <a class="code" href="classMConf_1_1CRayTrace.html#07f72adaba98435409694ccd6131cc9e" title="The method traces the Last Closed Magnetic Surface (LCMS); obsolete method.">traceLast</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;r0, <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;rd, <span class="keywordtype">double</span> dtheta=0., <span class="keywordtype">double</span> dphi=0.);
<a name="l00099"></a>00099   <span class="keywordtype">void</span>   <a class="code" href="classMConf_1_1CRayTrace.html#8b9884ce6ed0d5fea1a097aa009b3208" title="The method traces magnetic surfaces; obsolete method.">traceAll</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;r0,<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;rd,<span class="keywordtype">double</span> dtheta=0.,<span class="keywordtype">double</span> dphi=0.,<span class="keywordtype">int</span> nSurf=50);
<a name="l00103"></a><a class="code" href="classMConf_1_1CRayTrace.html#94aa565267c63947e882149db2d80f07">00103</a>   <span class="keywordtype">int</span>    <a class="code" href="classMConf_1_1CRayTrace.html#94aa565267c63947e882149db2d80f07" title="The method returns numbers of intersections of the ray with the magnetic surface...">getTraceSize</a>()<span class="keyword"> const    </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CRayTrace.html#b1496ea11c1cfe528e2ef5876ecb9f90" title="number of actual intersections">sizeTrace</a>;}
<a name="l00108"></a><a class="code" href="classMConf_1_1CRayTrace.html#ef69ad938aefa63844d5ce417a936cbc">00108</a>   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> *<a class="code" href="classMConf_1_1CRayTrace.html#ef69ad938aefa63844d5ce417a936cbc" title="The method returns pointer to the array of intersections.">getTraceRxyz</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CRayTrace.html#02f9e02d0cf3112075f9205d157bc185" title="array of intersection points of the ray with the surfaces">Rxyz</a>.<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>(); }
<a name="l00114"></a><a class="code" href="classMConf_1_1CRayTrace.html#c5ad4257b9359a46b4e26db0d967b2ed">00114</a>   <span class="keyword">const</span> <span class="keywordtype">double</span> *<a class="code" href="classMConf_1_1CRayTrace.html#c5ad4257b9359a46b4e26db0d967b2ed" title="The method returns pointer to the array of lengths.">getTraceLen</a>()<span class="keyword"> const    </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CRayTrace.html#7196ea29423dd2365836a1a93b277ea8" title="array of distances from Ray Origin to intersection points">len</a>.<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>();  }
<a name="l00119"></a><a class="code" href="classMConf_1_1CRayTrace.html#02bfb5ef90669463d47e106c2a011938">00119</a>   <span class="keyword">const</span> <span class="keywordtype">double</span> *<a class="code" href="classMConf_1_1CRayTrace.html#02bfb5ef90669463d47e106c2a011938" title="The method returns pointer to the array of effective radii.">getTracereff</a>()<span class="keyword"> const   </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CRayTrace.html#cd25a67433016523a80443a609c6f98f" title="radius reff, which corresponds intersection points">reffc</a>.<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>(); }
<a name="l00124"></a><a class="code" href="classMConf_1_1CRayTrace.html#679d7a37556a5c6f6b4ecaefe14baa60">00124</a>   <span class="keyword">const</span> <span class="keywordtype">double</span> *<a class="code" href="classMConf_1_1CRayTrace.html#679d7a37556a5c6f6b4ecaefe14baa60" title="The method returns pointer to the array of volumes.">getTraceVolume</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CRayTrace.html#a3f4ee24a6a404ca7203d12199d3d404" title="volume inside a surface">vol</a>.<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>();  }
<a name="l00129"></a><a class="code" href="classMConf_1_1CRayTrace.html#c0153a0c21a95161e2058600cff5f7a8">00129</a>   <span class="keyword">const</span> <span class="keywordtype">int</span>    *<a class="code" href="classMConf_1_1CRayTrace.html#c0153a0c21a95161e2058600cff5f7a8" title="The method returns pointer to the array of surface numbers.">getTraceSurfNum</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CRayTrace.html#4b788e35210ddddf6002282eed782f58" title="array of surface numbers">snumber</a>.<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>();}
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 <span class="keyword">private</span>:
<a name="l00133"></a>00133   <span class="keywordtype">bool</span>   resizeTraceList();
<a name="l00135"></a>00135   <span class="keywordtype">void</span>   setRay(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;r0,<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;rd) {<a class="code" href="classMConf_1_1CRayTrace.html#2f14870145817f0d48a47b7e45222197" title="origin of ray=rayR0+rayRd*len">rayR0</a>=r0; <a class="code" href="classMConf_1_1CRayTrace.html#91653bb942500d91e5eb82da0535924e" title="direction of ray=rayR0+rayRd*len">rayRd</a>=rd/rd.<a class="code" href="classMConf_1_1Vector3d.html#8eccd53c4cb659df8fff6d41ae058752" title="Length of Vector3d.">abs</a>();}
<a name="l00138"></a>00138   <span class="keywordtype">bool</span>   buildSurface(<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> nTheta, <span class="keywordtype">int</span> nPhi, <span class="keywordtype">double</span> Phi1, <span class="keywordtype">double</span> Phi2);
<a name="l00140"></a>00140   <span class="keywordtype">void</span>   traceSurface (<span class="keywordtype">int</span> is, <span class="keywordtype">double</span> s, <span class="keyword">const</span> CArray2d&lt;Vector3d&gt; &amp;vertex, <span class="keywordtype">int</span> step=1);
<a name="l00142"></a>00142   <span class="keywordtype">bool</span>   findSegment(<span class="keywordtype">double</span> dtheta,<span class="keywordtype">double</span> dphi,<span class="keywordtype">int</span> &amp;nTheta,<span class="keywordtype">int</span> &amp;nPhi,<span class="keywordtype">double</span> &amp;phi0,<span class="keywordtype">double</span> &amp;phi1);
<a name="l00148"></a>00148   <span class="keywordtype">double</span> isIntersection(<span class="keyword">const</span> Vector3d *<a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>, Vector3d &amp;ri) <span class="keyword">const</span>;
<a name="l00150"></a>00150   <span class="keywordtype">void</span>   addInList(<span class="keywordtype">int</span> is, <span class="keywordtype">double</span> s, <span class="keywordtype">double</span> ln, Vector3d &amp;ri);
<a name="l00152"></a>00152   <span class="keywordtype">void</span>   sort();
<a name="l00153"></a>00153 
<a name="l00165"></a>00165 };
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 };   <span class="comment">//namespace MConf</span>
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 <span class="preprocessor">#endif // C_CRAYTRACE_</span>
</pre></div></div>
    <p><a class="anchor" name="BottomOfPage"></a></p>
    <div class="no-print" align="right">
      <table border="0">
        <tr>
        <td>[ <a class="el" href="#TopOfPage">top</a> ]</td>
        <td>[ <a class="el" href="javascript:history.back(-1);"><b>back</b></a> ]</td> 
        </tr>
      </table>
    </div>
    <hr class="separator">
    <div class="ippAddress" align="right">
      <table border="0">
        <tr>
          <td class="ippAddress">13 Oct 2021 &nbsp;&nbsp;&nbsp;&nbsp;</td>
          <td class="ippAddress">
            <a href="http://www.ipp.mpg.de"><img src="IPP.png" alt="www.ipp.mpg.de" border="0"></a>
          </td>
          <td class="ippAddress">
            <!-- Copyright &copy; 2005-2008<br> --> 
            Max-Planck-Institut<br>f&uuml;r Plasmaphysik
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>
</body>
</html>
