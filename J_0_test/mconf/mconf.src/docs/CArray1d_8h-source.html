<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>MConf: CArray1d.h Source File</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <meta name="author" content="Yuriy Turkin">
  <meta name="keywords" content="stellarator, w7x, W7-X, W7-X software">
  <meta name="description" content="W7-X Software">
  <link href="myCss.css" rel="stylesheet" type="text/css">
  <link href="tabs.css" rel="stylesheet" type="text/css" >
</head>
<body>
  <div class="centerAll" id="TopOfPage">
    <div class="bodyForAll">
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_8a58aa3034da50da28943871e9137c86.html">include</a>
  </div>
</div>
<div class="contents">
<h1>CArray1d.h</h1><a href="CArray1d_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef MC_CArray1d_</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define MC_CArray1d_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include "<a class="code" href="CVector3d_8h.html">CVector3d.h</a>"</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "<a class="code" href="ngarray_8h.html">ngarray.h</a>"</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="keyword">namespace </span>MConf {
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="comment">//*********************************************************************</span>
<a name="l00027"></a><a class="code" href="classMConf_1_1CArray1d.html">00027</a> <span class="comment"></span><span class="keyword">template</span> &lt;<span class="keyword">class</span> TV&gt; <span class="keyword">class </span><a class="code" href="classMConf_1_1CArray1d.html" title="This class provides 1d-array.">CArray1d</a> : <span class="keyword">public</span> pBase::ngArray &lt;TV&gt; {
<a name="l00028"></a>00028   <span class="keywordtype">int</span> dim1;      
<a name="l00029"></a>00029   <span class="keywordtype">int</span> low1;      
<a name="l00030"></a>00030 <span class="keyword">public</span>:
<a name="l00032"></a><a class="code" href="classMConf_1_1CArray1d.html#48a58503c00517e4630ab715a59ad0a0">00032</a>   <a class="code" href="classMConf_1_1CArray1d.html#48a58503c00517e4630ab715a59ad0a0" title="Default constructor.">CArray1d</a>() :pBase::<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#4c68b6c34f5cb6c5c879c9750ef79cd4" title="Create ngArray.">ngArray</a> &lt;TV&gt; () {dim1=low1=0;}
<a name="l00035"></a><a class="code" href="classMConf_1_1CArray1d.html#26c1ff6a08dc9313042ca5f573fc92f7">00035</a>   <a class="code" href="classMConf_1_1CArray1d.html#26c1ff6a08dc9313042ca5f573fc92f7" title="Constructor, creates array with dimention dim1.">CArray1d</a>(<span class="keywordtype">int</span> dim1) {
<a name="l00036"></a>00036     <a class="code" href="classMConf_1_1CArray1d.html#c2d71fe637c407e1784076bdbed1454b" title="The method changes the shape of the array.">resize</a>(0, dim1-1);
<a name="l00037"></a>00037   }
<a name="l00041"></a><a class="code" href="classMConf_1_1CArray1d.html#3249d0c6ee0716fb5610438de67757ad">00041</a>   <a class="code" href="classMConf_1_1CArray1d.html#3249d0c6ee0716fb5610438de67757ad" title="Constructor.">CArray1d</a>(<span class="keywordtype">int</span> low1,<span class="keywordtype">int</span> upper1) { <span class="comment">// array with 1st index from 'low1' to 'upper1',</span>
<a name="l00042"></a>00042     <a class="code" href="classMConf_1_1CArray1d.html#c2d71fe637c407e1784076bdbed1454b" title="The method changes the shape of the array.">resize</a>(low1,upper1);
<a name="l00043"></a>00043   }
<a name="l00046"></a><a class="code" href="classMConf_1_1CArray1d.html#f91b710fd2b0815752335a91dcbba07e">00046</a>   <a class="code" href="classMConf_1_1CArray1d.html#f91b710fd2b0815752335a91dcbba07e" title="Copy constructor, creates array with the same content and shape as z.">CArray1d</a>(<a class="code" href="classMConf_1_1CArray1d.html" title="This class provides 1d-array.">CArray1d</a> <span class="keyword">const</span> &amp;z) { *<span class="keyword">this</span> = z; }
<a name="l00049"></a><a class="code" href="classMConf_1_1CArray1d.html#62010d7842c446c13ac25659634bb998">00049</a>   <a class="code" href="classMConf_1_1CArray1d.html#62010d7842c446c13ac25659634bb998" title="Copy constructor, creates array1d with the same content z.">CArray1d</a>(TV * z, <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CArray1d.html#b8e4e3e2a7bf18888b71bdf9dda0770b" title="get the the first dimention of the array.">size</a>) {
<a name="l00050"></a>00050     this-&gt;<a class="code" href="classMConf_1_1CArray1d.html#9bd1a6aa8f5dccbf305d5d2561b1fc2f" title="The method creates array from TV * z.">assign</a>(z, size);
<a name="l00051"></a>00051   }
<a name="l00054"></a><a class="code" href="classMConf_1_1CArray1d.html#9bd1a6aa8f5dccbf305d5d2561b1fc2f">00054</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CArray1d.html#9bd1a6aa8f5dccbf305d5d2561b1fc2f" title="The method creates array from TV * z.">assign</a>(<span class="keyword">const</span> TV * z, <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CArray1d.html#b8e4e3e2a7bf18888b71bdf9dda0770b" title="get the the first dimention of the array.">size</a>) {
<a name="l00055"></a>00055     this-&gt;<a class="code" href="classMConf_1_1CArray1d.html#c2d71fe637c407e1784076bdbed1454b" title="The method changes the shape of the array.">resize</a>(size);
<a name="l00056"></a>00056     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;size; i++) this-&gt;<a class="code" href="classMConf_1_1CArray1d.html#53cea1d76da52bd39cd93b4e7cbb9ae4" title="The operator returns the reference to the array element.">at</a>(i) = z[i];
<a name="l00057"></a>00057     <span class="keywordflow">return</span> this-&gt;<a class="code" href="classMConf_1_1CArray1d.html#78990418d548a9f25399f370f2d2d482" title="The method returns true if no error occurs for the last operation with array.">isOK</a>(); 
<a name="l00058"></a>00058   }
<a name="l00061"></a><a class="code" href="classMConf_1_1CArray1d.html#2229c2a34e9818b41644de4427abaa2e">00061</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CArray1d.html#2229c2a34e9818b41644de4427abaa2e" title="The method scales array.">scale</a>(<span class="keyword">const</span> TV fact) {
<a name="l00062"></a>00062     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classMConf_1_1CArray1d.html#b8e4e3e2a7bf18888b71bdf9dda0770b" title="get the the first dimention of the array.">size</a>(); i++) this-&gt;<a class="code" href="classMConf_1_1CArray1d.html#53cea1d76da52bd39cd93b4e7cbb9ae4" title="The operator returns the reference to the array element.">at</a>(i) *= fact;
<a name="l00063"></a>00063     <span class="keywordflow">return</span> this-&gt;<a class="code" href="classMConf_1_1CArray1d.html#78990418d548a9f25399f370f2d2d482" title="The method returns true if no error occurs for the last operation with array.">isOK</a>(); 
<a name="l00064"></a>00064   }
<a name="l00066"></a><a class="code" href="classMConf_1_1CArray1d.html#78990418d548a9f25399f370f2d2d482">00066</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CArray1d.html#78990418d548a9f25399f370f2d2d482" title="The method returns true if no error occurs for the last operation with array.">isOK</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> !this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#c6e61de369e994009e36f344f99c15ad" title="return whether the array is empty">empty</a>();}
<a name="l00068"></a><a class="code" href="classMConf_1_1CArray1d.html#b8e4e3e2a7bf18888b71bdf9dda0770b">00068</a>   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CArray1d.html#b8e4e3e2a7bf18888b71bdf9dda0770b" title="get the the first dimention of the array.">size</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> dim1;}
<a name="l00070"></a><a class="code" href="classMConf_1_1CArray1d.html#cb92914fe2f01052861a650cbd9b7290">00070</a>   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CArray1d.html#cb92914fe2f01052861a650cbd9b7290" title="get the first value of the first array index.">lowbound</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> low1;}
<a name="l00072"></a><a class="code" href="classMConf_1_1CArray1d.html#9e94f473a6f9d3cad6da4a7c074d1876">00072</a>   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CArray1d.html#9e94f473a6f9d3cad6da4a7c074d1876" title="get the last value of the first array index.">upperbound</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> low1+dim1-1;}
<a name="l00074"></a><a class="code" href="classMConf_1_1CArray1d.html#6be8be676fe4560caabf831b227b8cf2">00074</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CArray1d.html#6be8be676fe4560caabf831b227b8cf2" title="check whether indexes within bounds">isIndexOK</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const </span>{
<a name="l00075"></a>00075     <span class="keywordflow">return</span> (i&lt;low1||i&gt;<a class="code" href="classMConf_1_1CArray1d.html#9e94f473a6f9d3cad6da4a7c074d1876" title="get the last value of the first array index.">upperbound</a>())?<span class="keyword">false</span>:<span class="keyword">true</span>;
<a name="l00076"></a>00076   }
<a name="l00081"></a><a class="code" href="classMConf_1_1CArray1d.html#33ce2a09c86c35d3811376c60426a8fc">00081</a>  <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CArray1d.html#33ce2a09c86c35d3811376c60426a8fc" title="Perform a binary search of the segment in which given value lies.">bsearch</a>(<span class="keywordtype">double</span> u)<span class="keyword"> const</span>
<a name="l00082"></a>00082 <span class="keyword">  </span>{
<a name="l00083"></a>00083     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#c6e61de369e994009e36f344f99c15ad" title="return whether the array is empty">empty</a>()) <span class="keywordflow">return</span> 0;
<a name="l00084"></a>00084     <span class="keywordtype">int</span> L = 0;       <span class="comment">// Left bracket</span>
<a name="l00085"></a>00085     <span class="keywordtype">int</span> R = dim1-1;  <span class="comment">// Right bracket</span>
<a name="l00086"></a>00086     <span class="keyword">const</span> TV * x = this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>();
<a name="l00087"></a>00087 
<a name="l00088"></a>00088     <span class="keywordflow">if</span>(u&lt;=x[0]) <span class="keywordflow">return</span> L;
<a name="l00089"></a>00089     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(u&gt;=x[R]) L=R-1;
<a name="l00090"></a>00090     <span class="keywordflow">else</span>
<a name="l00091"></a>00091       <span class="keywordflow">while</span>(L+1 &lt; R) {  <span class="comment">// bisection</span>
<a name="l00092"></a>00092         <span class="keywordtype">int</span> k = (L + R)/2;
<a name="l00093"></a>00093         <span class="keywordflow">if</span>(u &lt; x[k]) R = k;
<a name="l00094"></a>00094         <span class="keywordflow">else</span> L = k;
<a name="l00095"></a>00095       }
<a name="l00096"></a>00096     <span class="keywordflow">return</span> L+low1;
<a name="l00097"></a>00097   }
<a name="l00098"></a>00098 
<a name="l00105"></a><a class="code" href="classMConf_1_1CArray1d.html#4ee9f6e8d9d936844617ff8cc7ea5efa">00105</a>   TV <a class="code" href="classMConf_1_1CArray1d.html#4ee9f6e8d9d936844617ff8cc7ea5efa" title="Linear interpolation of this array in x with Xa as the abscissa array.">interp1</a>(<span class="keywordtype">double</span> x, <span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray1d.html">CArray1d&lt;double&gt;</a> &amp;Xa)<span class="keyword"> const</span>
<a name="l00106"></a>00106 <span class="keyword">  </span>{
<a name="l00107"></a>00107     <span class="keywordtype">int</span> L = Xa.<a class="code" href="classMConf_1_1CArray1d.html#33ce2a09c86c35d3811376c60426a8fc" title="Perform a binary search of the segment in which given value lies.">bsearch</a>(x);
<a name="l00108"></a>00108     <span class="keywordtype">int</span> R = L+1;
<a name="l00109"></a>00109     <span class="keyword">const</span> TV * y = this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>()-low1; 
<a name="l00110"></a>00110     TV yp= (y[R]-y[L])/(Xa[R]-Xa[L]); <span class="comment">// derivative in point x</span>
<a name="l00111"></a>00111     <span class="keywordflow">return</span>(y[L] + yp*(x-Xa[L]));
<a name="l00112"></a>00112   }
<a name="l00113"></a>00113 
<a name="l00118"></a><a class="code" href="classMConf_1_1CArray1d.html#7fb8716d18806e5f9d509fa8e5b2bace">00118</a>   TV <a class="code" href="classMConf_1_1CArray1d.html#7fb8716d18806e5f9d509fa8e5b2bace" title="Quadratic interpolation of this array in x with Xa as the abscissa array.">interp2</a>(<span class="keywordtype">double</span> x, <span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray1d.html">CArray1d&lt;double&gt;</a> &amp;Xa)<span class="keyword"> const</span>
<a name="l00119"></a>00119 <span class="keyword">  </span>{
<a name="l00120"></a>00120     <span class="keywordtype">int</span> N = Xa.<a class="code" href="classMConf_1_1CArray1d.html#b8e4e3e2a7bf18888b71bdf9dda0770b" title="get the the first dimention of the array.">size</a>();
<a name="l00121"></a>00121     <span class="keywordtype">int</span> L = Xa.<a class="code" href="classMConf_1_1CArray1d.html#33ce2a09c86c35d3811376c60426a8fc" title="Perform a binary search of the segment in which given value lies.">bsearch</a>(x);
<a name="l00122"></a>00122     <span class="keywordflow">if</span>(L+2&gt;=N) L=N-3;
<a name="l00123"></a>00123     <span class="keyword">const</span> TV * y = this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>()-low1; 
<a name="l00124"></a>00124     <span class="keywordtype">double</span> y0 = y[L  ];
<a name="l00125"></a>00125     <span class="keywordtype">double</span> y1 = y[L+1];
<a name="l00126"></a>00126     <span class="keywordtype">double</span> y2 = y[L+2];
<a name="l00127"></a>00127     <span class="keywordtype">double</span> x0 = Xa[L  ];
<a name="l00128"></a>00128     <span class="keywordtype">double</span> x1 = Xa[L+1];
<a name="l00129"></a>00129     <span class="keywordtype">double</span> x2 = Xa[L+2];
<a name="l00130"></a>00130     <span class="keywordtype">double</span> c1=(y1-y0)/(x1-x0);
<a name="l00131"></a>00131     <span class="keywordtype">double</span> c2=(y2-y1)/(x2-x1);
<a name="l00132"></a>00132     c2=(c2-c1)/(x2-x0);
<a name="l00133"></a>00133     <span class="keywordflow">return</span>  y0 + (c1 + c2*(x-x1))*(x-x0);
<a name="l00134"></a>00134   }
<a name="l00135"></a>00135 
<a name="l00139"></a><a class="code" href="classMConf_1_1CArray1d.html#53cea1d76da52bd39cd93b4e7cbb9ae4">00139</a>   TV &amp;              <a class="code" href="classMConf_1_1CArray1d.html#53cea1d76da52bd39cd93b4e7cbb9ae4" title="The operator returns the reference to the array element.">at</a>(<span class="keywordtype">int</span> i)       {<span class="keywordflow">return</span> this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#3e0bf3b69e8c376215d31b1a6b1db334" title="Returns memory pointer.">array</a>()[i-low1]; }
<a name="l00143"></a><a class="code" href="classMConf_1_1CArray1d.html#0ff36e31fa26a6c6eda76fa6bec1f373">00143</a>   TV *              <a class="code" href="classMConf_1_1CArray1d.html#0ff36e31fa26a6c6eda76fa6bec1f373" title="The operator returns the address to the memory allocated for the array.">rw</a>()            {<span class="keywordflow">return</span> this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#3e0bf3b69e8c376215d31b1a6b1db334" title="Returns memory pointer.">array</a>() - low1; }  <span class="comment">// read/write access</span>
<a name="l00144"></a><a class="code" href="classMConf_1_1CArray1d.html#73152a3c35cc499a1e77a3dadeefcee1">00144</a>   <span class="keyword">const</span> TV &amp;<a class="code" href="classMConf_1_1CArray1d.html#73152a3c35cc499a1e77a3dadeefcee1" title="Returns a constant reference to the element at i.">operator[]</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const </span>{<span class="keywordflow">return</span> this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>()[i-low1]; }
<a name="l00145"></a>00145   <span class="comment">//TV &amp;      operator[](int i)       {return this-&gt;array()[i-low1]; }</span>
<a name="l00146"></a>00146   <span class="comment">// allow direct write access to data in order to avoid copy on-write </span>
<a name="l00147"></a><a class="code" href="classMConf_1_1CArray1d.html#c2050412beb199d5b58c51909d98ec67">00147</a>   TV &amp;              <a class="code" href="classMConf_1_1CArray1d.html#c2050412beb199d5b58c51909d98ec67">w</a>(<span class="keywordtype">int</span> i)        {<span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span>TV &amp;<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>()[i-low1]); } 
<a name="l00148"></a><a class="code" href="classMConf_1_1CArray1d.html#6c00d8e1b3ad5a831e6e859f0e0ce001">00148</a>   TV *              <a class="code" href="classMConf_1_1CArray1d.html#6c00d8e1b3ad5a831e6e859f0e0ce001">w</a>()             {<span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span>TV *<span class="keyword">&gt;</span>(this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>() - low1); } 
<a name="l00149"></a>00149   
<a name="l00151"></a><a class="code" href="classMConf_1_1CArray1d.html#2efa0a37c0b7fc6af037c22af910de53">00151</a>   <a class="code" href="classMConf_1_1CArray1d.html" title="This class provides 1d-array.">CArray1d</a> &amp;<a class="code" href="classMConf_1_1CArray1d.html#2efa0a37c0b7fc6af037c22af910de53" title="The operator assigns x to all elements.">operator = </a>(<span class="keyword">const</span> TV &amp; x) {
<a name="l00152"></a>00152     this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#7aead12789ef0d00c7aef9e091e3dddf" title="initialize all elements with a constant value.">fill</a>(x);
<a name="l00153"></a>00153     <span class="keywordflow">return</span>( *<span class="keyword">this</span> );
<a name="l00154"></a>00154   }
<a name="l00155"></a>00155 
<a name="l00157"></a><a class="code" href="classMConf_1_1CArray1d.html#405122ed78a0ae2bb7149c1a3267aa66">00157</a>   <a class="code" href="classMConf_1_1CArray1d.html" title="This class provides 1d-array.">CArray1d</a> &amp; <a class="code" href="classMConf_1_1CArray1d.html#2efa0a37c0b7fc6af037c22af910de53" title="The operator assigns x to all elements.">operator = </a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray1d.html" title="This class provides 1d-array.">CArray1d</a> &amp; z) {
<a name="l00158"></a>00158     <span class="keywordflow">if</span> (<span class="keyword">this</span> != &amp;z) {
<a name="l00159"></a>00159       this-&gt;dim1 = z.<a class="code" href="classMConf_1_1CArray1d.html#c0eaa52fd9b204be8c83a7d2931a0a5a" title="1st dimention of the array">dim1</a>;
<a name="l00160"></a>00160       this-&gt;low1 = z.<a class="code" href="classMConf_1_1CArray1d.html#63bb918abfea8f921da270f59d90537b" title="low bound of the array">low1</a>;
<a name="l00161"></a>00161       <a class="code" href="classMConf_1_1pBase_1_1ngArray.html">pBase::ngArray &lt;TV&gt;</a>  *ptr = <span class="keyword">this</span>;
<a name="l00162"></a>00162       ptr-&gt;operator=(z);
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164     <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00165"></a>00165   }
<a name="l00166"></a>00166   
<a name="l00173"></a><a class="code" href="classMConf_1_1CArray1d.html#18c56d85035eae11d8cbd9fbdc86b764">00173</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CArray1d.html#18c56d85035eae11d8cbd9fbdc86b764" title="The method changes the dimentions of the array.">init</a>(<span class="keywordtype">int</span> dim) 
<a name="l00174"></a>00174   {
<a name="l00175"></a>00175     <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CArray1d.html#c2d71fe637c407e1784076bdbed1454b" title="The method changes the shape of the array.">resize</a>(dim);
<a name="l00176"></a>00176   }
<a name="l00184"></a><a class="code" href="classMConf_1_1CArray1d.html#a71834a74bc47c1062c27363ad99b5b6">00184</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CArray1d.html#18c56d85035eae11d8cbd9fbdc86b764" title="The method changes the dimentions of the array.">init</a>(<span class="keywordtype">int</span> low,<span class="keywordtype">int</span> upper, <span class="keyword">const</span> TV &amp; val = TV()) 
<a name="l00185"></a>00185   {
<a name="l00186"></a>00186     <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CArray1d.html#c2d71fe637c407e1784076bdbed1454b" title="The method changes the shape of the array.">resize</a>(low,upper,val);
<a name="l00187"></a>00187   }
<a name="l00194"></a><a class="code" href="classMConf_1_1CArray1d.html#c2d71fe637c407e1784076bdbed1454b">00194</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CArray1d.html#c2d71fe637c407e1784076bdbed1454b" title="The method changes the shape of the array.">resize</a>(<span class="keywordtype">int</span> low,<span class="keywordtype">int</span> upper, <span class="keyword">const</span> TV &amp; val = TV()) { <span class="comment">// 1st index from 'low' to 'upper',</span>
<a name="l00195"></a>00195     this-&gt;low1 = low;                         
<a name="l00196"></a>00196     this-&gt;dim1 = upper-low+1;
<a name="l00197"></a>00197 <span class="comment">//  pBase::ngArray &lt;TV&gt;  *ptr = this;</span>
<a name="l00198"></a>00198 <span class="comment">//  ptr-&gt;init(dim1*dim2);</span>
<a name="l00199"></a>00199     (<span class="keyword">dynamic_cast&lt;</span><a class="code" href="classMConf_1_1pBase_1_1ngArray.html">pBase::ngArray&lt;TV&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>))-&gt;init(0,dim1-1,val);    
<a name="l00200"></a>00200     <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CArray1d.html#78990418d548a9f25399f370f2d2d482" title="The method returns true if no error occurs for the last operation with array.">isOK</a>();
<a name="l00201"></a>00201   }
<a name="l00206"></a><a class="code" href="classMConf_1_1CArray1d.html#c95c82d490669bcfb1fc8946e2fad549">00206</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CArray1d.html#c2d71fe637c407e1784076bdbed1454b" title="The method changes the shape of the array.">resize</a>(<span class="keywordtype">int</span> dim)
<a name="l00207"></a>00207   {
<a name="l00208"></a>00208     <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CArray1d.html#c2d71fe637c407e1784076bdbed1454b" title="The method changes the shape of the array.">resize</a>(0, dim-1);
<a name="l00209"></a>00209   }
<a name="l00210"></a>00210 
<a name="l00216"></a><a class="code" href="classMConf_1_1CArray1d.html#c8bb3912a3ce86b15842e79d0b421204">00216</a>   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CArray1d.html#c8bb3912a3ce86b15842e79d0b421204" title="The method frees memory This function will clear the array.">clear</a>() {
<a name="l00217"></a>00217     dim1=low1=0;
<a name="l00218"></a>00218     (<span class="keyword">dynamic_cast&lt;</span><a class="code" href="classMConf_1_1pBase_1_1ngArray.html">pBase::ngArray&lt;TV&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>))-&gt;clear();
<a name="l00219"></a>00219   }
<a name="l00220"></a>00220 
<a name="l00222"></a><a class="code" href="classMConf_1_1CArray1d.html#3a3ab31c19c38fe926198ddc4a0a4a91">00222</a>   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CArray1d.html#3a3ab31c19c38fe926198ddc4a0a4a91" title="The method prints all elements of the array.">print</a>()<span class="keyword"> const </span>{<span class="keywordflow">if</span>(<a class="code" href="classMConf_1_1CArray1d.html#78990418d548a9f25399f370f2d2d482" title="The method returns true if no error occurs for the last operation with array.">isOK</a>()) {TV <a class="code" href="classMConf_1_1CArray1d.html#6c00d8e1b3ad5a831e6e859f0e0ce001">w</a>=1; <a class="code" href="classMConf_1_1CArray1d.html#3a3ab31c19c38fe926198ddc4a0a4a91" title="The method prints all elements of the array.">print</a>(w);} }
<a name="l00234"></a><a class="code" href="classMConf_1_1CArray1d.html#ce0dc5cb11e47c006a0038690ddebcec">00234</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">size_t</span> <a class="code" href="classMConf_1_1CArray1d.html#ce0dc5cb11e47c006a0038690ddebcec" title="Write into binary file.">write</a>(T x, FILE *fp)<span class="keyword"> const </span>{
<a name="l00235"></a>00235     <span class="keywordflow">if</span>(!<a class="code" href="classMConf_1_1CArray1d.html#78990418d548a9f25399f370f2d2d482" title="The method returns true if no error occurs for the last operation with array.">isOK</a>()) <span class="keywordflow">return</span> 0;
<a name="l00236"></a>00236     fwrite(&amp;dim1,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1,fp);
<a name="l00237"></a>00237     fwrite(&amp;low1,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1,fp);
<a name="l00238"></a>00238     TV <a class="code" href="classMConf_1_1CArray1d.html#6c00d8e1b3ad5a831e6e859f0e0ce001">w</a>=1;
<a name="l00239"></a>00239     <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CArray1d.html#ce0dc5cb11e47c006a0038690ddebcec" title="Write into binary file.">write</a>(w,x,fp);
<a name="l00240"></a>00240   }
<a name="l00251"></a><a class="code" href="classMConf_1_1CArray1d.html#42ee13bdf97e875f76cd807fd132db6d">00251</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">size_t</span> <a class="code" href="classMConf_1_1CArray1d.html#42ee13bdf97e875f76cd807fd132db6d" title="Read from binary file the array that was written by write() method.">read</a>(T x, FILE *fp) {
<a name="l00252"></a>00252     fread(&amp;dim1,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1,fp);
<a name="l00253"></a>00253     fread(&amp;low1,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1,fp);
<a name="l00254"></a>00254     <span class="keywordtype">int</span> upper1 = dim1+low1-1;
<a name="l00255"></a>00255     <span class="keywordflow">if</span>(!<a class="code" href="classMConf_1_1CArray1d.html#c2d71fe637c407e1784076bdbed1454b" title="The method changes the shape of the array.">resize</a>(low1,upper1)) <span class="keywordflow">return</span> 0;
<a name="l00256"></a>00256     TV <a class="code" href="classMConf_1_1CArray1d.html#6c00d8e1b3ad5a831e6e859f0e0ce001">w</a>=1;
<a name="l00257"></a>00257     <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CArray1d.html#42ee13bdf97e875f76cd807fd132db6d" title="Read from binary file the array that was written by write() method.">read</a>(w,x,fp);
<a name="l00258"></a>00258   }
<a name="l00261"></a><a class="code" href="classMConf_1_1CArray1d.html#f147bf41d89e9ad0d9e1893ffea4cede">00261</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">size_t</span> <a class="code" href="classMConf_1_1CArray1d.html#f147bf41d89e9ad0d9e1893ffea4cede" title="The same as write() but the shape of the array are not saved, only dimensions are...">write0</a>(T x, FILE *fp)<span class="keyword"> const </span>{
<a name="l00262"></a>00262     <span class="keywordflow">if</span>(!<a class="code" href="classMConf_1_1CArray1d.html#78990418d548a9f25399f370f2d2d482" title="The method returns true if no error occurs for the last operation with array.">isOK</a>()) <span class="keywordflow">return</span> 0;
<a name="l00263"></a>00263     fwrite(&amp;dim1,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1,fp);
<a name="l00264"></a>00264     TV <a class="code" href="classMConf_1_1CArray1d.html#6c00d8e1b3ad5a831e6e859f0e0ce001">w</a>=1;
<a name="l00265"></a>00265     <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CArray1d.html#ce0dc5cb11e47c006a0038690ddebcec" title="Write into binary file.">write</a>(w,x,fp);
<a name="l00266"></a>00266   }
<a name="l00269"></a><a class="code" href="classMConf_1_1CArray1d.html#ffa2cb0b4bb4a7a19f0ee51346e51748">00269</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">size_t</span> <a class="code" href="classMConf_1_1CArray1d.html#ffa2cb0b4bb4a7a19f0ee51346e51748" title="The method reads the array that was written by write0() method.">read0</a>(T x, FILE *fp) {
<a name="l00270"></a>00270     fread(&amp;dim1,<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>),1,fp);
<a name="l00271"></a>00271     <span class="keywordflow">if</span>(!<a class="code" href="classMConf_1_1CArray1d.html#c2d71fe637c407e1784076bdbed1454b" title="The method changes the shape of the array.">resize</a>(dim1)) <span class="keywordflow">return</span> 0;
<a name="l00272"></a>00272     TV <a class="code" href="classMConf_1_1CArray1d.html#6c00d8e1b3ad5a831e6e859f0e0ce001">w</a>=1;
<a name="l00273"></a>00273     <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CArray1d.html#42ee13bdf97e875f76cd807fd132db6d" title="Read from binary file the array that was written by write() method.">read</a>(w,x,fp);
<a name="l00274"></a>00274   }
<a name="l00275"></a>00275 
<a name="l00276"></a>00276 <span class="keyword">private</span>:
<a name="l00277"></a>00277   TV &amp;This      (<span class="keywordtype">int</span> i)       {<span class="keywordflow">return</span> this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#3e0bf3b69e8c376215d31b1a6b1db334" title="Returns memory pointer.">array</a>()     [i]; }
<a name="l00278"></a>00278   <span class="keyword">const</span> TV &amp;This(<span class="keywordtype">int</span> i)<span class="keyword"> const </span>{<span class="keywordflow">return</span> this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>()[i]; }
<a name="l00279"></a>00279 
<a name="l00281"></a>00281   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CArray1d.html#3a3ab31c19c38fe926198ddc4a0a4a91" title="The method prints all elements of the array.">print</a>(<span class="keywordtype">double</span> u)<span class="keyword"> const </span>{ <span class="comment">// TV is float or double</span>
<a name="l00282"></a>00282     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;dim1; i++) 
<a name="l00283"></a>00283       printf(<span class="stringliteral">"%g "</span>, This(i));
<a name="l00284"></a>00284     printf(<span class="stringliteral">"\n"</span>);
<a name="l00285"></a>00285     
<a name="l00286"></a>00286   }
<a name="l00287"></a>00287   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CArray1d.html#3a3ab31c19c38fe926198ddc4a0a4a91" title="The method prints all elements of the array.">print</a>(<span class="keywordtype">int</span> u)<span class="keyword"> const </span>{ <span class="comment">// TV is int or char</span>
<a name="l00288"></a>00288     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;dim1; i++) 
<a name="l00289"></a>00289       printf(<span class="stringliteral">"%d "</span>, This(i));
<a name="l00290"></a>00290     printf(<span class="stringliteral">"\n"</span>);
<a name="l00291"></a>00291   }
<a name="l00293"></a>00293   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CArray1d.html#3a3ab31c19c38fe926198ddc4a0a4a91" title="The method prints all elements of the array.">print</a>(Vector3d &amp;u)<span class="keyword"> const </span>{
<a name="l00294"></a>00294     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;dim1; i++)
<a name="l00295"></a>00295       This(i).print();
<a name="l00296"></a>00296   }
<a name="l00298"></a>00298   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">size_t</span> <a class="code" href="classMConf_1_1CArray1d.html#ce0dc5cb11e47c006a0038690ddebcec" title="Write into binary file.">write</a>(<span class="keywordtype">double</span> u, T x, FILE *fp)<span class="keyword"> const </span>{<span class="comment">//TV is float,double or char</span>
<a name="l00299"></a>00299     <span class="keywordtype">size_t</span> cnt=0;
<a name="l00300"></a>00300     T <a class="code" href="classMConf_1_1CArray1d.html#6c00d8e1b3ad5a831e6e859f0e0ce001">w</a>;
<a name="l00301"></a>00301     <span class="keywordtype">size_t</span> wsize = <span class="keyword">sizeof</span>(w);
<a name="l00302"></a>00302     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;dim1; i++) {
<a name="l00303"></a>00303       w=T(This(i));
<a name="l00304"></a>00304       cnt+=fwrite(&amp;w, wsize,1,fp);
<a name="l00305"></a>00305     }
<a name="l00306"></a>00306     <span class="keywordflow">return</span> cnt;
<a name="l00307"></a>00307   }
<a name="l00309"></a>00309   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">size_t</span> <a class="code" href="classMConf_1_1CArray1d.html#ce0dc5cb11e47c006a0038690ddebcec" title="Write into binary file.">write</a>(Vector3d &amp;u, T x, FILE *fp)<span class="keyword"> const </span>{
<a name="l00310"></a>00310     <span class="keywordtype">size_t</span> cnt=0;
<a name="l00311"></a>00311     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;dim1; i++)
<a name="l00312"></a>00312       cnt+=This(i).write(x,fp);
<a name="l00313"></a>00313     <span class="keywordflow">return</span> cnt;
<a name="l00314"></a>00314   }
<a name="l00316"></a>00316   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">size_t</span> <a class="code" href="classMConf_1_1CArray1d.html#42ee13bdf97e875f76cd807fd132db6d" title="Read from binary file the array that was written by write() method.">read</a>(<span class="keywordtype">double</span> u, T x, FILE *fp) {  <span class="comment">// TV is float or double or char</span>
<a name="l00317"></a>00317     <span class="keywordtype">size_t</span> cnt=0;
<a name="l00318"></a>00318     T w;
<a name="l00319"></a>00319     <span class="keywordtype">size_t</span> wsize = <span class="keyword">sizeof</span>(w);
<a name="l00320"></a>00320     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;dim1; i++) {
<a name="l00321"></a>00321       cnt+=fread(&amp;w, wsize,1,fp);
<a name="l00322"></a>00322       This(i)=w;
<a name="l00323"></a>00323     }
<a name="l00324"></a>00324     <span class="keywordflow">return</span> cnt;
<a name="l00325"></a>00325   }
<a name="l00327"></a>00327   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">size_t</span> <a class="code" href="classMConf_1_1CArray1d.html#42ee13bdf97e875f76cd807fd132db6d" title="Read from binary file the array that was written by write() method.">read</a>(Vector3d &amp;u, T x, FILE *fp) {
<a name="l00328"></a>00328     <span class="keywordtype">size_t</span> cnt=0;
<a name="l00329"></a>00329     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;dim1; i++)
<a name="l00330"></a>00330       cnt+=This(i).read(x,fp);
<a name="l00331"></a>00331     <span class="keywordflow">return</span> cnt;
<a name="l00332"></a>00332   }
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 };
<a name="l00335"></a>00335 
<a name="l00336"></a>00336 };   <span class="comment">//namespace MConf</span>
<a name="l00337"></a>00337 
<a name="l00338"></a>00338 <span class="preprocessor">#endif</span>
</pre></div></div>
    <p><a class="anchor" name="BottomOfPage"></a></p>
    <div class="no-print" align="right">
      <table border="0">
        <tr>
        <td>[ <a class="el" href="#TopOfPage">top</a> ]</td>
        <td>[ <a class="el" href="javascript:history.back(-1);"><b>back</b></a> ]</td> 
        </tr>
      </table>
    </div>
    <hr class="separator">
    <div class="ippAddress" align="right">
      <table border="0">
        <tr>
          <td class="ippAddress">13 Oct 2021 &nbsp;&nbsp;&nbsp;&nbsp;</td>
          <td class="ippAddress">
            <a href="http://www.ipp.mpg.de"><img src="IPP.png" alt="www.ipp.mpg.de" border="0"></a>
          </td>
          <td class="ippAddress">
            <!-- Copyright &copy; 2005-2008<br> --> 
            Max-Planck-Institut<br>f&uuml;r Plasmaphysik
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>
</body>
</html>
