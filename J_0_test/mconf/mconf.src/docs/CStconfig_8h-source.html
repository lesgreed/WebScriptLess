<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>MConf: CStconfig.h Source File</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <meta name="author" content="Yuriy Turkin">
  <meta name="keywords" content="stellarator, w7x, W7-X, W7-X software">
  <meta name="description" content="W7-X Software">
  <link href="myCss.css" rel="stylesheet" type="text/css">
  <link href="tabs.css" rel="stylesheet" type="text/css" >
</head>
<body>
  <div class="centerAll" id="TopOfPage">
    <div class="bodyForAll">
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_8a58aa3034da50da28943871e9137c86.html">include</a>
  </div>
</div>
<div class="contents">
<h1>CStconfig.h</h1><a href="CStconfig_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef MC_CSTCONFIG_H</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define MC_CSTCONFIG_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#ifdef _MSC_VER</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span><span class="comment">// These pragmas are to quiet VC++ about the expanded template identifiers exceeding 255 chars.</span>
<a name="l00006"></a>00006 <span class="comment">// You won't be able to see those variables in a debug session, but the code will run normally</span>
<a name="l00007"></a>00007 <span class="preprocessor">#pragma warning( push )</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#pragma warning( disable : 4786  )</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00010"></a>00010 <span class="preprocessor"></span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;stack&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include "<a class="code" href="ngarray_8h.html">ngarray.h</a>"</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include "<a class="code" href="CArray1d_8h.html">CArray1d.h</a>"</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include "<a class="code" href="CArray2d_8h.html">CArray2d.h</a>"</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include "<a class="code" href="CArray3d_8h.html">CArray3d.h</a>"</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include "<a class="code" href="CVector3d_8h.html">CVector3d.h</a>"</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include "<a class="code" href="CBtrace_8h.html">CBtrace.h</a>"</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include "<a class="code" href="threadtypes_8h.html">threadtypes.h</a>"</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include "<a class="code" href="mathf_8h.html">mathf.h</a>"</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#undef B0  //to fix the ORACLE-headers problems under LINUX</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span>
<a name="l00029"></a>00029 <span class="keyword">namespace </span>MConf {
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="keyword">class </span>CEfit;
<a name="l00032"></a>00032 <span class="comment">//****************************************************************************</span>
<a name="l00033"></a>00033 <span class="comment">//                          2004-2021,   Author: yuriy turkin at ipp mpg de</span>
<a name="l00063"></a><a class="code" href="classMConf_1_1CStconfig.html">00063</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a>  {
<a name="l00064"></a>00064 <span class="keyword">public</span>:
<a name="l00065"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c">00065</a>   <span class="keyword">enum</span> <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c">fileFormat</a>  {  
<a name="l00066"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c605159e8a4c32319fd69b5d151369d93">00066</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c605159e8a4c32319fd69b5d151369d93" title="file-format types, for internal use">UNDEFINED</a>, 
<a name="l00067"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c9a3c8e9dee0fe39ac69056a1de042e42">00067</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c9a3c8e9dee0fe39ac69056a1de042e42" title="ascii W7X format(J.Geiger)">W7X_FMT</a>,   
<a name="l00068"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c6e9f715037ae15e976fdc0223ca02f28">00068</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c6e9f715037ae15e976fdc0223ca02f28" title="4-byte(float) binary W7X format(Y.Turkin)">W7X_BIN4</a>,  
<a name="l00069"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c6e5c8218c1424223a81aecdc8befe166">00069</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c6e5c8218c1424223a81aecdc8befe166" title="8-byte(double) binary W7X format(Y.Turkin)">W7X_BIN8</a>,  
<a name="l00070"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369cd55ff5c103603fd13b9e8cfa50226136">00070</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369cd55ff5c103603fd13b9e8cfa50226136" title="LHD format.">LHD</a>,       
<a name="l00071"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c884ec5879f210716b6c06ea961fca986">00071</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c884ec5879f210716b6c06ea961fca986" title="LHD format.">LHD1</a>,      
<a name="l00072"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369cc62a83df9e5a1f2b70944a8f34b1d5ee">00072</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369cc62a83df9e5a1f2b70944a8f34b1d5ee" title="VMEC wout-format; use without transformation to Boozer coordinates.">VMEC</a>,      
<a name="l00073"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369cda9482b19985a520597549e20200efee">00073</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369cda9482b19985a520597549e20200efee" title="VMEC netCDF wout-format; use without transformation to Boozer coordinates.">VMECNETCDF</a>,
<a name="l00074"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369cf082fb0ea408146e2b6ab1bc8ca83850">00074</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369cf082fb0ea408146e2b6ab1bc8ca83850" title="W7X format from database.">W7X_DB</a>,    
<a name="l00075"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c1e8ffd92028690dc444ca74518a1ee30">00075</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c1e8ffd92028690dc444ca74518a1ee30" title="G EQDSK File from EFIT.">EFIT</a>,      
<a name="l00076"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c6945b9441555a8ddd40d77060b0a9fd2">00076</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c6945b9441555a8ddd40d77060b0a9fd2" title="ascii W7X format(Y.Turkin) for Tokamak Symmetry Flux Coordinates">W7X_FMT_TSFC</a>,   
<a name="l00077"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c6f0163019a3c8ea39883106147448b1b">00077</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c6f0163019a3c8ea39883106147448b1b" title="ascii W7X format(Y.Turkin) for VMEC Coordinates">W7X_FMT_VMEC</a>,   
<a name="l00078"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c925a4c8bdb46af359fd59f7ad59e2fb3">00078</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c925a4c8bdb46af359fd59f7ad59e2fb3" title="ascii W7X format(J.Geiger) for VMEC Coordinates after FP">W7X_FMT_VMEC_FP</a>,
<a name="l00079"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c32dd7eb70eb04b8eb28f2581e15291cd">00079</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c32dd7eb70eb04b8eb28f2581e15291cd">TORBEAM</a>,
<a name="l00080"></a><a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c284d51995843bfcd359bcc9ade87c439">00080</a>     <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c284d51995843bfcd359bcc9ade87c439">NEMEC</a>
<a name="l00081"></a>00081   };
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <span class="keyword">private</span>:
<a name="l00085"></a>00085   <span class="keyword">class </span>Bfield {
<a name="l00086"></a>00086     <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> *mC;
<a name="l00087"></a>00087   <span class="keyword">public</span>:
<a name="l00088"></a>00088     Bfield(<a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> &amp;magConf) { mC = &amp;magConf; }
<a name="l00090"></a>00090     Vector3d operator() ( <span class="keyword">const</span> Vector3d &amp;cyl )<span class="keyword"> const </span>{
<a name="l00091"></a>00091       <span class="keywordflow">return</span> this-&gt;mC-&gt;<a class="code" href="classMConf_1_1CStconfig.html#0c64d7e5e55395a92da943d990181cc2" title="The method returns cylindrical B-vector.">getBcyl</a>(cyl);
<a name="l00092"></a>00092     }
<a name="l00093"></a>00093   };
<a name="l00094"></a>00094   CBtrace&lt;Bfield&gt; btrace;
<a name="l00095"></a>00095 
<a name="l00096"></a><a class="code" href="classMConf_1_1CStconfig.html#2de55c2b29fb1b50576f926e610aee2e">00096</a>   <span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html#2de55c2b29fb1b50576f926e610aee2e">sumDat</a>;
<a name="l00097"></a>00097   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html#2de55c2b29fb1b50576f926e610aee2e">sumDat</a>; <span class="comment">// data to speed up summation in cyl2guess</span>
<a name="l00098"></a>00098 
<a name="l00099"></a><a class="code" href="classMConf_1_1CStconfig.html#2080991e2e4eaaade31ca358d2ff90e2">00099</a>   <span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html#2080991e2e4eaaade31ca358d2ff90e2">__lcms</a>;
<a name="l00100"></a>00100   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html#2080991e2e4eaaade31ca358d2ff90e2">__lcms</a>;
<a name="l00102"></a>00102   <span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html#2080991e2e4eaaade31ca358d2ff90e2">__lcms</a> {
<a name="l00103"></a>00103     <span class="keyword">public</span>:
<a name="l00104"></a>00104     <span class="keywordtype">void</span> create(<span class="keyword">const</span> <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * <span class="keyword">const</span> that) {
<a name="l00105"></a>00105       <span class="keywordflow">if</span>(!vertex.isOK()) 
<a name="l00106"></a>00106         const_cast&lt;CStconfig*&gt;(that)-&gt;createLCMS();
<a name="l00107"></a>00107     };
<a name="l00108"></a>00108     <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#ae048282c7011eedc2e0492f6421ea73" title="The method frees all internal arrays and makes this object empty.">clear</a>() {
<a name="l00109"></a>00109       vertex.clear();
<a name="l00110"></a>00110       Bfield.clear();
<a name="l00111"></a>00111     };
<a name="l00112"></a>00112     CArray2d&lt;Vector3d&gt; vertex;       
<a name="l00113"></a>00113     CArray2d&lt;Vector3d&gt; Bfield;       
<a name="l00114"></a>00114     <span class="keywordtype">double</span> mRmin, mZmin;      
<a name="l00115"></a>00115     <span class="keywordtype">double</span> mRmax, mZmax;      
<a name="l00116"></a>00116     <span class="keywordtype">double</span> mshift; 
<a name="l00117"></a>00117     <span class="keywordtype">double</span> mdPhi;  
<a name="l00118"></a>00118   };
<a name="l00119"></a>00119 
<a name="l00120"></a>00120                    
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="group__epsEffCalculation.html#gfeba0ced354dbcacbabca0e52dfc9dab">00124</a>   <span class="keyword">class </span><a class="code" href="group__epsEffCalculation.html#gfeba0ced354dbcacbabca0e52dfc9dab">__epsilon</a>;
<a name="l00125"></a>00125   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="group__epsEffCalculation.html#gfeba0ced354dbcacbabca0e52dfc9dab">__epsilon</a>;
<a name="l00126"></a>00126 
<a name="l00128"></a>00128   <span class="keyword">class </span><a class="code" href="group__epsEffCalculation.html#gfeba0ced354dbcacbabca0e52dfc9dab">__epsilon</a> {
<a name="l00129"></a>00129     <span class="keyword">public</span>:
<a name="l00130"></a>00130     <span class="keywordtype">void</span> invalidate() {
<a name="l00131"></a>00131       Btruncation=0;
<a name="l00132"></a>00132     };
<a name="l00133"></a>00133     <span class="keywordtype">void</span> create(<span class="keyword">const</span> <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * <span class="keyword">const</span> that) {
<a name="l00134"></a>00134       <span class="keywordflow">if</span>(!x.isOK()||Btruncation!=that-&gt;<a class="code" href="classMConf_1_1CStconfig.html#e2619b12739acde2fd428a2d976b8e10" title="Set truncation level to reduce number of harmonics used in summation.">truncate</a>()) { <span class="comment">// recalculate if truncation has been changed </span>
<a name="l00135"></a>00135         <span class="keyword">const_cast&lt;</span><a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a>*<span class="keyword">&gt;</span>(that)-&gt;calculateEpsEff();
<a name="l00136"></a>00136       }
<a name="l00137"></a>00137     };
<a name="l00138"></a>00138     <span class="keywordtype">void</span> resize() {
<a name="l00139"></a>00139       <span class="keywordtype">int</span> n=maxP;
<a name="l00140"></a>00140       x.resize(n);
<a name="l00141"></a>00141       epsGraz.resize(n);
<a name="l00142"></a>00142       epsDkes.resize(n);
<a name="l00143"></a>00143       epsVmec.resize(n);
<a name="l00144"></a>00144       epsNorm.resize(n);
<a name="l00145"></a>00145       epsHat.resize(n);
<a name="l00146"></a>00146       GwGraz.resize(n);
<a name="l00147"></a>00147       GsGraz.resize(n);
<a name="l00148"></a>00148       GvGraz.resize(n);
<a name="l00149"></a>00149     };
<a name="l00150"></a>00150     <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#ae048282c7011eedc2e0492f6421ea73" title="The method frees all internal arrays and makes this object empty.">clear</a>() {
<a name="l00151"></a>00151       x.clear();
<a name="l00152"></a>00152       epsGraz.clear();
<a name="l00153"></a>00153       epsDkes.clear();
<a name="l00154"></a>00154       epsVmec.clear();
<a name="l00155"></a>00155       epsNorm.clear();
<a name="l00156"></a>00156       epsHat.clear();
<a name="l00157"></a>00157       GwGraz.clear();
<a name="l00158"></a>00158       GsGraz.clear();
<a name="l00159"></a>00159       GvGraz.clear();
<a name="l00160"></a>00160     };
<a name="l00161"></a>00161     <a class="code" href="group__epsEffCalculation.html#gfeba0ced354dbcacbabca0e52dfc9dab">__epsilon</a>() {
<a name="l00162"></a>00162       <a class="code" href="classMConf_1_1CStconfig.html#02fd73d861ef2e4aabb38c0c9ff82947" title="init everything before loading magnetic configuration">init</a>();
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164     ~<a class="code" href="group__epsEffCalculation.html#gfeba0ced354dbcacbabca0e52dfc9dab">__epsilon</a>() {
<a name="l00165"></a>00165       <a class="code" href="classMConf_1_1CStconfig.html#02fd73d861ef2e4aabb38c0c9ff82947" title="init everything before loading magnetic configuration">init</a>();
<a name="l00166"></a>00166     }
<a name="l00167"></a>00167     <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#02fd73d861ef2e4aabb38c0c9ff82947" title="init everything before loading magnetic configuration">init</a>() {
<a name="l00168"></a>00168         Btruncation=0;
<a name="l00169"></a>00169         dphi = 0.017453;     <span class="comment">// twopi/360 = 0.017453 -&gt; 1degree;     // dphi=0.00698  == 0.4 degree</span>
<a name="l00170"></a>00170         doAccuracyTest =<span class="keyword">true</span>;
<a name="l00171"></a>00171         avoidResonances=<span class="keyword">true</span>;
<a name="l00172"></a>00172         useRationalIota=<span class="keyword">false</span>;
<a name="l00173"></a>00173         iotaDenominator=151;
<a name="l00174"></a>00174         turns=100;
<a name="l00175"></a>00175         numBLevels=2000;
<a name="l00176"></a>00176         useBoozerCoord=<span class="keyword">false</span>; <span class="comment">// if true then the properties of boozer coordinates is used in calculations</span>
<a name="l00177"></a>00177                               <span class="comment">// don't set the following constant to true in normal run.</span>
<a name="l00178"></a>00178         maxP = 21;
<a name="l00179"></a>00179         xmin = .05;
<a name="l00180"></a>00180         xmax = .98;
<a name="l00181"></a>00181     };
<a name="l00182"></a>00182     <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#34b1dc8832f889b8ed9a240b1d02539e" title="The method returns the minimum value of magnetic field.">Bmin</a>,<a class="code" href="classMConf_1_1CStconfig.html#19b04e3914feba7e055c33c996d7662e" title="The method returns the maximum value of magnetic field.">Bmax</a>;
<a name="l00183"></a>00183     <span class="keywordtype">double</span> Btruncation;
<a name="l00184"></a>00184     <span class="keywordtype">double</span> xmin;
<a name="l00185"></a>00185     <span class="keywordtype">double</span> xmax;
<a name="l00186"></a>00186     <span class="keywordtype">double</span> dphi;
<a name="l00187"></a>00187     <span class="keywordtype">int</span> maxP;
<a name="l00188"></a>00188     <span class="keywordtype">int</span> iotaDenominator;
<a name="l00189"></a>00189     <span class="keywordtype">int</span> turns;
<a name="l00190"></a>00190     <span class="keywordtype">int</span> numBLevels;
<a name="l00191"></a>00191     <span class="keywordtype">bool</span> doAccuracyTest;
<a name="l00192"></a>00192     <span class="keywordtype">bool</span> avoidResonances;
<a name="l00193"></a>00193     <span class="keywordtype">bool</span> useRationalIota;
<a name="l00194"></a>00194     <span class="keywordtype">bool</span> useBoozerCoord; <span class="comment">// if true then use properties of boozer coordinates</span>
<a name="l00195"></a>00195 
<a name="l00196"></a>00196     <span class="comment">// see 28th EPS, http://epsppd.epfl.ch/Madeira/html/pdf/P5.055.pdf</span>
<a name="l00197"></a>00197     CArray1d&lt;double&gt; x;        <span class="comment">// x = sqrt(s) is the flux label    </span>
<a name="l00198"></a>00198     CArray1d&lt;double&gt; epsGraz;  <span class="comment">// using Graz definition of minor radius: dr = dV/S = ds/&lt;|grad(s)|&gt;</span>
<a name="l00199"></a>00199     CArray1d&lt;double&gt; epsDkes;  <span class="comment">// using Dkes definition of minor radius: r = sqrt( Flux(s)/pi/B_00(s) )</span>
<a name="l00200"></a>00200     CArray1d&lt;double&gt; epsVmec;  <span class="comment">// using VMEC definition of minor radius: r = a*sqrt(s)</span>
<a name="l00201"></a>00201     CArray1d&lt;double&gt; epsNorm;  <span class="comment">// eps_eff normalized to the 'classical' particle diffusion flux, see eq.(9)</span>
<a name="l00202"></a>00202     CArray1d&lt;double&gt; epsHat;   <span class="comment">// eps_eff_hat which corresponds to the Boozer difinition of diffusion coefficient</span>
<a name="l00203"></a>00203 
<a name="l00204"></a>00204     CArray1d&lt;double&gt; GwGraz;   <span class="comment">// \Gamma_w  eq(21) in Phys.Plasmas 12,112507(2005) http://link.aip.org/link/doi/10.1063/1.2131848</span>
<a name="l00205"></a>00205     CArray1d&lt;double&gt; GsGraz;
<a name="l00206"></a>00206     CArray1d&lt;double&gt; GvGraz;
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 
<a name="l00209"></a>00209     <span class="keywordtype">double</span> Graz(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> epsGraz.interp1(sqrt(s), x); }
<a name="l00210"></a>00210     <span class="keywordtype">double</span> Dkes(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> epsDkes.interp1(sqrt(s), x); }
<a name="l00211"></a>00211     <span class="keywordtype">double</span> Vmec(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> epsVmec.interp1(sqrt(s), x); }
<a name="l00212"></a>00212     <span class="keywordtype">double</span> Norm(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> epsNorm.interp1(sqrt(s), x); }
<a name="l00213"></a>00213     <span class="keywordtype">double</span> Hat (<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> epsHat.interp1(sqrt(s), x); }
<a name="l00214"></a>00214     <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#4ada210e21c149c1e63d31436b6d58d3" title="eq(21) in Physics of Plasmas 12,112507(2005), http://link.aip.org/link/doi/10.1063/1...">Gw</a>  (<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> GwGraz.interp1(sqrt(s), x); }
<a name="l00215"></a>00215     <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#be0a4a2a92595ce692a503e82d94b469" title="eq(26) in Physics of Plasmas 12,112507(2005), http://link.aip.org/link/doi/10.1063/1...">Gs</a>  (<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> GsGraz.interp1(sqrt(s), x); }
<a name="l00216"></a>00216     <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#b89f959f8c7cdbadb7d1ba2dab32d15f" title="The methods return the bounce-averade gradB drift velocity of trapped particles averaged...">Gv</a>  (<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> GvGraz.interp1(sqrt(s), x); }
<a name="l00217"></a>00217   };
<a name="l00218"></a>00218 
<a name="l00220"></a>00220   <span class="keyword">struct </span>__allEps {
<a name="l00221"></a>00221     <span class="keywordtype">double</span> GwGraz;  <span class="comment">// eq(21) in Phys.Plasmas 12,112507(2005)</span>
<a name="l00222"></a>00222     <span class="keywordtype">double</span> GsGraz;  <span class="comment">// eq(26) in Phys.Plasmas 12,112507(2005)</span>
<a name="l00223"></a>00223     <span class="keywordtype">double</span> GvGraz;  <span class="comment">// eq(28) in Phys.Plasmas 12,112507(2005)</span>
<a name="l00224"></a>00224 
<a name="l00225"></a>00225     <span class="keywordtype">double</span> Graz;  <span class="comment">// using Graz definition of minor radius: dr = dV/S = ds/&lt;|grad(s)|&gt;</span>
<a name="l00226"></a>00226     <span class="keywordtype">double</span> Dkes;  <span class="comment">// using Dkes definition of minor radius: r = sqrt( Flux(s)/pi*B_00(s) )</span>
<a name="l00227"></a>00227     <span class="keywordtype">double</span> Vmec;  <span class="comment">// using VMEC definition of minor radius: r = a*sqrt(s)</span>
<a name="l00228"></a>00228     <span class="keywordtype">double</span> Norm;  <span class="comment">// eps_eff normalized to the 'classical' particle diffusion flux, see eq.(9)</span>
<a name="l00229"></a>00229     <span class="keywordtype">double</span> Hat;   <span class="comment">// eps_eff_hat which corresponds to the Boozer difinition of diffusion coefficient</span>
<a name="l00230"></a>00230     <span class="keywordtype">double</span> gradSmodAverage;   <span class="comment">//  &lt;|grad(s)|&gt;</span>
<a name="l00231"></a>00231     <span class="keywordtype">double</span> vmecFactor;        <span class="comment">//  a^2*&lt;|grad(s)|&gt;^2 / (4s)</span>
<a name="l00232"></a>00232     <span class="keywordtype">double</span> dkesFactor;        <span class="comment">//  &lt;|grad(Psi)|&gt;^2 / (4pi*B0*Psi)</span>
<a name="l00233"></a>00233     <span class="keywordtype">double</span> xi;                <span class="comment">//  xi = &lt;|grad(s)|&gt;^2 / (B0^2 &lt;(grad(s)/B)^2 &gt; )</span>
<a name="l00234"></a>00234   };
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 <span class="comment">//**********************************************************************************</span>
<a name="l00237"></a><a class="code" href="group__epsEffCalculation.html#g2ae82c444ce5564d0554c5b4c17c47b8">00237</a>   <span class="keyword">class </span><a class="code" href="group__epsEffCalculation.html#g2ae82c444ce5564d0554c5b4c17c47b8">__Fbs</a>;
<a name="l00238"></a>00238   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="group__epsEffCalculation.html#g2ae82c444ce5564d0554c5b4c17c47b8">__Fbs</a>;
<a name="l00239"></a>00239 
<a name="l00241"></a>00241   <span class="keyword">class </span><a class="code" href="group__epsEffCalculation.html#g2ae82c444ce5564d0554c5b4c17c47b8">__Fbs</a> {
<a name="l00242"></a>00242     <span class="keyword">public</span>:
<a name="l00243"></a>00243     <span class="keywordtype">void</span> invalidate() {
<a name="l00244"></a>00244       Btruncation=0;
<a name="l00245"></a>00245     };
<a name="l00246"></a>00246     <span class="keywordtype">void</span> create(<span class="keyword">const</span> <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * <span class="keyword">const</span> that) {
<a name="l00247"></a>00247       <span class="keywordflow">if</span>(!x.isOK()||Btruncation!=that-&gt;<a class="code" href="classMConf_1_1CStconfig.html#e2619b12739acde2fd428a2d976b8e10" title="Set truncation level to reduce number of harmonics used in summation.">truncate</a>()) { <span class="comment">// recalculate if truncation has been changed</span>
<a name="l00248"></a>00248         <span class="keyword">const_cast&lt;</span><a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a>*<span class="keyword">&gt;</span>(that)-&gt;calculateFbs();
<a name="l00249"></a>00249       }
<a name="l00250"></a>00250     };
<a name="l00251"></a>00251     <span class="keywordtype">void</span> resize() {
<a name="l00252"></a>00252       <span class="keywordtype">int</span> n=maxP;
<a name="l00253"></a>00253       x.resize(n);
<a name="l00254"></a>00254       fbsGraz.resize(n);
<a name="l00255"></a>00255       fbsDkes.resize(n);
<a name="l00256"></a>00256       fbsVmec.resize(n);
<a name="l00257"></a>00257       lambda_b.resize(n);
<a name="l00258"></a>00258       <a class="code" href="classMConf_1_1CStconfig.html#8e34f48e6b37186bdf4d80cac91bd9ae" title="The method returns the fraction of trapped particles on the surface s.">ftrapped</a>.resize(n);
<a name="l00259"></a>00259       g2vmec.resize(n);
<a name="l00260"></a>00260       g2graz.resize(n);
<a name="l00261"></a>00261       g2dkes.resize(n);
<a name="l00262"></a>00262       xmm.resize(numMuLevels);
<a name="l00263"></a>00263       g2_.resize(n);
<a name="l00264"></a>00264       g4_.resize(n,numMuLevels);
<a name="l00265"></a>00265       u_.resize(n);   
<a name="l00266"></a>00266       uB2_.resize(n); 
<a name="l00267"></a>00267       u2B2_.resize(n);
<a name="l00268"></a>00268       B2_.resize(n);  
<a name="l00269"></a>00269    };
<a name="l00270"></a>00270     <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#ae048282c7011eedc2e0492f6421ea73" title="The method frees all internal arrays and makes this object empty.">clear</a>() {
<a name="l00271"></a>00271       x.clear();
<a name="l00272"></a>00272       fbsGraz.clear();
<a name="l00273"></a>00273       fbsDkes.clear();
<a name="l00274"></a>00274       fbsVmec.clear();
<a name="l00275"></a>00275       lambda_b.clear();
<a name="l00276"></a>00276       <a class="code" href="classMConf_1_1CStconfig.html#8e34f48e6b37186bdf4d80cac91bd9ae" title="The method returns the fraction of trapped particles on the surface s.">ftrapped</a>.clear();
<a name="l00277"></a>00277       g2vmec.clear();
<a name="l00278"></a>00278       g2graz.clear();
<a name="l00279"></a>00279       g2dkes.clear();
<a name="l00280"></a>00280       xmm.clear();
<a name="l00281"></a>00281       g2_.clear();
<a name="l00282"></a>00282       g4_.clear();
<a name="l00283"></a>00283       u_.clear();   
<a name="l00284"></a>00284       uB2_.clear(); 
<a name="l00285"></a>00285       u2B2_.clear();
<a name="l00286"></a>00286       B2_.clear();  
<a name="l00287"></a>00287       <a class="code" href="classMConf_1_1CStconfig.html#02fd73d861ef2e4aabb38c0c9ff82947" title="init everything before loading magnetic configuration">init</a>();
<a name="l00288"></a>00288     };
<a name="l00289"></a>00289     <a class="code" href="group__epsEffCalculation.html#g2ae82c444ce5564d0554c5b4c17c47b8">__Fbs</a>() {
<a name="l00290"></a>00290       <a class="code" href="classMConf_1_1CStconfig.html#02fd73d861ef2e4aabb38c0c9ff82947" title="init everything before loading magnetic configuration">init</a>();
<a name="l00291"></a>00291     }
<a name="l00292"></a>00292     <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#02fd73d861ef2e4aabb38c0c9ff82947" title="init everything before loading magnetic configuration">init</a>() {
<a name="l00293"></a>00293         Btruncation=0;
<a name="l00294"></a>00294         dphi = 0.017453;     <span class="comment">// twopi/360 = 0.017453 -&gt; 1degree; </span>
<a name="l00295"></a>00295         doAccuracyTest =<span class="keyword">true</span>;
<a name="l00296"></a>00296         avoidResonances=<span class="keyword">false</span>;
<a name="l00297"></a>00297         useRationalIota=<span class="keyword">false</span>;
<a name="l00298"></a>00298         iotaDenominator=151;
<a name="l00299"></a>00299         turns=100;
<a name="l00300"></a>00300         xmumax=15;
<a name="l00301"></a>00301         numMuLevels=257;
<a name="l00302"></a>00302         useBoozerCoord=<span class="keyword">false</span>; <span class="comment">// if true then the properties of boozer coordinates is used in calculations</span>
<a name="l00303"></a>00303                               <span class="comment">// don't set the following constant to true in normal run.</span>
<a name="l00304"></a>00304         maxP = 101;
<a name="l00305"></a>00305         xmin = .05;
<a name="l00306"></a>00306         xmax = .95;
<a name="l00307"></a>00307     };
<a name="l00308"></a>00308     <span class="keywordtype">double</span> Btruncation;
<a name="l00309"></a>00309     <span class="keywordtype">double</span> xmin;
<a name="l00310"></a>00310     <span class="keywordtype">double</span> xmax;
<a name="l00311"></a>00311     <span class="keywordtype">double</span> xmumax; <span class="comment">// mu_max = tanh(xmumax)</span>
<a name="l00312"></a>00312     <span class="keywordtype">double</span> dphi;
<a name="l00313"></a>00313     <span class="keywordtype">int</span> maxP;
<a name="l00314"></a>00314     <span class="keywordtype">int</span> iotaDenominator;
<a name="l00315"></a>00315     <span class="keywordtype">int</span> turns;
<a name="l00316"></a>00316     <span class="keywordtype">int</span> numMuLevels;
<a name="l00317"></a>00317     <span class="keywordtype">bool</span> doAccuracyTest;
<a name="l00318"></a>00318     <span class="keywordtype">bool</span> avoidResonances;
<a name="l00319"></a>00319     <span class="keywordtype">bool</span> useRationalIota;
<a name="l00320"></a>00320     <span class="keywordtype">bool</span> useBoozerCoord; <span class="comment">// if true then use properties of boozer coordinates</span>
<a name="l00321"></a>00321     <span class="comment">// fbsVmec = ftrapped*Gbs*dV/dr_vmec, see  Gbs in N.Nakajima et al, NF, vol.29, 605(1989)</span>
<a name="l00322"></a>00322     <span class="comment">// see  lambda_b in Nemov, Kalyuzhnyj, Kasilov et al, PPCF, vol.46, 179(2004)</span>
<a name="l00323"></a>00323     <span class="comment">// fbsVmec = lambda_b*B2Average/(B0*B0)*(dr_vmec/dr_graz);   dr_vmec/dr_graz = &lt;|grad(s)|&gt;* dr_vmec/ds </span>
<a name="l00324"></a>00324     CArray1d&lt;double&gt; x;        <span class="comment">// x = sqrt(s) is the flux label    </span>
<a name="l00325"></a>00325     CArray1d&lt;double&gt; fbsGraz;  <span class="comment">// using Graz definition of minor radius: dr = dV/S = ds/&lt;|grad(s)|&gt;</span>
<a name="l00326"></a>00326     CArray1d&lt;double&gt; fbsDkes;  <span class="comment">// using Dkes definition of minor radius: r = sqrt( Flux(s)/pi/B_00(s) )</span>
<a name="l00327"></a>00327     CArray1d&lt;double&gt; fbsVmec;  <span class="comment">// using VMEC definition of minor radius: r = a*sqrt(s)</span>
<a name="l00328"></a>00328     CArray1d&lt;double&gt; lambda_b; <span class="comment">// fbsGraz**B0*B0/B2Average</span>
<a name="l00329"></a>00329     CArray1d&lt;double&gt; <a class="code" href="classMConf_1_1CStconfig.html#8e34f48e6b37186bdf4d80cac91bd9ae" title="The method returns the fraction of trapped particles on the surface s.">ftrapped</a>; <span class="comment">// fraction of trapped particles</span>
<a name="l00330"></a>00330     CArray1d&lt;double&gt; g2vmec;   <span class="comment">// &lt;g2&gt; using VMEC definition of minor radius: r = a*sqrt(s)</span>
<a name="l00331"></a>00331     CArray1d&lt;double&gt; g2graz;   <span class="comment">// &lt;g2&gt; using Graz ........ </span>
<a name="l00332"></a>00332     CArray1d&lt;double&gt; g2dkes;   <span class="comment">// &lt;g2&gt; using Dkes ........ </span>
<a name="l00333"></a>00333     CArray1d&lt;double&gt; g2_;      <span class="comment">// &lt;g2&gt;, where g2 is defined as B*grad(g2/b^2) = Bxgrad(s)*grad(1/b^2)  </span>
<a name="l00334"></a>00334     CArray2d&lt;double&gt; g4_;      <span class="comment">// &lt;g4&gt;, where g4 is defined as B*grad(g4/xi)  = Bxgrad(s)*grad(1/xi) </span>
<a name="l00335"></a>00335     CArray1d&lt;double&gt; xmm;      <span class="comment">//  mu = tanh(xmm), where 0&lt;=mu&lt;=1 is the magnetic moment </span>
<a name="l00336"></a>00336     CArray1d&lt;double&gt; u_;       <span class="comment">// &lt;u&gt;, where u is defined as B*grad(u) = -Bxgrad(s)*grad(1/b^2)  </span>
<a name="l00337"></a>00337     CArray1d&lt;double&gt; uB2_;     <span class="comment">// &lt;u*B^2&gt;, where u is defined as B*grad(u) = -Bxgrad(s)*grad(1/b^2)  </span>
<a name="l00338"></a>00338     CArray1d&lt;double&gt; u2B2_;    <span class="comment">// &lt;u^2*B^2&gt;, where u is defined as B*grad(u) = -Bxgrad(s)*grad(1/b^2)  </span>
<a name="l00339"></a>00339     CArray1d&lt;double&gt; B2_;      <span class="comment">// &lt;B^2&gt;</span>
<a name="l00340"></a>00340     <span class="keywordtype">double</span> Graz(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> fbsGraz.interp1(sqrt(s), x); }
<a name="l00341"></a>00341     <span class="keywordtype">double</span> Dkes(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> fbsDkes.interp1(sqrt(s), x); }
<a name="l00342"></a>00342     <span class="keywordtype">double</span> Vmec(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> fbsVmec.interp1(sqrt(s), x); }
<a name="l00343"></a>00343     <span class="keywordtype">double</span> GrazLambda(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> lambda_b.interp1(sqrt(s), x); }
<a name="l00344"></a>00344     <span class="keywordtype">double</span> ftr(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#8e34f48e6b37186bdf4d80cac91bd9ae" title="The method returns the fraction of trapped particles on the surface s.">ftrapped</a>.interp1(sqrt(s), x); }
<a name="l00345"></a>00345     <span class="keywordtype">double</span> g2(<span class="keywordtype">double</span> s)  { <span class="keywordflow">return</span> g2_.interp1(sqrt(s), x); }
<a name="l00346"></a>00346     <span class="keywordtype">double</span> g2Vmec(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> g2vmec.interp1(sqrt(s), x); }
<a name="l00347"></a>00347     <span class="keywordtype">double</span> g2Graz(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> g2graz.interp1(sqrt(s), x); }
<a name="l00348"></a>00348     <span class="keywordtype">double</span> g2Dkes(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> g2dkes.interp1(sqrt(s), x); }
<a name="l00349"></a>00349     <span class="keywordtype">double</span> u(<span class="keywordtype">double</span> s)     { <span class="keywordflow">return</span> u_.interp1(sqrt(s), x); }
<a name="l00350"></a>00350     <span class="keywordtype">double</span> uB2(<span class="keywordtype">double</span> s)   { <span class="keywordflow">return</span> uB2_.interp1(sqrt(s), x); }
<a name="l00351"></a>00351     <span class="keywordtype">double</span> u2B2(<span class="keywordtype">double</span> s)  { <span class="keywordflow">return</span> u2B2_.interp1(sqrt(s), x); }
<a name="l00352"></a>00352     <span class="keywordtype">double</span> B2(<span class="keywordtype">double</span> s)    { <span class="keywordflow">return</span> B2_.interp1(sqrt(s), x); }
<a name="l00353"></a>00353  };
<a name="l00354"></a>00354 
<a name="l00356"></a>00356   <span class="keyword">struct </span>__allFbs {
<a name="l00357"></a>00357     <span class="keywordtype">double</span> Graz;     <span class="comment">// Fbs using Graz definition of minor radius: dr = dV/S = ds/&lt;|grad(s)|&gt;</span>
<a name="l00358"></a>00358     <span class="keywordtype">double</span> Dkes;     <span class="comment">// using Dkes definition of minor radius: r = sqrt( Flux(s)/pi*B_00(s) )</span>
<a name="l00359"></a>00359     <span class="keywordtype">double</span> Vmec;     <span class="comment">// using VMEC definition of minor radius: r = a*sqrt(s)</span>
<a name="l00360"></a>00360     <span class="keywordtype">double</span> lambda_b; <span class="comment">// Graz**B0*B0/B2Average</span>
<a name="l00361"></a>00361     <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#8e34f48e6b37186bdf4d80cac91bd9ae" title="The method returns the fraction of trapped particles on the surface s.">ftrapped</a>; <span class="comment">// fraction of trapped particles</span>
<a name="l00362"></a>00362     <span class="keywordtype">double</span> g2vmec;   <span class="comment">// g2 using VMEC definition of minor radius: r = a*sqrt(s)</span>
<a name="l00363"></a>00363     <span class="keywordtype">double</span> g2graz;   <span class="comment">// g2 using Graz ........</span>
<a name="l00364"></a>00364     <span class="keywordtype">double</span> g2dkes;   <span class="comment">// g2 using Dkes ........</span>
<a name="l00365"></a>00365     <span class="keywordtype">double</span> g2_;
<a name="l00366"></a>00366     <span class="keywordtype">double</span> u_;       <span class="comment">// &lt;u&gt;, where u is defined as B*grad(u) = -Bxgrad(s)*grad(1/b^2)  </span>
<a name="l00367"></a>00367     <span class="keywordtype">double</span> uB2_;     <span class="comment">// &lt;u*B^2&gt;, where u is defined as B*grad(u) = -Bxgrad(s)*grad(1/b^2)  </span>
<a name="l00368"></a>00368     <span class="keywordtype">double</span> u2B2_;    <span class="comment">// &lt;u^2*B^2&gt;, where u is defined as B*grad(u) = -Bxgrad(s)*grad(1/b^2)  </span>
<a name="l00369"></a>00369     <span class="keywordtype">double</span> B2_;      <span class="comment">// &lt;B^2&gt;</span>
<a name="l00370"></a>00370     CArray1d&lt;double&gt; g4_;
<a name="l00371"></a>00371   };
<a name="l00373"></a>00373 
<a name="l00374"></a>00374 <span class="comment">//**********************************************************************************</span>
<a name="l00375"></a>00375 
<a name="l00376"></a><a class="code" href="classMConf_1_1CStconfig.html#d78e6e4d6a5cd0d66e22c7ae1e9806a3">00376</a>   <span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html#d78e6e4d6a5cd0d66e22c7ae1e9806a3">__averagedData</a>;
<a name="l00377"></a>00377   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html#d78e6e4d6a5cd0d66e22c7ae1e9806a3">__averagedData</a>;
<a name="l00378"></a>00378 
<a name="l00380"></a>00380   <span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html#d78e6e4d6a5cd0d66e22c7ae1e9806a3">__averagedData</a> {
<a name="l00381"></a>00381     <span class="keyword">public</span>:
<a name="l00382"></a>00382     <span class="keywordtype">void</span> create(<span class="keyword">const</span> <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * <span class="keyword">const</span> that) {
<a name="l00383"></a>00383       <span class="keywordflow">if</span>(!x.isOK()||Btruncation!=that-&gt;<a class="code" href="classMConf_1_1CStconfig.html#e2619b12739acde2fd428a2d976b8e10" title="Set truncation level to reduce number of harmonics used in summation.">truncate</a>()) {
<a name="l00384"></a>00384         <span class="keyword">const_cast&lt;</span><a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a>*<span class="keyword">&gt;</span>(that)-&gt;calculateGradsAvrg();
<a name="l00385"></a>00385       }
<a name="l00386"></a>00386     };
<a name="l00387"></a>00387     <span class="keywordtype">void</span> resize(<span class="keywordtype">int</span> n) {
<a name="l00388"></a>00388       x.resize(n);
<a name="l00389"></a>00389       <a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>.resize(n);
<a name="l00390"></a>00390       grads.resize(n);
<a name="l00391"></a>00391       grads2.resize(n);
<a name="l00392"></a>00392       grads2overB2.resize(n);
<a name="l00393"></a>00393       rdks.resize(n);
<a name="l00394"></a>00394       eB00.resize(n);
<a name="l00395"></a>00395     };
<a name="l00396"></a>00396     <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#ae048282c7011eedc2e0492f6421ea73" title="The method frees all internal arrays and makes this object empty.">clear</a>() {
<a name="l00397"></a>00397       x.clear();
<a name="l00398"></a>00398       <a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>.clear();
<a name="l00399"></a>00399       grads.clear();
<a name="l00400"></a>00400       grads2.clear();
<a name="l00401"></a>00401       grads2overB2.clear();
<a name="l00402"></a>00402       rdks.clear();
<a name="l00403"></a>00403       eB00.clear();
<a name="l00404"></a>00404     };
<a name="l00405"></a>00405     <span class="keywordtype">double</span> Btruncation;
<a name="l00406"></a>00406     CArray1d&lt;double&gt; x;        <span class="comment">// x = sqrt(s) is the flux label    </span>
<a name="l00407"></a>00407     CArray1d&lt;double&gt; <a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>;        <span class="comment">// r = integral (ds/&lt;|grad(s)|&gt;) -- Graz definition   </span>
<a name="l00408"></a>00408     CArray1d&lt;double&gt; rdks;     <span class="comment">// rdks = sqrt( integral (2x*dx*Flux(1)/(pi*B00)) ) = sqrt(integral(dpsi/(pi*B_00)) ); where psi is the toroidal flux Flux(s)</span>
<a name="l00409"></a>00409     CArray1d&lt;double&gt; eB00;     <span class="comment">// fabs(Flux(1)/( pi*B00(x) ))</span>
<a name="l00410"></a>00410     CArray1d&lt;double&gt; grads;    <span class="comment">// &lt;|grad(s)|&gt;/sqrt(s);  &lt;|grad(s)|&gt;/sqrt(s) is proportional to &lt;|grad(r)|&gt;,where r=a*sqrt(s)  </span>
<a name="l00411"></a>00411     CArray1d&lt;double&gt; grads2;   <span class="comment">// &lt;|grad(s)|^2&gt;/s  </span>
<a name="l00412"></a>00412     CArray1d&lt;double&gt; grads2overB2;  <span class="comment">// &lt;|grad(s)/B|^2&gt;/s</span>
<a name="l00413"></a>00413     <span class="keywordtype">double</span> r_graz(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>.interp1(sqrt(s), x); }
<a name="l00414"></a>00414     <span class="keywordtype">double</span> r_dks(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> rdks.interp1(sqrt(s), x); }
<a name="l00415"></a>00415     <span class="keywordtype">double</span> Grads (<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> grads.interp1(sqrt(s), x)*sqrt(s); }        <span class="comment">// &lt;|grad(s)|&gt;</span>
<a name="l00416"></a>00416     <span class="keywordtype">double</span> Grads2(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> grads2.interp1(sqrt(s), x)*s; }             <span class="comment">// &lt;|grad(s)|^2&gt;</span>
<a name="l00417"></a>00417     <span class="keywordtype">double</span> Grads2overB2(<span class="keywordtype">double</span> s) { <span class="keywordflow">return</span> grads2overB2.interp1(sqrt(s), x)*s; } <span class="comment">// &lt;|grad(s)/B|^2&gt;</span>
<a name="l00418"></a>00418     <span class="keywordtype">void</span> set_r_graz() 
<a name="l00419"></a>00419     {
<a name="l00420"></a>00420       <a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>.rw()[0]=0;
<a name="l00421"></a>00421       rdks.rw()[0]=0;
<a name="l00422"></a>00422       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1; i&lt;x.size(); i++) {
<a name="l00423"></a>00423         <span class="keywordtype">double</span> rg, rdk;
<a name="l00424"></a>00424         rInt(x[i-1],x[i], rg, rdk);
<a name="l00425"></a>00425         <a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>.rw()[i]   = <a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>[i-1]    + rg;
<a name="l00426"></a>00426         rdks.rw()[i]= rdks[i-1] + rdk;
<a name="l00427"></a>00427       }
<a name="l00428"></a>00428       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=1; j&lt;x.size(); j++) {
<a name="l00429"></a>00429         rdks.rw()[j]= sqrt(rdks[j]);
<a name="l00430"></a>00430       }
<a name="l00431"></a>00431     }
<a name="l00432"></a>00432   <span class="keyword">private</span>:
<a name="l00433"></a>00433     <span class="keywordtype">double</span> rprime(<span class="keywordtype">double</span> x1)  { <span class="keywordflow">return</span> 2/grads.interp1(x1, x); }  <span class="comment">// @return 2sqrt(s)/&lt;|grad(s)|&gt;</span>
<a name="l00434"></a>00434     <span class="keywordtype">double</span> rdkprime(<span class="keywordtype">double</span> x1)  { <span class="keywordflow">return</span> 2*x1*eB00.interp1(x1, x); } <span class="comment">// @return 2x*Flux(1)/(pi*B00)</span>
<a name="l00435"></a>00435     <span class="keywordtype">void</span> rInt(<span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> x2, <span class="keywordtype">double</span> &amp;rg, <span class="keywordtype">double</span> &amp;rdk) 
<a name="l00436"></a>00436     {
<a name="l00437"></a>00437       <span class="keywordtype">double</span> sum1=0,sum2=0,dx=0.005;
<a name="l00438"></a>00438       <span class="keywordtype">double</span> Dx=x2-x1;
<a name="l00439"></a>00439       rg = rdk = 0;
<a name="l00440"></a>00440       <span class="keywordflow">if</span>(Dx==0) <span class="keywordflow">return</span>;
<a name="l00441"></a>00441       <span class="keywordtype">int</span> n = int(Dx/dx);
<a name="l00442"></a>00442       <span class="keywordflow">if</span>(n&lt;4) n=4;
<a name="l00443"></a>00443       n=n+n%2;       <span class="comment">//must be even for simpson integration</span>
<a name="l00444"></a>00444       dx=Dx/n;
<a name="l00445"></a>00445       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;=n; k++) {  <span class="comment">//Simpson integration</span>
<a name="l00446"></a>00446         <span class="keywordtype">double</span> w = (k==0||k==n)?1:(2*(1+k%2));   <span class="comment">// weight for Simpson integration</span>
<a name="l00447"></a>00447         sum1 += w*rprime(x1+k*dx);
<a name="l00448"></a>00448         sum2 += w*rdkprime(x1+k*dx);
<a name="l00449"></a>00449       }
<a name="l00450"></a>00450       rg  = sum1*dx/3;
<a name="l00451"></a>00451       rdk = sum2*dx/3;
<a name="l00452"></a>00452     }
<a name="l00453"></a>00453   };
<a name="l00454"></a>00454 
<a name="l00457"></a>00457 
<a name="l00458"></a>00458 <span class="comment">// vmec to boozer transformation  </span>
<a name="l00459"></a><a class="code" href="group__vmec2boozerTransrorm.html#ge62a119d7b5a5bff34d8f75234452105">00459</a>   <span class="keyword">class </span><a class="code" href="group__vmec2boozerTransrorm.html#ge62a119d7b5a5bff34d8f75234452105">__booz</a>;
<a name="l00460"></a>00460   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="group__vmec2boozerTransrorm.html#ge62a119d7b5a5bff34d8f75234452105">__booz</a>;
<a name="l00461"></a>00461 
<a name="l00463"></a>00463   <span class="keyword">class </span>CComplex {
<a name="l00464"></a>00464   <span class="keyword">public</span>:
<a name="l00465"></a>00465     <span class="keywordtype">double</span>  re; 
<a name="l00466"></a>00466     <span class="keywordtype">double</span>  im;
<a name="l00467"></a>00467     CComplex() :re(0),im(0) {;}
<a name="l00468"></a>00468     CComplex(CComplex <span class="keyword">const</span> &amp;v ) :re(v.re),im(v.im) {;}
<a name="l00469"></a>00469     CComplex(<span class="keywordtype">double</span> x,<span class="keywordtype">double</span> y=0.) :re(x),im(y) {;}
<a name="l00470"></a>00470     <span class="keywordtype">double</span> &amp;real() { <span class="keywordflow">return</span>  re;}
<a name="l00471"></a>00471     <span class="keywordtype">double</span> &amp;imag() { <span class="keywordflow">return</span>  im;}
<a name="l00472"></a>00472     <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;real()<span class="keyword"> const </span>{ <span class="keywordflow">return</span>  re;}
<a name="l00473"></a>00473     <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;imag()<span class="keyword"> const </span>{ <span class="keywordflow">return</span>  im;}
<a name="l00475"></a>00475     CComplex &amp;operator = ( CComplex <span class="keyword">const</span> &amp;v ) {
<a name="l00476"></a>00476       <span class="keywordflow">if</span>( <span class="keyword">this</span> != &amp;v) {
<a name="l00477"></a>00477         re = v.re; im = v.im;
<a name="l00478"></a>00478       }
<a name="l00479"></a>00479       <span class="keywordflow">return</span>( *<span class="keyword">this</span> );
<a name="l00480"></a>00480     }
<a name="l00482"></a>00482     CComplex conj() {
<a name="l00483"></a>00483       <span class="keywordflow">return</span>( CComplex(re,-im) );
<a name="l00484"></a>00484     }
<a name="l00486"></a>00486     CComplex operator *= ( CComplex <span class="keyword">const</span> &amp;v ) {
<a name="l00487"></a>00487         <span class="keywordtype">double</span> x=re;
<a name="l00488"></a>00488         re  = x*v.re-im*v.im;
<a name="l00489"></a>00489         im  = x*v.im+im*v.re;
<a name="l00490"></a>00490         <span class="keywordflow">return</span>( *<span class="keyword">this</span> );
<a name="l00491"></a>00491     }
<a name="l00493"></a>00493     <span class="keyword">friend</span> CComplex operator * ( CComplex <span class="keyword">const</span> &amp;v1, CComplex <span class="keyword">const</span> &amp;v2 ) {
<a name="l00494"></a>00494         <span class="keywordflow">return</span> CComplex(v1.re*v2.re-v1.im*v2.im,v1.re*v2.im+v1.im*v2.re);
<a name="l00495"></a>00495     }
<a name="l00496"></a>00496   };
<a name="l00497"></a>00497 
<a name="l00499"></a>00499   <span class="keyword">class </span><a class="code" href="group__vmec2boozerTransrorm.html#ge62a119d7b5a5bff34d8f75234452105">__booz</a> {
<a name="l00500"></a>00500     <span class="keywordtype">void</span> setMN(<span class="keywordtype">int</span> M, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> method) {
<a name="l00501"></a>00501       Mmax = M;
<a name="l00502"></a>00502       Nmax = N;
<a name="l00503"></a>00503       <span class="keywordflow">if</span>(method==0) { <span class="comment">// intergate over equidistant boozer angles</span>
<a name="l00504"></a>00504         Npol = Mmax*2;
<a name="l00505"></a>00505         <a class="code" href="classMConf_1_1CStconfig.html#f4ad5065890c58b13d1ff22248996ef6" title="The method returns the number of toroidal harmonics.">Ntor</a> = Nmax*2;
<a name="l00506"></a>00506       }
<a name="l00507"></a>00507       <span class="keywordflow">else</span> {
<a name="l00508"></a>00508         Npol = Mmax*4;
<a name="l00509"></a>00509         <a class="code" href="classMConf_1_1CStconfig.html#f4ad5065890c58b13d1ff22248996ef6" title="The method returns the number of toroidal harmonics.">Ntor</a> = Nmax*4;
<a name="l00510"></a>00510       }
<a name="l00511"></a>00511    }
<a name="l00512"></a>00512    <span class="keyword">public</span>:
<a name="l00513"></a>00513     <span class="keywordtype">int</span> method; 
<a name="l00514"></a>00514     <span class="keywordtype">int</span> Ns;
<a name="l00515"></a>00515     <span class="keywordtype">int</span> Mmax; <span class="comment">// # of poloidal mods</span>
<a name="l00516"></a>00516     <span class="keywordtype">int</span> Nmax; <span class="comment">// # of toroidal mods</span>
<a name="l00517"></a>00517     <span class="keywordtype">int</span> Npol;
<a name="l00518"></a>00518     <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#f4ad5065890c58b13d1ff22248996ef6" title="The method returns the number of toroidal harmonics.">Ntor</a>;
<a name="l00519"></a>00519     CArray1d&lt; CComplex &gt; ctm;
<a name="l00520"></a>00520     CArray1d&lt; CComplex &gt; cpn;
<a name="l00521"></a>00521     CArray3d&lt;double&gt; Rmn, Zmn, Pmn, Bmn;  <span class="comment">// array[s](m,n)</span>
<a name="l00522"></a>00522     <a class="code" href="group__vmec2boozerTransrorm.html#ge62a119d7b5a5bff34d8f75234452105">__booz</a>() {
<a name="l00523"></a>00523     }
<a name="l00524"></a>00524     <a class="code" href="group__vmec2boozerTransrorm.html#ge62a119d7b5a5bff34d8f75234452105">__booz</a>(<span class="keywordtype">int</span> n,<span class="keywordtype">int</span> M, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> method) {
<a name="l00525"></a>00525       resize(n,M,N,method);
<a name="l00526"></a>00526     }
<a name="l00527"></a>00527     <span class="keywordtype">bool</span> getMethod() {<span class="keywordflow">return</span> method==0; } 
<a name="l00528"></a>00528     <span class="keywordtype">void</span> resize(<span class="keywordtype">int</span> n,<span class="keywordtype">int</span> M, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> method) {
<a name="l00529"></a>00529       this-&gt;method = method;  <span class="comment">// 1-integrate over VMEC angles; 0 - intergate over boozer angles</span>
<a name="l00530"></a>00530       setMN(M, N, method); 
<a name="l00531"></a>00531       Ns = n;       <span class="comment">// number of flux surfaces</span>
<a name="l00532"></a>00532       Rmn.resize(n);
<a name="l00533"></a>00533       Zmn.resize(n);
<a name="l00534"></a>00534       Pmn.resize(n);
<a name="l00535"></a>00535       Bmn.resize(n);
<a name="l00536"></a>00536       ctm.resize(0,Mmax);
<a name="l00537"></a>00537       cpn.resize(-Nmax,Nmax);
<a name="l00538"></a>00538     }
<a name="l00539"></a>00539     <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#ae048282c7011eedc2e0492f6421ea73" title="The method frees all internal arrays and makes this object empty.">clear</a>() {
<a name="l00540"></a>00540       Rmn.clear();
<a name="l00541"></a>00541       Zmn.clear();
<a name="l00542"></a>00542       Pmn.clear();
<a name="l00543"></a>00543       Bmn.clear();
<a name="l00544"></a>00544       ctm.clear();
<a name="l00545"></a>00545       cpn.clear();
<a name="l00546"></a>00546     }
<a name="l00547"></a>00547   };
<a name="l00549"></a>00549 
<a name="l00550"></a>00550   <a class="code" href="classMConf_1_1CStconfig.html#2080991e2e4eaaade31ca358d2ff90e2">__lcms</a> lcms;
<a name="l00551"></a>00551   <a class="code" href="group__epsEffCalculation.html#gfeba0ced354dbcacbabca0e52dfc9dab">__epsilon</a> epsilonEff;
<a name="l00552"></a>00552   <a class="code" href="group__epsEffCalculation.html#g2ae82c444ce5564d0554c5b4c17c47b8">__Fbs</a> Fbs;
<a name="l00553"></a>00553   <a class="code" href="classMConf_1_1CStconfig.html#d78e6e4d6a5cd0d66e22c7ae1e9806a3">__averagedData</a>  averagedData;
<a name="l00554"></a>00554   <a class="code" href="group__vmec2boozerTransrorm.html#ge62a119d7b5a5bff34d8f75234452105">__booz</a> bz;
<a name="l00555"></a>00555 
<a name="l00556"></a>00556 
<a name="l00557"></a>00557   std::string mHdr1;          <span class="comment">// header for bc-file</span>
<a name="l00558"></a>00558   std::string mHdr2;          <span class="comment">// header for bc-file</span>
<a name="l00559"></a>00559   std::string mHdr2a;         <span class="comment">// header for bc-file</span>
<a name="l00560"></a>00560   std::string mHdr21;         <span class="comment">// header for bc-file</span>
<a name="l00561"></a>00561   std::string mHdr3;          <span class="comment">// header for bc-file</span>
<a name="l00562"></a>00562   std::vector&lt;std::string&gt; mComments; 
<a name="l00563"></a>00563 
<a name="l00564"></a><a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">00564</a>   <span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">__spline</a>;
<a name="l00565"></a>00565   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">__spline</a>;
<a name="l00568"></a>00568   <span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">__spline</a> : <span class="keyword">public</span> <a class="code" href="classMConf_1_1CArray1d.html" title="This class provides 1d-array.">CArray1d</a>&lt;double&gt; {
<a name="l00569"></a>00569     <span class="keyword">public</span>:
<a name="l00570"></a>00570     <a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">__spline</a>() :<a class="code" href="classMConf_1_1CArray1d.html" title="This class provides 1d-array.">CArray1d</a>&lt;double&gt;() {created=<span class="keyword">false</span>;};
<a name="l00571"></a>00571 
<a name="l00572"></a>00572     <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#02fd73d861ef2e4aabb38c0c9ff82947" title="init everything before loading magnetic configuration">init</a>(<span class="keywordtype">int</span> low,<span class="keywordtype">int</span> upper,<span class="keywordtype">double</span> val) {
<a name="l00573"></a>00573       <span class="keywordtype">bool</span> ok = (<span class="keyword">dynamic_cast&lt;</span><a class="code" href="classMConf_1_1CArray1d.html">CArray1d&lt;double&gt;</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>))-&gt;resize(low,upper,val); 
<a name="l00574"></a>00574       ok     &amp;= _d2.resize(low,upper,val);
<a name="l00575"></a>00575       created = <span class="keyword">false</span>;
<a name="l00576"></a>00576       <span class="keywordflow">return</span> (ok);
<a name="l00577"></a>00577     }
<a name="l00578"></a>00578     <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#ae048282c7011eedc2e0492f6421ea73" title="The method frees all internal arrays and makes this object empty.">clear</a>() {
<a name="l00579"></a>00579       (<span class="keyword">dynamic_cast&lt;</span>CArray1d&lt;double&gt;*<span class="keyword">&gt;</span>(<span class="keyword">this</span>))-&gt;clear();
<a name="l00580"></a>00580       _d2.clear();
<a name="l00581"></a>00581       created = <span class="keyword">false</span>;
<a name="l00582"></a>00582     }
<a name="l00583"></a>00583     <span class="keywordtype">void</span> create(<a class="code" href="classMConf_1_1CStconfig.html#122d35601e255373ff9019be8c741013" title="The constructor creates an empty instance of CStconfig.">CStconfig</a> *mc) {  <span class="comment">// _d2 will be filled</span>
<a name="l00584"></a>00584       <span class="keywordtype">int</span> ns = mc-&gt;mNs;     <span class="comment">//     int nnnn = mc-&gt;mreff.size()-1;</span>
<a name="l00585"></a>00585       mc-&gt;splineNRC(ns,mc-&gt;mreff.constArray(),this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>(),_d2.rw(), 0 ); 
<a name="l00586"></a>00586       _d2.rw()[ns-2] = 0; <span class="comment">// zero second derivative in order to extrapolate linealy</span>
<a name="l00587"></a>00587       created=<span class="keyword">true</span>;
<a name="l00588"></a>00588     }
<a name="l00589"></a>00589     <span class="comment">// Spline interpolation of Ip, It, iota, Volume, Vprime,.....(flux surface quantities)</span>
<a name="l00590"></a>00590     <span class="keywordtype">double</span> operator() (<span class="keywordtype">double</span> s,<span class="keyword">const</span> <a class="code" href="classMConf_1_1CStconfig.html#122d35601e255373ff9019be8c741013" title="The constructor creates an empty instance of CStconfig.">CStconfig</a> *mc)<span class="keyword"> const </span>{
<a name="l00591"></a>00591       <span class="keywordtype">int</span> i = mc-&gt;SearchSindx(s);
<a name="l00592"></a>00592     <span class="comment">//  int ix = SearchXindx(sqrt(s));</span>
<a name="l00593"></a>00593     <span class="comment">//  if ( i!=ix ) </span>
<a name="l00594"></a>00594     <span class="comment">//    i = ix;</span>
<a name="l00595"></a>00595       <span class="keyword">const</span> CArray1d&lt;double&gt; &amp;mr =  mc-&gt;mreff;
<a name="l00596"></a>00596       <span class="keywordtype">double</span> h = mr[i+1] - mr[i];
<a name="l00597"></a>00597       <span class="keywordtype">double</span> b = (sqrt(s) - mr[i])/h;
<a name="l00598"></a>00598       <span class="keywordtype">double</span> a = 1-b;
<a name="l00599"></a>00599       <span class="keywordtype">double</span> c = a*a*a-a;
<a name="l00600"></a>00600       <span class="keywordtype">double</span> d = b*b*b-b;
<a name="l00601"></a>00601       <span class="keyword">const</span> <span class="keywordtype">double</span> *y = this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>();
<a name="l00602"></a>00602       <span class="keyword">const</span> <span class="keywordtype">double</span> *y_d2 = _d2.constArray();
<a name="l00603"></a>00603       <span class="keywordflow">return</span> y[i] + b*(y[i+1]-y[i]) + (c*y_d2[i] + d*y_d2[i+1])*h*h/6;
<a name="l00604"></a>00604     }
<a name="l00605"></a>00605     <span class="comment">// Spline interpolation of Ip, It, iota, Volume, Vprime,.....(flux surface quantities)</span>
<a name="l00606"></a>00606     <span class="comment">// @return dy/ds</span>
<a name="l00607"></a>00607     <span class="keywordtype">double</span> prime(<span class="keywordtype">double</span> s,<span class="keyword">const</span> <a class="code" href="classMConf_1_1CStconfig.html#122d35601e255373ff9019be8c741013" title="The constructor creates an empty instance of CStconfig.">CStconfig</a> *mc)<span class="keyword"> const </span>{
<a name="l00608"></a>00608       s = (s&lt;=mc-&gt;ms[1])?(mc-&gt;ms[1]+0.0001*(mc-&gt;ms[2]-mc-&gt;ms[1])):s;
<a name="l00609"></a>00609       <span class="keywordtype">double</span> e2r = 0.5/sqrt(s);
<a name="l00610"></a>00610       <span class="keywordtype">int</span> i = mc-&gt;SearchSindx(s);
<a name="l00611"></a>00611       <span class="keyword">const</span> CArray1d&lt;double&gt; &amp;mr =  mc-&gt;mreff;
<a name="l00612"></a>00612       <span class="keywordtype">double</span> h = mr[i+1] - mr[i];
<a name="l00613"></a>00613       <span class="keywordtype">double</span> b = (sqrt(s) - mr[i])/h;
<a name="l00614"></a>00614       <span class="keywordtype">double</span> a = 1-b;
<a name="l00615"></a>00615     <span class="comment">//double c = a*a*a-a;</span>
<a name="l00616"></a>00616     <span class="comment">//double d = b*b*b-b;</span>
<a name="l00617"></a>00617     <span class="comment">//double y = a*y[i] + b*y[i+1] + (c*y_d2[i] + d*y_d2[i+1])*h*h/6;</span>
<a name="l00618"></a>00618       <span class="keyword">const</span> <span class="keywordtype">double</span> *y = this-&gt;<a class="code" href="classMConf_1_1pBase_1_1ngArray.html#79a2aa7c5a543dd9bbd86dfacd407409" title="returns constant pointer to the elements">constArray</a>();
<a name="l00619"></a>00619       <span class="keyword">const</span> <span class="keywordtype">double</span> *y_d2 = _d2.constArray();
<a name="l00620"></a>00620       <span class="keywordtype">double</span> yp = (y[i+1]-y[i])/h-( (3*a*a-1)*y_d2[i]-(3*b*b-1)*y_d2[i+1] )*h/6;
<a name="l00621"></a>00621       <span class="keywordflow">return</span> yp*e2r;
<a name="l00622"></a>00622     }
<a name="l00623"></a>00623 
<a name="l00624"></a>00624     <span class="keywordtype">bool</span> created; <span class="comment">// spline coeffs have been created if true</span>
<a name="l00625"></a>00625     CArray1d&lt;double&gt; _d2; <span class="comment">// spline coefficients</span>
<a name="l00626"></a>00626   };
<a name="l00627"></a>00627 
<a name="l00628"></a>00628   CArray1d&lt;double&gt; ms;         
<a name="l00629"></a>00629   CArray1d&lt;double&gt; mreff;      
<a name="l00630"></a>00630   CArray1d&lt;double&gt; msFull;     
<a name="l00631"></a>00631   CArray1d&lt;double&gt; mreffFull;  
<a name="l00632"></a>00632 
<a name="l00633"></a>00633   <a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">__spline</a> msPol;      
<a name="l00634"></a>00634   <a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">__spline</a> miota;      
<a name="l00635"></a>00635   <a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">__spline</a> mpres;      
<a name="l00636"></a>00636   <a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">__spline</a> mIpol;      
<a name="l00637"></a>00637   <a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">__spline</a> mItor;      
<a name="l00638"></a>00638   <a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">__spline</a> mpprime;    
<a name="l00639"></a>00639   <a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">__spline</a> mg00;       
<a name="l00640"></a>00640   <a class="code" href="classMConf_1_1CStconfig.html#48f5df706304a1649d6b674326627293">__spline</a> mVolume;    
<a name="l00641"></a>00641 
<a name="l00642"></a>00642   CArray1d&lt;int&gt; mpM; 
<a name="l00643"></a>00643   CArray1d&lt;int&gt; mpN; 
<a name="l00644"></a>00644   <span class="keywordtype">int</span> mNs;            
<a name="l00645"></a>00645   <span class="keywordtype">int</span> mNs0;           
<a name="l00646"></a>00646   <span class="keywordtype">int</span> mM;             
<a name="l00647"></a>00647   <span class="keywordtype">int</span> mN;             
<a name="l00648"></a>00648   <span class="keywordtype">int</span> MminCurrent;
<a name="l00649"></a>00649   <span class="keywordtype">int</span> NminCurrent;
<a name="l00650"></a>00650   <span class="keywordtype">int</span> MmaxCurrent;
<a name="l00651"></a>00651   <span class="keywordtype">int</span> NmaxCurrent;
<a name="l00652"></a>00652 <span class="comment">//harmonics</span>
<a name="l00653"></a>00653   CArray1d&lt;double&gt; mCOEF;  
<a name="l00654"></a>00654   <span class="keywordtype">int</span> offsetN;    
<a name="l00655"></a>00655   <span class="keywordtype">int</span> offsetM;    
<a name="l00656"></a>00656   <span class="keywordtype">int</span> offsetS;    
<a name="l00657"></a>00657 
<a name="l00658"></a>00658 <span class="comment">//mCOEF[ns][m+1][2*n+1][8];</span>
<a name="l00659"></a>00659 <span class="comment">//mCOEF[I][M][N][K];</span>
<a name="l00660"></a>00660 <span class="comment">//mCOEF[i][m][n][k] = mCOEF[k+ n*K       + m*N*K     + i*M*N*K  ]</span>
<a name="l00661"></a>00661 <span class="comment">//mCOEF[i][m][n][k] = mCOEF[k+ n*offsetN + m*offsetM + i*offsetS]</span>
<a name="l00662"></a>00662 
<a name="l00663"></a>00663   <span class="keywordtype">double</span> mFlux;       
<a name="l00664"></a>00664   <span class="keywordtype">double</span> mPolFlux;    
<a name="l00665"></a>00665   <span class="keywordtype">double</span> ma;          
<a name="l00666"></a>00666   <span class="keywordtype">double</span> mR0;         
<a name="l00667"></a>00667   <span class="keywordtype">double</span> mZ0;         
<a name="l00668"></a>00668   <span class="keywordtype">double</span> mB0;         
<a name="l00669"></a>00669   <span class="keywordtype">double</span> mB0max;      
<a name="l00670"></a>00670   <span class="keywordtype">double</span> mBnorm;      
<a name="l00671"></a>00671   <span class="keywordtype">double</span> mmodBtol;    
<a name="l00672"></a>00672   <span class="keywordtype">double</span> mCrossArea;  
<a name="l00673"></a>00673   <span class="keywordtype">double</span> mB2VolAvrg;  
<a name="l00674"></a>00674   <span class="keywordtype">double</span> sLast;      
<a name="l00675"></a>00675   <span class="keywordtype">double</span> s1st;       
<a name="l00676"></a>00676   <span class="keywordtype">int</span> mLCMSindex;    
<a name="l00677"></a>00677   <span class="keywordtype">int</span> m1stSindex;    
<a name="l00678"></a>00678   <span class="keywordtype">int</span> mNsAdd;        
<a name="l00679"></a>00679   <span class="keywordtype">int</span> mDirTheta;     
<a name="l00680"></a>00680   <span class="keywordtype">int</span> mDirPhi;       
<a name="l00681"></a>00681   <span class="keywordtype">int</span> mSignJac_s;    
<a name="l00682"></a>00682   <span class="keywordtype">bool</span> mNewFormat;   
<a name="l00683"></a>00683   <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c">fileFormat</a> formatOfLoadedFile;
<a name="l00684"></a>00684 
<a name="l00685"></a>00685 
<a name="l00686"></a>00686   CArray1d&lt;Vector3d&gt; mBorderMagCoord; 
<a name="l00687"></a>00687   CArray1d&lt;Vector3d&gt; mBorder;       
<a name="l00688"></a>00688   <span class="keywordtype">double</span> mBorderRmin, mBorderZmin; 
<a name="l00689"></a>00689   <span class="keywordtype">double</span> mBorderRmax, mBorderZmax; 
<a name="l00690"></a>00690 
<a name="l00691"></a>00691   Vector3d  Smatrix[3];   
<a name="l00692"></a>00692 
<a name="l00693"></a>00693   <span class="keywordtype">void</span> * workPointer;
<a name="l00694"></a>00694 
<a name="l00695"></a>00695 <span class="keyword">protected</span>:
<a name="l00696"></a><a class="code" href="classMConf_1_1CStconfig.html#36af5bac69565649de012257e9a1f251">00696</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#36af5bac69565649de012257e9a1f251" title="result of the last operation">mOK</a>;              
<a name="l00697"></a><a class="code" href="classMConf_1_1CStconfig.html#10386205c6a9b6c218b301656711b2c3">00697</a>   std::string <a class="code" href="classMConf_1_1CStconfig.html#10386205c6a9b6c218b301656711b2c3" title="name of the file, that was read">mfname</a>;         
<a name="l00698"></a><a class="code" href="classMConf_1_1CStconfig.html#31c17cc321db72d5ab448b71ea92792f">00698</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#31c17cc321db72d5ab448b71ea92792f" title="= 3.14159265358979">pi</a>;             
<a name="l00699"></a><a class="code" href="classMConf_1_1CStconfig.html#909ffd84606c7ce005c63fd884ed691d">00699</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#909ffd84606c7ce005c63fd884ed691d">twopi</a>;
<a name="l00700"></a><a class="code" href="classMConf_1_1CStconfig.html#3e3c403d70392b0e8386775c80b4cad2">00700</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#3e3c403d70392b0e8386775c80b4cad2">twopiinv</a>;
<a name="l00701"></a><a class="code" href="classMConf_1_1CStconfig.html#898dd6a34705b5d7bc205d411556d62b">00701</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#898dd6a34705b5d7bc205d411556d62b" title="= pi/180;">degree</a>;         
<a name="l00702"></a><a class="code" href="classMConf_1_1CStconfig.html#8b6425350e90ac5f32ce512faf3dee7c">00702</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#8b6425350e90ac5f32ce512faf3dee7c" title="= pi*4e-7 [N/A^2 = henry/m]">mu0</a>;            
<a name="l00703"></a><a class="code" href="classMConf_1_1CStconfig.html#7b9b2660e348371e43e02f7657d8f3cd">00703</a>   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#7b9b2660e348371e43e02f7657d8f3cd" title="number of periods">mNp</a>;            
<a name="l00704"></a><a class="code" href="classMConf_1_1CStconfig.html#980b0313f60f6c13454a331d07772846">00704</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#980b0313f60f6c13454a331d07772846" title="twopi/mNp">mPeriod</a>;     
<a name="l00705"></a><a class="code" href="classMConf_1_1CStconfig.html#7e0e1f7e47e8d027ce5c1cdcf084b03c">00705</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#43d9e7f6f122dd23aeb1d4ab1f82e35c">mepsA</a>, <a class="code" href="classMConf_1_1CStconfig.html#7e0e1f7e47e8d027ce5c1cdcf084b03c" title="absolute and relative accuracy of coordinate transformation">mepsR</a>;
<a name="l00706"></a>00706 
<a name="l00707"></a>00707 <span class="comment">//public:  // for testing</span>
<a name="l00710"></a>00710 <span class="comment"></span>
<a name="l00711"></a><a class="code" href="group__NewtonMethod.html#ged494b7feda522363e4abfa91d2ebb27">00711</a>   <span class="keywordtype">int</span> <a class="code" href="group__NewtonMethod.html#ged494b7feda522363e4abfa91d2ebb27">mNGuessCalls</a>;  
<a name="l00712"></a><a class="code" href="group__NewtonMethod.html#g985ec02fa37f4c1923e2e2933c9dca27">00712</a>   <span class="keywordtype">int</span> <a class="code" href="group__NewtonMethod.html#g985ec02fa37f4c1923e2e2933c9dca27" title="number of jacobian calculation">mNjac</a>;          
<a name="l00713"></a><a class="code" href="group__NewtonMethod.html#g4d6f363f84a5746b4f72cf8b8e8f629a">00713</a>   <span class="keywordtype">int</span> <a class="code" href="group__NewtonMethod.html#g4d6f363f84a5746b4f72cf8b8e8f629a" title="number of poloiodal mod">mMsum</a>;          
<a name="l00714"></a><a class="code" href="group__NewtonMethod.html#g427e5e4d559a57963c02835dbafeeff1">00714</a>   <span class="keywordtype">int</span> <a class="code" href="group__NewtonMethod.html#g427e5e4d559a57963c02835dbafeeff1" title="number of toroidal mod">mNsum</a>;          
<a name="l00715"></a><a class="code" href="group__NewtonMethod.html#gebcb75c75476c06501df15a8b113e72a">00715</a>   <span class="keywordtype">int</span> <a class="code" href="group__NewtonMethod.html#gebcb75c75476c06501df15a8b113e72a" title="number of calling of cyl2mag-function(Newton&amp;#39;s iteration)">mNcyl2mag</a>;      
<a name="l00716"></a><a class="code" href="group__NewtonMethod.html#g79972f1eca65bac185048eb744f75ae7">00716</a>   <span class="keywordtype">int</span> <a class="code" href="group__NewtonMethod.html#g79972f1eca65bac185048eb744f75ae7" title="number of calling of mag2cyl-function">mNmag2cyl</a>;      
<a name="l00717"></a><a class="code" href="group__NewtonMethod.html#g66950b541cb87b3c69410f102268437c">00717</a>   <span class="keywordtype">int</span> <a class="code" href="group__NewtonMethod.html#g66950b541cb87b3c69410f102268437c">mMsum2</a>;
<a name="l00718"></a><a class="code" href="group__NewtonMethod.html#g30e20dd45b2fa50f4616ed76d5dce723">00718</a>   <span class="keywordtype">int</span> <a class="code" href="group__NewtonMethod.html#g30e20dd45b2fa50f4616ed76d5dce723">mNsum2</a>;
<a name="l00719"></a><a class="code" href="group__NewtonMethod.html#g62a38532049d3927d5cb49a0c54f218c">00719</a>   <span class="keywordtype">int</span> <a class="code" href="group__NewtonMethod.html#g62a38532049d3927d5cb49a0c54f218c" title="used in cyl2guess for">mRoughCalculation</a>; 
<a name="l00720"></a>00720 
<a name="l00721"></a>00721 
<a name="l00722"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html">00722</a>   <span class="keyword">struct </span><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html" title="The internal structure holds things after last coordinate transformation/NJacobian...">ctResults</a> {
<a name="l00723"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#ba445f24bc9216cf06b0b71926bae7f0">00723</a>     <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#ba445f24bc9216cf06b0b71926bae7f0">ctResults</a>() {
<a name="l00724"></a>00724       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#c512c16608df2f12bbafd7be3caba52c">is</a> = 0;
<a name="l00725"></a>00725       s = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#5648808efe4577ee6ad51f87b2c12bbf">modB</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#733571ed842d814813d897f5d304ab4a">jac</a>  = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#33129f7d056bd88259ac1b6d83363ec9">jacMixProd</a> = 0;     
<a name="l00726"></a>00726       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#72d7ae0c7ed132857cd4b3985334db83">jacVmec</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#8eb1fcbd891081772bfc14f3fa424aaa">jacBoozer</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#ace2d484b0e3651abd108f04803d316c">p</a>=<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#2b58822b2dc20f33784218fa3dd7f7e5">ps</a>=<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#013c7831c9db758d249126e6fe1ed020">pt</a>=<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#6a463ecf96d59180d80acce7c92b6b04">pp</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#3db359547eed8cfd48ca821d95f577af">lambda</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#453309406d8ccf6298253f8f5245ea16">lambdas</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#95432aa27081d1a6da7f92e85809b428">lambdat</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#b0b00a3e065ce8629a701c6d0907c016">lambdap</a> = 0; 
<a name="l00727"></a>00727       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#aa386d83c198a6fc7e4ae5a20bf375f9">axisLast</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#7f880429987cbcd9441cc93ab912d0f9">xyzLast</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#6265f060347fa5015bddd74ba21e411e">mBnormLast</a> = 1e128; 
<a name="l00728"></a>00728     }
<a name="l00729"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#893f1101c650c08c98612515c2b1a89c">00729</a>     <span class="keywordtype">void</span> <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#893f1101c650c08c98612515c2b1a89c">invalidate</a>() { <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#aa386d83c198a6fc7e4ae5a20bf375f9">axisLast</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#7f880429987cbcd9441cc93ab912d0f9">xyzLast</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#6265f060347fa5015bddd74ba21e411e">mBnormLast</a> = 1e128;}
<a name="l00730"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#bf34a7759bec9986145401cbb73ed1c6">00730</a>     <span class="keywordtype">bool</span> <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#bf34a7759bec9986145401cbb73ed1c6">isCoordValid</a>() { <span class="keywordflow">return</span> (<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a>[0]&gt;=1e127)?<span class="keyword">false</span>:<span class="keyword">true</span>; }
<a name="l00731"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#54678c4e08bb6858a23d807851650e88">00731</a>     <span class="keywordtype">bool</span> <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#54678c4e08bb6858a23d807851650e88">isBnormValid</a>(<span class="keywordtype">double</span> mBnorma) { <span class="keywordflow">return</span> (<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#6265f060347fa5015bddd74ba21e411e">mBnormLast</a>==mBnorma)?<span class="keyword">true</span>:<span class="keyword">false</span>; }
<a name="l00732"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#b0f5ad91ae688597e6e745c9004de5ac">00732</a>     <span class="keywordtype">bool</span> <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#b0f5ad91ae688597e6e745c9004de5ac">isAxisValid</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl) {
<a name="l00733"></a>00733       <span class="keywordflow">if</span>(!<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#bf34a7759bec9986145401cbb73ed1c6">isCoordValid</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00734"></a>00734       <span class="keywordflow">return</span> (fabs(<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#aa386d83c198a6fc7e4ae5a20bf375f9">axisLast</a>[1]-cyl[1])&lt;1e-8)?<span class="keyword">true</span>:<span class="keyword">false</span>;
<a name="l00735"></a>00735     }
<a name="l00736"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#dc949e8260f06bfab37e41ce43118ba0">00736</a>     <span class="keywordtype">bool</span> <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#dc949e8260f06bfab37e41ce43118ba0">isCylValid</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<span class="keywordtype">double</span> mBnorma) {
<a name="l00737"></a>00737       <span class="keywordflow">if</span>(!<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#bf34a7759bec9986145401cbb73ed1c6">isCoordValid</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00738"></a>00738       <span class="keywordflow">if</span>(!<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#54678c4e08bb6858a23d807851650e88">isBnormValid</a>(mBnorma)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00739"></a>00739       <span class="keywordflow">return</span> (cyl==<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a>)?<span class="keyword">true</span>:<span class="keyword">false</span>;
<a name="l00740"></a>00740 <span class="comment">//      return (diffCyl2(cyl)&lt;1e-20)?true:false;  // may be this will be better?</span>
<a name="l00741"></a>00741     }
<a name="l00742"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#7abd456094ea8aba4ab40dd9d7bf7b33">00742</a>     <span class="keywordtype">bool</span> <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#7abd456094ea8aba4ab40dd9d7bf7b33">isXyzValid</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz,<span class="keywordtype">double</span> mBnorma) {
<a name="l00743"></a>00743       <span class="keywordflow">if</span>(!<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#bf34a7759bec9986145401cbb73ed1c6">isCoordValid</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00744"></a>00744       <span class="keywordflow">if</span>(!<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#54678c4e08bb6858a23d807851650e88">isBnormValid</a>(mBnorma)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00745"></a>00745       <span class="keywordflow">return</span> (<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#ee2614cabb80bf3999efdc7678a60e88">diffXyz2</a>(xyz)&lt;1e-20)?<span class="keyword">true</span>:<span class="keyword">false</span>;
<a name="l00746"></a>00746     }
<a name="l00747"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#d0c1f26851bf10987c11c2da5562e969">00747</a>     <span class="keywordtype">double</span> <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#d0c1f26851bf10987c11c2da5562e969">diffCyl2</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;c) {
<a name="l00748"></a>00748       <span class="comment">// dR - distance between points: dR=(r-cylLast)</span>
<a name="l00749"></a>00749       <span class="comment">// @return dR^2</span>
<a name="l00750"></a>00750       <span class="keywordtype">double</span> dfi = c.<a class="code" href="classMConf_1_1Vector3d.html#d927d9808ded1fc49c05ae9e1a3ed2a6" title="Get reference to the second component for reading/writing.">y</a>()-<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a>.<a class="code" href="classMConf_1_1Vector3d.html#d927d9808ded1fc49c05ae9e1a3ed2a6" title="Get reference to the second component for reading/writing.">y</a>();
<a name="l00751"></a>00751       <span class="keywordtype">double</span> dR2 = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a>.<a class="code" href="classMConf_1_1Vector3d.html#3b195b867437acf8de45f48c83e81932" title="Get reference to the first component for reading/writing.">x</a>()*<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a>.<a class="code" href="classMConf_1_1Vector3d.html#3b195b867437acf8de45f48c83e81932" title="Get reference to the first component for reading/writing.">x</a>() + c.<a class="code" href="classMConf_1_1Vector3d.html#3b195b867437acf8de45f48c83e81932" title="Get reference to the first component for reading/writing.">x</a>()*c.<a class="code" href="classMConf_1_1Vector3d.html#3b195b867437acf8de45f48c83e81932" title="Get reference to the first component for reading/writing.">x</a>() 
<a name="l00752"></a>00752                 - 2*<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a>.<a class="code" href="classMConf_1_1Vector3d.html#3b195b867437acf8de45f48c83e81932" title="Get reference to the first component for reading/writing.">x</a>()*c.<a class="code" href="classMConf_1_1Vector3d.html#3b195b867437acf8de45f48c83e81932" title="Get reference to the first component for reading/writing.">x</a>()*::cos(dfi) 
<a name="l00753"></a>00753                 + (c.<a class="code" href="classMConf_1_1Vector3d.html#2134ad02d68f29e9c7cd87e4cd4c75b8" title="Get reference to the third component for reading/writing.">z</a>()-<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a>.<a class="code" href="classMConf_1_1Vector3d.html#2134ad02d68f29e9c7cd87e4cd4c75b8" title="Get reference to the third component for reading/writing.">z</a>())*(c.<a class="code" href="classMConf_1_1Vector3d.html#2134ad02d68f29e9c7cd87e4cd4c75b8" title="Get reference to the third component for reading/writing.">z</a>()-<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a>.<a class="code" href="classMConf_1_1Vector3d.html#2134ad02d68f29e9c7cd87e4cd4c75b8" title="Get reference to the third component for reading/writing.">z</a>());
<a name="l00754"></a>00754       <span class="keywordflow">return</span> dR2;
<a name="l00757"></a>00757     }
<a name="l00758"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#ee2614cabb80bf3999efdc7678a60e88">00758</a>     <span class="keywordtype">double</span> <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#ee2614cabb80bf3999efdc7678a60e88">diffXyz2</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>) {
<a name="l00759"></a>00759       <span class="keywordflow">return</span> (<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#7f880429987cbcd9441cc93ab912d0f9">xyzLast</a>-r).abs2();
<a name="l00760"></a>00760     }
<a name="l00761"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#2c06a5facd2e08dd1e7346791b3a659a">00761</a>     <span class="keywordtype">void</span> <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#2c06a5facd2e08dd1e7346791b3a659a">saveLastJacobian</a>(<span class="keywordtype">double</span> Bnorm) {
<a name="l00762"></a>00762       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#6265f060347fa5015bddd74ba21e411e">mBnormLast</a> = Bnorm;
<a name="l00763"></a>00763       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#51cac7140168c7f667fbaf991c7e5525">magLast</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#3d80919f648c5449448e6adca848a0f7">Jmatr</a>[4];
<a name="l00764"></a>00764       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#3d80919f648c5449448e6adca848a0f7">Jmatr</a>[0];
<a name="l00765"></a>00765       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#7f880429987cbcd9441cc93ab912d0f9">xyzLast</a> = <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a>.<a class="code" href="classMConf_1_1Vector3d.html#f127a11368c7e7e10247d2531f34d53f" title="The method returns cartesian coordinates of the point assuming this object contains...">toCartesian</a>();
<a name="l00766"></a>00766       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#19dc1e61b03b32b47646b4b983e922fa">Jlast</a>[0]=<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#3d80919f648c5449448e6adca848a0f7">Jmatr</a>[0]; 
<a name="l00767"></a>00767       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#19dc1e61b03b32b47646b4b983e922fa">Jlast</a>[1]=<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#3d80919f648c5449448e6adca848a0f7">Jmatr</a>[1]; 
<a name="l00768"></a>00768       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#19dc1e61b03b32b47646b4b983e922fa">Jlast</a>[2]=<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#3d80919f648c5449448e6adca848a0f7">Jmatr</a>[2]; 
<a name="l00769"></a>00769       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#19dc1e61b03b32b47646b4b983e922fa">Jlast</a>[3]=<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#3d80919f648c5449448e6adca848a0f7">Jmatr</a>[3]; 
<a name="l00770"></a>00770       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#19dc1e61b03b32b47646b4b983e922fa">Jlast</a>[4]=<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#3d80919f648c5449448e6adca848a0f7">Jmatr</a>[4];
<a name="l00771"></a>00771     }
<a name="l00772"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#c512c16608df2f12bbafd7be3caba52c">00772</a>     <span class="keywordtype">int</span>       <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#c512c16608df2f12bbafd7be3caba52c">is</a>;
<a name="l00773"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#d62e712560f6344b96d4c080a2ba9c92">00773</a>     <span class="keywordtype">double</span>    s;
<a name="l00774"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#5648808efe4577ee6ad51f87b2c12bbf">00774</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#5648808efe4577ee6ad51f87b2c12bbf">modB</a>;     <span class="comment">// |B|</span>
<a name="l00775"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#733571ed842d814813d897f5d304ab4a">00775</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#733571ed842d814813d897f5d304ab4a">jac</a>;       <span class="comment">// Jacobian in coordinates (torFlux,theta,phi), for example in boozer coordinates the  jac ~ mu0/(4*pi^2)*Ipol/B^2</span>
<a name="l00776"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#33129f7d056bd88259ac1b6d83363ec9">00776</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#33129f7d056bd88259ac1b6d83363ec9">jacMixProd</a>;<span class="comment">// Jacobian in coordinates (torFlux,theta,phi) from mixed product of basis vectors: R/mFlux*(Rs*(Rt^Rp))</span>
<a name="l00777"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#72d7ae0c7ed132857cd4b3985334db83">00777</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#72d7ae0c7ed132857cd4b3985334db83">jacVmec</a>;    <span class="comment">// Vmec Jacobian   in  (s,theta,phi)</span>
<a name="l00778"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#8eb1fcbd891081772bfc14f3fa424aaa">00778</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#8eb1fcbd891081772bfc14f3fa424aaa">jacBoozer</a>;  <span class="comment">// Boozer Jacobian in  (s,theta,phi)</span>
<a name="l00779"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#ace2d484b0e3651abd108f04803d316c">00779</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#ace2d484b0e3651abd108f04803d316c">p</a>;        <span class="comment">// p function for transformation vmec to boozer angle: thetaB = theta + lambda + iota*p, phiB = phi + p</span>
<a name="l00780"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#2b58822b2dc20f33784218fa3dd7f7e5">00780</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#2b58822b2dc20f33784218fa3dd7f7e5">ps</a>;       <span class="comment">// d(p)/ds</span>
<a name="l00781"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#013c7831c9db758d249126e6fe1ed020">00781</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#013c7831c9db758d249126e6fe1ed020">pt</a>;       <span class="comment">// d(p)/dtheta</span>
<a name="l00782"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#6a463ecf96d59180d80acce7c92b6b04">00782</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#6a463ecf96d59180d80acce7c92b6b04">pp</a>;       <span class="comment">// d(p)/dphi</span>
<a name="l00783"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#3db359547eed8cfd48ca821d95f577af">00783</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#3db359547eed8cfd48ca821d95f577af">lambda</a>;   <span class="comment">// Vmec stream function lambda</span>
<a name="l00784"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#453309406d8ccf6298253f8f5245ea16">00784</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#453309406d8ccf6298253f8f5245ea16">lambdas</a>;  <span class="comment">// d(lambda)/ds</span>
<a name="l00785"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#95432aa27081d1a6da7f92e85809b428">00785</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#95432aa27081d1a6da7f92e85809b428">lambdat</a>;  <span class="comment">// d(lambda)/dtheta</span>
<a name="l00786"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#b0b00a3e065ce8629a701c6d0907c016">00786</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#b0b00a3e065ce8629a701c6d0907c016">lambdap</a>;  <span class="comment">// d(lambda)/dphi</span>
<a name="l00787"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#6265f060347fa5015bddd74ba21e411e">00787</a>     <span class="keywordtype">double</span>    <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#6265f060347fa5015bddd74ba21e411e">mBnormLast</a>; <span class="comment">// last norm. factor for |B| for which coord.trans. has been made by cyl2mag() or xyz2mag()</span>
<a name="l00788"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#aa386d83c198a6fc7e4ae5a20bf375f9">00788</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#aa386d83c198a6fc7e4ae5a20bf375f9">axisLast</a>;  <span class="comment">// last axis position at which coord.trans. has been made by xyz2mag</span>
<a name="l00789"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#7f880429987cbcd9441cc93ab912d0f9">00789</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#7f880429987cbcd9441cc93ab912d0f9">xyzLast</a>;  <span class="comment">// last cartesian coordinates for which coord.trans. has been made by xyz2mag</span>
<a name="l00790"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">00790</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#909a1be696f995f0d5d2c0ee9465b764">cylLast</a>;  <span class="comment">// last cylindrical coordinates for which coord.trans. has been made by cyl2mag</span>
<a name="l00791"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#51cac7140168c7f667fbaf991c7e5525">00791</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#51cac7140168c7f667fbaf991c7e5525">magLast</a>;  <span class="comment">// last magnetic coordinates from cyl2mag</span>
<a name="l00792"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#19dc1e61b03b32b47646b4b983e922fa">00792</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#19dc1e61b03b32b47646b4b983e922fa">Jlast</a>[5]; <span class="comment">// last Coordinates and jacobian matrix are here</span>
<a name="l00793"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#640c1697ec13b9c1884b6ccc4e7479f6">00793</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#640c1697ec13b9c1884b6ccc4e7479f6">Bxyz</a>;     <span class="comment">// B field in cartesian coordinates </span>
<a name="l00794"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#4384a707c27d7ce739dc448cbf241433">00794</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#4384a707c27d7ce739dc448cbf241433">Bcyl</a>;     <span class="comment">// B field in cyl. coordinates </span>
<a name="l00795"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#b13370bcfadfbf585e8c8e683ea6fb23">00795</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#b13370bcfadfbf585e8c8e683ea6fb23">Bcontra</a>;  <span class="comment">// B field contravariant components (0,B^theta,B^phi) </span>
<a name="l00796"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#6b02bc132124279e9050027c46907d5d">00796</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#6b02bc132124279e9050027c46907d5d">Bcova</a>;    <span class="comment">// B field covariant components (B_s,B_theta,B_phi) in (s,theta,phi) coordinates </span>
<a name="l00797"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#14df9fb59dca07e190249dcc795a6243">00797</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#14df9fb59dca07e190249dcc795a6243">gradTheta</a>;  <span class="comment">// grad(theta)  = (Xp^Xf)/jac in cyl. coord, theta is the poloidal angle</span>
<a name="l00798"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#cf88db770b81080081a327b6fa210593">00798</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#cf88db770b81080081a327b6fa210593">gradPhi</a>;    <span class="comment">// grad(phi)    = (Xf^Xt)/jac in cyl. coord, phi is the toroidal angle</span>
<a name="l00799"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#2f5364252649cb4b9b8140e92dc94d09">00799</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#2f5364252649cb4b9b8140e92dc94d09">gradtorFlux</a>;<span class="comment">// grad(torFlux)= (Xt^Xp)/jac in cyl. coord, Psi_tor is the toroidal flux</span>
<a name="l00800"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#61bace4996df3d92880b522062f6c27c">00800</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#61bace4996df3d92880b522062f6c27c">gradS</a>;      <span class="comment">// grad(s)    in cyl. coord</span>
<a name="l00801"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#a1a77d20c08fb1cf0c09a6d60d2e8515">00801</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#a1a77d20c08fb1cf0c09a6d60d2e8515">gradReff</a>;   <span class="comment">// grad(reff) in cyl. coord</span>
<a name="l00802"></a>00802 
<a name="l00803"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#3d80919f648c5449448e6adca848a0f7">00803</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#3d80919f648c5449448e6adca848a0f7">Jmatr</a>[5]; <span class="comment">// Coordinates and jacobian matrix are here, see CStconfig::NJacobian()</span>
<a name="l00804"></a>00804                         <span class="comment">//Jmatr[0] = F  == (R,fi,Z)</span>
<a name="l00805"></a>00805                         <span class="comment">//Jmatr[1] = Fs == d(R,fi,Z)/ds   -- partial derivative on s</span>
<a name="l00806"></a>00806                         <span class="comment">//Jmatr[2] = Ft == d(R,fi,Z)/dtheta</span>
<a name="l00807"></a>00807                         <span class="comment">//Jmatr[3] = Fp == d(R,fi,Z)/dphi</span>
<a name="l00808"></a>00808                         <span class="comment">//Jmatr[4] = u  == (s,theta,phi) coordinates</span>
<a name="l00809"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#d4c6d57e4106f6e65e80bd544bf97704">00809</a>     <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#d4c6d57e4106f6e65e80bd544bf97704">gsTensor</a>[3];  <span class="comment">// Metric tensor g_ij  in (s,theta,phi) coordinates</span>
<a name="l00812"></a>00812 <span class="comment"></span>  };
<a name="l00813"></a><a class="code" href="group__NewtonMethod.html#gcc100a0a40eb6029b4d78263b247eb2d">00813</a>   <span class="keyword">struct </span><a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html" title="The internal fast stack for ctResults.">ctStack</a>;
<a name="l00814"></a>00814   <span class="keyword">friend</span> <span class="keyword">struct </span><a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html" title="The internal fast stack for ctResults.">ctStack</a>;
<a name="l00816"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html">00816</a>   <span class="keyword">struct </span><a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html" title="The internal fast stack for ctResults.">ctStack</a> : std::vector&lt;ctResults&gt; {
<a name="l00817"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#103fe1fcacccda7d9cdacde44721faef">00817</a>     <span class="keywordtype">size_t</span> <a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#103fe1fcacccda7d9cdacde44721faef">idx</a>;
<a name="l00818"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#1811e3b899c1a17e576890cc12f20a06">00818</a>     <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html" title="The internal structure holds things after last coordinate transformation/NJacobian...">ctResults</a> a;
<a name="l00819"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#f201239ec6c059299ed5478f751547bf">00819</a>     <a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#f201239ec6c059299ed5478f751547bf">ctStack</a>() { <a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#103fe1fcacccda7d9cdacde44721faef">idx</a>=0; push_back(a); }
<a name="l00820"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#671ff3ff061922949142c09dd353b321">00820</a>     <span class="keyword">const</span> <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html" title="The internal structure holds things after last coordinate transformation/NJacobian...">ctResults</a> &amp; <a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#671ff3ff061922949142c09dd353b321">operator() </a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> at(<a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#103fe1fcacccda7d9cdacde44721faef">idx</a>); }
<a name="l00821"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#3316dca1f38b352985e131a9962ed6aa">00821</a>     <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html" title="The internal structure holds things after last coordinate transformation/NJacobian...">ctResults</a> &amp; <a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#671ff3ff061922949142c09dd353b321">operator() </a>() { <span class="keywordflow">return</span> <a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#7d2a7ccdfc7c2aeca98b38561df1615e">top</a>(); }
<a name="l00822"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#7d2a7ccdfc7c2aeca98b38561df1615e">00822</a>     <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html" title="The internal structure holds things after last coordinate transformation/NJacobian...">ctResults</a> &amp; <a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#7d2a7ccdfc7c2aeca98b38561df1615e">top</a>() {
<a name="l00823"></a>00823       <span class="keywordflow">while</span>(size()&lt;=<a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#103fe1fcacccda7d9cdacde44721faef">idx</a>) push_back(a);
<a name="l00824"></a>00824       <span class="comment">//test if(idx&gt;1) std::cerr&lt;&lt;"stack:"&lt;&lt;idx&lt;&lt;std::endl;</span>
<a name="l00825"></a>00825       <span class="keywordflow">return</span> at(<a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#103fe1fcacccda7d9cdacde44721faef">idx</a>);
<a name="l00826"></a>00826     };
<a name="l00830"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctStack_1_1saveState.html">00830</a>     <span class="keyword">struct </span><a class="code" href="structMConf_1_1CStconfig_1_1ctStack_1_1saveState.html" title="The internal class increments an index at given address, the destructor restores...">saveState</a> {
<a name="l00831"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctStack_1_1saveState.html#28d2c6d60554e64f5cae297006a88a63">00831</a>       <a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html" title="The internal fast stack for ctResults.">ctStack</a>* <a class="code" href="structMConf_1_1CStconfig_1_1ctStack_1_1saveState.html#28d2c6d60554e64f5cae297006a88a63">pct</a>;
<a name="l00832"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctStack_1_1saveState.html#5a71b1171555d12b94f84ad727ce8f87">00832</a>       <a class="code" href="structMConf_1_1CStconfig_1_1ctStack_1_1saveState.html#5a71b1171555d12b94f84ad727ce8f87">saveState</a>(<a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html" title="The internal fast stack for ctResults.">ctStack</a> &amp;<a class="code" href="group__NewtonMethod.html#g16aa4a012601743c4a7747f79c8e1150">ct</a>) {
<a name="l00833"></a>00833         <a class="code" href="structMConf_1_1CStconfig_1_1ctStack_1_1saveState.html#28d2c6d60554e64f5cae297006a88a63">pct</a> = &amp;ct;
<a name="l00834"></a>00834         ct.<a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#103fe1fcacccda7d9cdacde44721faef">idx</a>++;  <span class="comment">// increment stack counter</span>
<a name="l00835"></a>00835         ct.<a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#7d2a7ccdfc7c2aeca98b38561df1615e">top</a>();  <span class="comment">// add empty elements to stack if needed</span>
<a name="l00836"></a>00836       }
<a name="l00837"></a><a class="code" href="structMConf_1_1CStconfig_1_1ctStack_1_1saveState.html#66937386fd482af2c1838429000c0ce9">00837</a>       <a class="code" href="structMConf_1_1CStconfig_1_1ctStack_1_1saveState.html#66937386fd482af2c1838429000c0ce9">~saveState</a>() {
<a name="l00838"></a>00838         <a class="code" href="structMConf_1_1CStconfig_1_1ctStack_1_1saveState.html#28d2c6d60554e64f5cae297006a88a63">pct</a>-&gt;<a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#7d2a7ccdfc7c2aeca98b38561df1615e">top</a>().<a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html#893f1101c650c08c98612515c2b1a89c">invalidate</a>();
<a name="l00839"></a>00839         <a class="code" href="structMConf_1_1CStconfig_1_1ctStack_1_1saveState.html#28d2c6d60554e64f5cae297006a88a63">pct</a>-&gt;<a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html#103fe1fcacccda7d9cdacde44721faef">idx</a>--; <span class="comment">// restore stack index</span>
<a name="l00840"></a>00840       }
<a name="l00841"></a>00841     };
<a name="l00842"></a>00842   };
<a name="l00843"></a>00843   
<a name="l00844"></a><a class="code" href="group__NewtonMethod.html#g16aa4a012601743c4a7747f79c8e1150">00844</a>   <a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html" title="The internal fast stack for ctResults.">ctStack</a> <a class="code" href="group__NewtonMethod.html#g16aa4a012601743c4a7747f79c8e1150">ct</a>;
<a name="l00845"></a>00845 
<a name="l00846"></a>00846 <span class="preprocessor">#if 0</span>
<a name="l00847"></a>00847 <span class="preprocessor"></span>  std::stack&lt;ctResults&gt; <a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html" title="The internal fast stack for ctResults.">ctStack</a>;  <span class="comment">// stack for saving current transformation results</span>
<a name="l00848"></a>00848   <a class="code" href="structMConf_1_1CStconfig_1_1ctResults.html" title="The internal structure holds things after last coordinate transformation/NJacobian...">ctResults</a> res;
<a name="l00850"></a>00850   <span class="keywordtype">void</span> saveNJacData() {
<a name="l00851"></a>00851     <a class="code" href="structMConf_1_1CStconfig_1_1ctStack.html" title="The internal fast stack for ctResults.">ctStack</a>.push(res);
<a name="l00852"></a>00852   }
<a name="l00854"></a>00854   <span class="keywordtype">void</span> restoreNJacData() {
<a name="l00855"></a>00855     <span class="keywordflow">if</span> (!<a class="code" href="group__NewtonMethod.html#gcc100a0a40eb6029b4d78263b247eb2d">ctStack</a>.empty())
<a name="l00856"></a>00856       res = <a class="code" href="group__NewtonMethod.html#gcc100a0a40eb6029b4d78263b247eb2d">ctStack</a>.top();
<a name="l00857"></a>00857   }
<a name="l00858"></a>00858 <span class="preprocessor">#endif</span>
<a name="l00859"></a>00859 <span class="preprocessor"></span>
<a name="l00861"></a>00861 
<a name="l00862"></a>00862 <span class="keyword">public</span>:
<a name="l00865"></a><a class="code" href="classMConf_1_1CStconfig.html#a9da53587ef0b0158da3b755be6f70f5">00865</a>   <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * <a class="code" href="classMConf_1_1CStconfig.html#a9da53587ef0b0158da3b755be6f70f5" title="The method creates a clone of CStconfig using operator new.">clone</a>() {
<a name="l00866"></a>00866     <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> *mc = <span class="keyword">new</span> <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a>;
<a name="l00867"></a>00867     *mc = *<span class="keyword">this</span>; 
<a name="l00868"></a>00868     <span class="keywordflow">return</span> mc;
<a name="l00869"></a>00869   }
<a name="l00871"></a>00871   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classMConf_1_1CStconfig.html#dd90ed6ce299e1afd9cf2ddf23e3b722" title="The method returns the version of MConf in format year.month.">getVersion</a>();
<a name="l00873"></a><a class="code" href="classMConf_1_1CStconfig.html#122d35601e255373ff9019be8c741013">00873</a>   <a class="code" href="classMConf_1_1CStconfig.html#122d35601e255373ff9019be8c741013" title="The constructor creates an empty instance of CStconfig.">CStconfig</a>() {<a class="code" href="classMConf_1_1CStconfig.html#02fd73d861ef2e4aabb38c0c9ff82947" title="init everything before loading magnetic configuration">init</a>();}
<a name="l00875"></a><a class="code" href="classMConf_1_1CStconfig.html#8eb60d5261ff01519b25ea34722bc48a">00875</a>   <a class="code" href="classMConf_1_1CStconfig.html#8eb60d5261ff01519b25ea34722bc48a" title="The constructor creates an instance of CStconfig loading file.">CStconfig</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename) {<a class="code" href="classMConf_1_1CStconfig.html#02fd73d861ef2e4aabb38c0c9ff82947" title="init everything before loading magnetic configuration">init</a>(); <a class="code" href="classMConf_1_1CStconfig.html#04d7e86b811bab702d35da7dc1bd9c68" title="helper function for CStconfig::load()">loadfile</a>(filename,<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c605159e8a4c32319fd69b5d151369d93" title="file-format types, for internal use">UNDEFINED</a> );}
<a name="l00877"></a><a class="code" href="classMConf_1_1CStconfig.html#39789928469b4dceee902ee15b084710">00877</a>   <span class="keyword">virtual</span> <a class="code" href="classMConf_1_1CStconfig.html#39789928469b4dceee902ee15b084710" title="The destructor is a virtual method.">~CStconfig</a>() {
<a name="l00878"></a>00878     <a class="code" href="classMConf_1_1CStconfig.html#ae048282c7011eedc2e0492f6421ea73" title="The method frees all internal arrays and makes this object empty.">clear</a>();}
<a name="l00880"></a>00880   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#ae048282c7011eedc2e0492f6421ea73" title="The method frees all internal arrays and makes this object empty.">clear</a>();
<a name="l00882"></a>00882   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#2a67472e80b073a03e09f1890048c5cc" title="The method reload the current magnetic configuration to the right oriented (s,theta...">setRightCoordinateSystem</a>();
<a name="l00884"></a>00884   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#9933299ad8bc1ba5846338d578eaad51" title="The method reload the current magnetic configuration to the left oriented (s,theta...">setLeftCoordinateSystem</a>();
<a name="l00886"></a>00886   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#fb664d9312fae28f3fc02e0b3d1213ee" title="The method reload the current magnetic configuration to opposite oriented coordinate...">reverseCoordinateSystem</a>();
<a name="l00889"></a>00889   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#2c2705a188aa7c1149f02e2c05b1caa7" title="The method reload the current magnetic configuration to opposite oriented coordinate...">flipZcoordinate</a>();
<a name="l00891"></a>00891 
<a name="l00892"></a>00892 
<a name="l00893"></a>00893 
<a name="l00894"></a>00894 
<a name="l00895"></a>00895 
<a name="l00896"></a>00896 
<a name="l00897"></a>00897 
<a name="l00898"></a>00898 
<a name="l00899"></a>00899 
<a name="l00900"></a>00900 
<a name="l00901"></a>00901 
<a name="l00902"></a>00902 
<a name="l00903"></a>00903 
<a name="l00904"></a>00904 
<a name="l00905"></a>00905 
<a name="l00906"></a>00906 
<a name="l00907"></a>00907 
<a name="l00908"></a>00908 
<a name="l00909"></a>00909 
<a name="l00910"></a>00910 
<a name="l00911"></a>00911 
<a name="l00912"></a><a class="code" href="classMConf_1_1CStconfig.html#071b9a97170fd011e61fedaa0aae2dbc">00912</a>   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#071b9a97170fd011e61fedaa0aae2dbc" title="The method loads the magnetic configuration stored in the file filename.">load</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename)  { <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#04d7e86b811bab702d35da7dc1bd9c68" title="helper function for CStconfig::load()">loadfile</a>(filename,<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c605159e8a4c32319fd69b5d151369d93" title="file-format types, for internal use">UNDEFINED</a> );}
<a name="l00919"></a><a class="code" href="classMConf_1_1CStconfig.html#a7948ee41c7e4b9c45e02f3f0d70b050">00919</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#a7948ee41c7e4b9c45e02f3f0d70b050" title="The method loads the magnetic configuration stored in the file filename.">load</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename, <span class="keywordtype">long</span> filePosition)  { <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#04d7e86b811bab702d35da7dc1bd9c68" title="helper function for CStconfig::load()">loadfile</a>(filename,<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c605159e8a4c32319fd69b5d151369d93" title="file-format types, for internal use">UNDEFINED</a>,filePosition);}
<a name="l00923"></a><a class="code" href="classMConf_1_1CStconfig.html#834cc89251acbe4f604b6fa2fff5b5ad">00923</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#834cc89251acbe4f604b6fa2fff5b5ad" title="The method loads the G EQDSK file and transforms it to the tokamak-symmetry flux...">loadEFIT</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename)  { <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#04d7e86b811bab702d35da7dc1bd9c68" title="helper function for CStconfig::load()">loadfile</a>(filename,<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c1e8ffd92028690dc444ca74518a1ee30" title="G EQDSK File from EFIT.">EFIT</a>);}
<a name="l00927"></a><a class="code" href="classMConf_1_1CStconfig.html#65d3fe1f1f5aeac710ae7bc10a5b76cc">00927</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#65d3fe1f1f5aeac710ae7bc10a5b76cc" title="The method loads the magnetic configuration with Boozer coordinates from the file...">loadLHD</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename)  { <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#04d7e86b811bab702d35da7dc1bd9c68" title="helper function for CStconfig::load()">loadfile</a>(filename,<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369cd55ff5c103603fd13b9e8cfa50226136" title="LHD format.">LHD</a> );}
<a name="l00931"></a><a class="code" href="classMConf_1_1CStconfig.html#cd52dc099e9c295e5934acd39659cac3">00931</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#cd52dc099e9c295e5934acd39659cac3" title="The method loads the VMEC wout-file.">loadVMEC</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename)  { <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#04d7e86b811bab702d35da7dc1bd9c68" title="helper function for CStconfig::load()">loadfile</a>(filename,<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369cc62a83df9e5a1f2b70944a8f34b1d5ee" title="VMEC wout-format; use without transformation to Boozer coordinates.">VMEC</a>);}
<a name="l00935"></a>00935 <span class="preprocessor">#ifdef NETCDF</span>
<a name="l00936"></a>00936 <span class="preprocessor"></span>  <span class="keywordtype">bool</span> loadVMECnetcdf(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename)  { <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#04d7e86b811bab702d35da7dc1bd9c68" title="helper function for CStconfig::load()">loadfile</a>(filename,<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369cda9482b19985a520597549e20200efee" title="VMEC netCDF wout-format; use without transformation to Boozer coordinates.">VMECNETCDF</a>);}
<a name="l00937"></a>00937 <span class="preprocessor">#endif</span>
<a name="l00942"></a><a class="code" href="classMConf_1_1CStconfig.html#f5c9ecf9fa68f7ca2ae365874dd6cea6">00942</a> <span class="preprocessor">  bool loadVMECFP(const char * filename)  { return loadfile(filename,W7X_FMT_VMEC_FP);}</span>
<a name="l00943"></a>00943 <span class="preprocessor"></span><span class="keyword">private</span>:
<a name="l00946"></a>00946   <span class="keywordtype">bool</span> loadNEMEC(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename)  { <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#04d7e86b811bab702d35da7dc1bd9c68" title="helper function for CStconfig::load()">loadfile</a>(filename,<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c284d51995843bfcd359bcc9ade87c439">NEMEC</a>);}
<a name="l00947"></a>00947 <span class="keyword">public</span>:
<a name="l00952"></a>00952   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#ca7086f9ff8a7674f9e7ee4a13817d8d" title="The method loads Boozer coordinates from Magnetic Configuration Data Base.">loadFromDB</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *mcdb, <span class="keywordtype">int</span> equilibrium_id);
<a name="l00957"></a>00957   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#5672910a5cec19aec3e2c62d93ce058d" title="The method deletes magnetic configuration from database.">deleteFromDB</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *mcdb, <span class="keywordtype">int</span> equilibrium_id) <span class="keyword">const</span>;
<a name="l00966"></a>00966   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#a09a00d98c4f0619a036906b97419376" title="The method inserts magnetic configuration Data into database.">writeIntoDB</a>(<span class="keyword">const</span> <span class="keywordtype">void</span> *mcdb, <span class="keyword">const</span> <span class="keywordtype">char</span>* confname,<span class="keyword">const</span> <span class="keywordtype">char</span>* machine_name,<span class="keywordtype">int</span> Nsmax,<span class="keywordtype">bool</span> magAxis) <span class="keyword">const</span>;
<a name="l00977"></a>00977   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#d422aa8c290ef1797be09817ecc6686d" title="Store current magnetic configuration into file.">write</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>) <span class="keyword">const</span>;
<a name="l00993"></a>00993   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#5ff612ea1be83bd73c096ccf7d2a3172" title="The methods transform the current magnetic configuration to new volume or to new...">writeasciiReduced</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>,<span class="keywordtype">int</span> nsmax=0,<span class="keywordtype">double</span> newVolume=0,<span class="keywordtype">double</span> newLastSurface=1,
<a name="l00994"></a>00994                           <span class="keywordtype">bool</span> varNumberMods=<span class="keyword">true</span>,<span class="keywordtype">bool</span> magAxis=<span class="keyword">false</span>,<span class="keywordtype">bool</span> circular=<span class="keyword">false</span>,<span class="keywordtype">bool</span> append=<span class="keyword">false</span>) <span class="keyword">const</span>;
<a name="l00998"></a>00998   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#642cb27db148786bed96e9acc688b32c" title="Write |B|-spectrum on the surface s into file fname.">writeasciiBmod</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>,<span class="keywordtype">double</span> s) <span class="keyword">const</span>;
<a name="l01000"></a><a class="code" href="classMConf_1_1CStconfig.html#78990418d548a9f25399f370f2d2d482">01000</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#78990418d548a9f25399f370f2d2d482" title="The method returns true if file is loaded without error.">isOK</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#36af5bac69565649de012257e9a1f251" title="result of the last operation">mOK</a>;}
<a name="l01001"></a><a class="code" href="classMConf_1_1CStconfig.html#ac1b70a2ed67ead038c4d3f5ac4d8a81">01001</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#ac1b70a2ed67ead038c4d3f5ac4d8a81">isValid</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#36af5bac69565649de012257e9a1f251" title="result of the last operation">mOK</a>;}
<a name="l01003"></a><a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138">01003</a>   <span class="keyword">const</span> <span class="keywordtype">char</span>  *<a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#10386205c6a9b6c218b301656711b2c3" title="name of the file, that was read">mfname</a>.c_str(); }
<a name="l01005"></a>01005 
<a name="l01006"></a>01006 
<a name="l01007"></a>01007 
<a name="l01008"></a>01008 
<a name="l01009"></a>01009 
<a name="l01010"></a>01010   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#aa88d6eac9f8c2a3731d57e232eada53" title="Set the value of magnetic field on magnetic axis at given cylindrical angle.">setB0</a>(<span class="keywordtype">double</span> B0,<span class="keywordtype">double</span> ficyl);
<a name="l01013"></a>01013   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#aa88d6eac9f8c2a3731d57e232eada53" title="Set the value of magnetic field on magnetic axis at given cylindrical angle.">setB0</a>(<span class="keywordtype">double</span> B0);
<a name="l01016"></a>01016   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#7bd05b577d1a08f199916d7fddb1bec0" title="Set the B00 value of magnetic field on magnetic axis.">setB00</a>(<span class="keywordtype">double</span> B00);
<a name="l01019"></a>01019   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#a262287c61a35463a336f1cc418d4fbe" title="Set normalization factor for value of the magnetic field.">scaleB</a>(<span class="keywordtype">double</span> multiplier);
<a name="l01022"></a>01022   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#5576892ac3c9b050c67d37450cc0da2a" title="Set the Ipol value of the coil currents at LCMS.">setIcoil</a>(<span class="keywordtype">double</span> I);
<a name="l01024"></a>01024   <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#0d24cdb7d9afc0c670e31173a01bd238">getBscaleFactor</a>();
<a name="l01028"></a>01028   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#070128134b6b6bcbf91ad71e40c26ed7" title="Get the minimum value of the magnetic field on axis Get the Ipol value of the coil...">getIcoil</a>();
<a name="l01029"></a>01029 
<a name="l01030"></a>01030 <span class="preprocessor">#if 0</span>
<a name="l01033"></a>01033 <span class="preprocessor">  virtual void setAverageBphi0(double Bfi0);</span>
<a name="l01035"></a>01035 <span class="preprocessor">  double getAverageBphi0();</span>
<a name="l01036"></a>01036 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l01037"></a>01037 <span class="preprocessor"></span>
<a name="l01039"></a>01039   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#8c7fb59fa5a46f796228b09fe762e39e" title="Restore initial value of the magnetic field(which is stored in a bc-file).">restoreB0</a>(); <span class="comment">// restore initial value of the magnetic field on axis</span>
<a name="l01042"></a>01042 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#67ec1e3a74b9f7dc4d14c646719b57bb" title="Get the B00 value of the magnetic field on axis.">getB00</a>();
<a name="l01045"></a>01045   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#5e62aed04d801aaadc2a1ffb9c643453" title="Get the minimum value of the magnetic field on axis.">getB0</a>();
<a name="l01048"></a>01048   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#445f9625ace7566011d68dd6df515a57" title="Get the maximum value of the magnetic field on axis.">getB0max</a>();
<a name="l01052"></a>01052   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#5e62aed04d801aaadc2a1ffb9c643453" title="Get the minimum value of the magnetic field on axis.">getB0</a>(<span class="keywordtype">double</span> ficyl);
<a name="l01055"></a>01055   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#4ddc37ad6222fbf7757d4b2a2ac9cc4c" title="The method returns the direction of B with respect to cylindrical angle of the right...">getBdirection</a>();
<a name="l01059"></a>01059   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#a808b8a1f1d9c772d365a5d41a4bd18f" title="The method sets the direction of B with respect to cylindrical angle of the right...">setBdirection</a>(<span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#74361f7f3765536dd1f9ce37e8ddbcf0">sign</a>);
<a name="l01063"></a>01063   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#e20cdf77d0f54286bc53881390f2163c" title="The method sets the original direction of B with respect to cylindrical angle of...">restoreBdirection</a>();
<a name="l01070"></a>01070   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#7bc196572eca04bc530156a2a5de713b" title="The method returns the current value of truncation level.">truncate</a>(<span class="keywordtype">double</span> level);
<a name="l01072"></a><a class="code" href="classMConf_1_1CStconfig.html#7bc196572eca04bc530156a2a5de713b">01072</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#7bc196572eca04bc530156a2a5de713b" title="The method returns the current value of truncation level.">truncate</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mmodBtol;}
<a name="l01077"></a>01077   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#acb92e13f3a3f8344e030ba3c1356ea0" title="Set accuracy of coordinate transformation.">setAccuracy</a>(<span class="keywordtype">double</span> epsA, <span class="keywordtype">double</span> epsR=1e-5);
<a name="l01079"></a>01079 
<a name="l01080"></a>01080 
<a name="l01081"></a>01081 
<a name="l01082"></a><a class="code" href="classMConf_1_1CStconfig.html#dd9f5a3ba66152f74dbfb756ccb3585d">01082</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#dd9f5a3ba66152f74dbfb756ccb3585d" title="The method returns the tokamak magnetic axis position in [m].">Z0</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mZ0;}
<a name="l01084"></a><a class="code" href="classMConf_1_1CStconfig.html#5071bac3b69aa33e84e7b741f8c4083a">01084</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#5071bac3b69aa33e84e7b741f8c4083a" title="The method returns the major radius in [m].">R0</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mR0;}
<a name="l01086"></a><a class="code" href="classMConf_1_1CStconfig.html#49120084276789004f069da030997833">01086</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#49120084276789004f069da030997833" title="The method returns the minor radius [m].">rminor</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>(1.);}
<a name="l01088"></a><a class="code" href="classMConf_1_1CStconfig.html#3b9df0cf9b6c8333d2e7b21a0505949b">01088</a>   <span class="keywordtype">int</span>    <a class="code" href="classMConf_1_1CStconfig.html#3b9df0cf9b6c8333d2e7b21a0505949b" title="The method returns the number of poloidal harmonics.">Mpol</a>()<span class="keyword"> const  </span>{<span class="keywordflow">return</span> mM;}
<a name="l01090"></a><a class="code" href="classMConf_1_1CStconfig.html#f4ad5065890c58b13d1ff22248996ef6">01090</a>   <span class="keywordtype">int</span>    <a class="code" href="classMConf_1_1CStconfig.html#f4ad5065890c58b13d1ff22248996ef6" title="The method returns the number of toroidal harmonics.">Ntor</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mN;}
<a name="l01093"></a><a class="code" href="classMConf_1_1CStconfig.html#f809fef450ad25780617280c12c9c389">01093</a>   <span class="keywordtype">int</span>    <a class="code" href="classMConf_1_1CStconfig.html#f809fef450ad25780617280c12c9c389" title="The method returns the number of poloidal harmonics after the truncation level was...">MpolMinTruncated</a>()<span class="keyword"> const  </span>{<span class="keywordflow">return</span> MminCurrent;}
<a name="l01096"></a><a class="code" href="classMConf_1_1CStconfig.html#250ce69e23cf4eb2bcdfe23f8387e9ca">01096</a>   <span class="keywordtype">int</span>    <a class="code" href="classMConf_1_1CStconfig.html#250ce69e23cf4eb2bcdfe23f8387e9ca" title="The method returns the number of poloidal harmonics after the truncation level was...">MpolMaxTruncated</a>()<span class="keyword"> const  </span>{<span class="keywordflow">return</span> MmaxCurrent;}
<a name="l01099"></a><a class="code" href="classMConf_1_1CStconfig.html#6cea2d5c2ca3e87494397d4aeda0f09f">01099</a>   <span class="keywordtype">int</span>    <a class="code" href="classMConf_1_1CStconfig.html#6cea2d5c2ca3e87494397d4aeda0f09f" title="The method returns the number of toroidal harmonics after the truncation level was...">NtorMinTruncated</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> NminCurrent;}
<a name="l01102"></a><a class="code" href="classMConf_1_1CStconfig.html#a2670a3846e269e8846443db43af5f4c">01102</a>   <span class="keywordtype">int</span>    <a class="code" href="classMConf_1_1CStconfig.html#a2670a3846e269e8846443db43af5f4c" title="The method returns the number of toroidal harmonics after the truncation level was...">NtorMaxTruncated</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> NmaxCurrent;}
<a name="l01104"></a><a class="code" href="classMConf_1_1CStconfig.html#3e72809526645c891739ca6c93e3c0de">01104</a>   <span class="keywordtype">int</span>    <a class="code" href="classMConf_1_1CStconfig.html#3e72809526645c891739ca6c93e3c0de" title="The method returns the number of periods.">nPeriods</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#7b9b2660e348371e43e02f7657d8f3cd" title="number of periods">mNp</a>;}
<a name="l01108"></a><a class="code" href="classMConf_1_1CStconfig.html#ca970075b81c9d6b4301827f6d8210b5">01108</a>   <span class="keywordtype">int</span>    <a class="code" href="classMConf_1_1CStconfig.html#ca970075b81c9d6b4301827f6d8210b5" title="The method returns the number of flux surfaces used.">nSurfaces</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mNs;}
<a name="l01110"></a><a class="code" href="classMConf_1_1CStconfig.html#843e0a904688a7d4bd4e7f7b43e35776">01110</a>   <span class="keywordtype">int</span>    <a class="code" href="classMConf_1_1CStconfig.html#843e0a904688a7d4bd4e7f7b43e35776" title="The method returns the number of flux surfaces stored in the magnetic configuration...">nSurfacesInitial</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mNs0;}
<a name="l01112"></a><a class="code" href="classMConf_1_1CStconfig.html#88a84de16465f0f266901ec2430dee4a">01112</a>   <span class="keywordtype">bool</span>   <a class="code" href="classMConf_1_1CStconfig.html#88a84de16465f0f266901ec2430dee4a" title="The method returns true if the opened file has tokamak symmetry.">isTokamak</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#312cbfcbbde8f37e3b1cc8c6f8135f6d" title="mN==0 &amp;amp;&amp;amp; mNp==1">tokamakConfig</a>;}
<a name="l01114"></a><a class="code" href="classMConf_1_1CStconfig.html#f22847bb5635242c7584e1f1975f72b7">01114</a>   <span class="keywordtype">bool</span>   <a class="code" href="classMConf_1_1CStconfig.html#f22847bb5635242c7584e1f1975f72b7" title="The method returns true if the opened file is a Tokamak Symmetry Flux Coordinates...">isTokamakSymmetryFluxCoordinates</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#a554cddde93c05efd79f6da00ff7c1a7">tokamakSymmetryFluxCoordinates</a>;}
<a name="l01116"></a><a class="code" href="classMConf_1_1CStconfig.html#c9dc17a1ab8e113d6d2e8aa660c5f865">01116</a>   <span class="keywordtype">bool</span>   <a class="code" href="classMConf_1_1CStconfig.html#c9dc17a1ab8e113d6d2e8aa660c5f865" title="The method returns true if the opened file is a VMEC file.">isVmecCoordinates</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#86e74dd3850d30428a0bcd171d96f938" title="VMEC Coordinates if true.">vmecCoordinates</a>;}
<a name="l01119"></a><a class="code" href="classMConf_1_1CStconfig.html#b6bfd5c96905b80c477ff8fb87681e71">01119</a>   <span class="keywordtype">bool</span>   <a class="code" href="classMConf_1_1CStconfig.html#b6bfd5c96905b80c477ff8fb87681e71" title="The method returns true if the opened file is a VMEC file from the Function Parametrization...">isVmecCoordinatesFromFP</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#229ce464e82f6f85759159e4e94d7664" title="VMEC Coordinates from FP if true.">fpCoordinates</a>;}
<a name="l01121"></a><a class="code" href="classMConf_1_1CStconfig.html#98ddf6cfad16b912408ec8f222d9bbd1">01121</a>   <span class="keywordtype">int</span>    <a class="code" href="classMConf_1_1CStconfig.html#98ddf6cfad16b912408ec8f222d9bbd1" title="The method returns VMEC completion code.">vmecReturnCode</a>()<span class="keyword">    const </span>{<span class="keywordflow">return</span> vmecErrorCode;}
<a name="l01123"></a>01123 
<a name="l01124"></a>01124 
<a name="l01125"></a>01125 
<a name="l01126"></a>01126 
<a name="l01127"></a>01127 
<a name="l01128"></a>01128 
<a name="l01129"></a>01129 
<a name="l01130"></a>01130 
<a name="l01131"></a>01131   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>     (<span class="keywordtype">double</span> s) <span class="keyword">const</span>;  
<a name="l01136"></a>01136   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#53e4496e14d5e2c038381684704275a4" title="The method returns the effective radius defined as sqrt(Flux(s)/B00(s)/pi).">rdkes</a>(<span class="keywordtype">double</span> s) <span class="keyword">const</span>;
<a name="l01138"></a>01138   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#ae696b296fcfb6f16303fd72066295af">rdkes2</a>(<span class="keywordtype">double</span> s);
<a name="l01141"></a>01141   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#cda2428025d97d2a9a81772e4b047205" title="The method returns the minor radius dr=ds/&amp;lt;|grad(s)|&amp;gt; (Graz definition of the...">rgraz</a>(<span class="keywordtype">double</span> s);
<a name="l01144"></a>01144   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#3afc2006d3668a84ca9b3a8aa3b802bb" title="The method returns dr_graz/dr, where r=a*sqrt(s) is the VMEC definition of minor...">drgraz_dr</a>(<span class="keywordtype">double</span> s); <span class="comment">// dr_graz/dr_vmec </span>
<a name="l01147"></a>01147 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#048fe83a1e433d41900cce0f16f37c79" title="The method returns dr_dkes/dr, where r=a*sqrt(s) is the VMEC definition of minor...">drdkes_dr</a>(<span class="keywordtype">double</span> s); 
<a name="l01148"></a>01148   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#523df1929e913bc9bec1e3b0a0a9af67">drdkes2_dr</a>(<span class="keywordtype">double</span> s); 
<a name="l01160"></a>01160   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#5240b79976ab3ee87ab6349397c5009a" title="The method returns the effective helical ripple for  transport, using Graz definition...">epsEffGraz</a>(<span class="keywordtype">double</span> s); 
<a name="l01169"></a>01169   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#3029d8f560fc48e95187a0d70a843857" title="The method returns the effective helical ripple for  transport, using DKES definition...">epsEffDkes</a>(<span class="keywordtype">double</span> s); 
<a name="l01179"></a>01179   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#037f4dbd0a2a0a1c42c6138a707f324a" title="The method returns the effective helical ripple for  transport, using VMEC definition...">epsEffVmec</a>(<span class="keywordtype">double</span> s); 
<a name="l01186"></a>01186   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#c2dddbdc3a351071eb99e0801593a418" title="The method returns the normalized effective helical ripple for  transport, using...">epsEffNorm</a>(<span class="keywordtype">double</span> s); 
<a name="l01192"></a>01192   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#5f7f8ad0c390d56a37e42110fd612412" title="The method returns the effective helical ripple for  transport, using definition...">epsEffHat</a> (<span class="keywordtype">double</span> s);
<a name="l01193"></a>01193 
<a name="l01196"></a>01196   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#4ada210e21c149c1e63d31436b6d58d3" title="eq(21) in Physics of Plasmas 12,112507(2005), http://link.aip.org/link/doi/10.1063/1...">Gw</a>(<span class="keywordtype">double</span> s);
<a name="l01199"></a>01199   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#be0a4a2a92595ce692a503e82d94b469" title="eq(26) in Physics of Plasmas 12,112507(2005), http://link.aip.org/link/doi/10.1063/1...">Gs</a>(<span class="keywordtype">double</span> s);
<a name="l01203"></a>01203   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#b89f959f8c7cdbadb7d1ba2dab32d15f" title="The methods return the bounce-averade gradB drift velocity of trapped particles averaged...">Gv</a>(<span class="keywordtype">double</span> s);
<a name="l01204"></a>01204 
<a name="l01205"></a>01205 
<a name="l01211"></a>01211  <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#aebd8e7c5098af32b7b8dd20af069b24" title="The method sets parameters for calculating eps_eff and Gw, Gs, Gv.">epsEffSetXeffParam</a>   (<span class="keywordtype">double</span> xmin=.05, <span class="keywordtype">double</span> xmax=.95, <span class="keywordtype">int</span> size=51);   
<a name="l01218"></a>01218   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#bb5fde245a69633cfeb301e3c7bd5fe3" title="The method sets parameters for calculating the eps_eff and Gw, Gs, Gv.">epsEffSetTracingParam</a>(<span class="keywordtype">int</span> turns=100, <span class="keywordtype">bool</span> doAccuracyTest = <span class="keyword">true</span>, <span class="keywordtype">double</span> dphi = 0.017453);  <span class="comment">// twopi/360 == 0.017453</span>
<a name="l01225"></a>01225 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#a83f4da97a41ace9c4a77daacd97ed48" title="The method sets parameters for calculating the eps_eff and Gw, Gs, Gv.">epsEffSetIotaParam</a>   (<span class="keywordtype">bool</span> avoidResonances=<span class="keyword">false</span>, <span class="keywordtype">bool</span> useRationalIota=<span class="keyword">false</span>, <span class="keywordtype">int</span> iotaDenominator=150); 
<a name="l01231"></a>01231   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#d934a65b9f2e8fc188930dde3b014b44" title="The method sets parameters for calculating the eps_eff and Gw, Gs, Gv.">epsEffSetMagnMomentParam</a> (<span class="keywordtype">int</span> nBLevels=513); 
<a name="l01234"></a>01234   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#465a68b1c3656d8a0f0231e7a9d9d20e" title="The method calculates and stores the eps_eff in the look-up table.">epsEffCreate</a>(); 
<a name="l01236"></a>01236   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#08f4899fe602bc0f93eb020dc9443570" title="The method clears the look-up table with the eps_eff and Gw, Gs, Gv.">epsEffInvalidate</a>(); 
<a name="l01237"></a>01237   
<a name="l01238"></a>01238 
<a name="l01243"></a>01243   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#089c7ddd1bfdaa969d3fba1362837084" title="The method sets parameters for calculating the bootstrap current geometric factor...">FbsSetSlabelParam</a>(<span class="keywordtype">double</span> smin=0.0025, <span class="keywordtype">double</span> smax=0.9, <span class="keywordtype">int</span> size=101); 
<a name="l01248"></a>01248   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#7b1789d96ba94ba22b77a03efeb7e0b8" title="The method sets parameters for calculating the bootstrap current geometric factor...">FbsSetXeffParam</a>   (<span class="keywordtype">double</span> xmin=.05, <span class="keywordtype">double</span> xmax=.95, <span class="keywordtype">int</span> size=101);   
<a name="l01254"></a>01254   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#1f364ab3dd9be961e3af890e6da28626" title="The method sets parameters for calculating the bootstrap current geometric factor...">FbsSetTracingParam</a>(<span class="keywordtype">int</span> turns=100, <span class="keywordtype">bool</span> doAccuracyTest=<span class="keyword">true</span>, <span class="keywordtype">double</span> dphi=0.017453);  <span class="comment">// twopi/360 == 0.017453</span>
<a name="l01260"></a>01260 <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#44ad7d9349fbdcf8f040f5ed5cf1ce29" title="The method sets parameters for calculating the bootstrap current geometric factor...">FbsSetIotaParam</a>   (<span class="keywordtype">bool</span> avoidResonances=<span class="keyword">false</span>, <span class="keywordtype">bool</span> useRationalIota=<span class="keyword">false</span>, <span class="keywordtype">int</span> iotaDenominator=150); 
<a name="l01267"></a>01267   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#8dc33a85e8c96d16598731cf9e404423" title="The method sets parameters for calculating the bootstrap current geometric factor...">FbsSetMagnMomentParam</a> (<span class="keywordtype">int</span> lambdaLevels=257, <span class="keywordtype">double</span> yMax=15); 
<a name="l01268"></a>01268 
<a name="l01269"></a>01269 
<a name="l01271"></a>01271   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#8cf5bd3cdb9f87645db7ae327a7c5a9a" title="The method calculates and stores the bootstrap current geometric factor in the look-up...">FbsCreate</a>();
<a name="l01273"></a>01273   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#d92fb0db015bc95043aaa5987d349f2e" title="The method clears the look-up table with the bootstrap current geometric factors...">FbsInvalidate</a>(); 
<a name="l01283"></a>01283   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#c18db696515c9ecd990436fcdf657db3" title="The method returns the bootstrap current geometric factor for  transport, using VMEC...">FbsVmec</a>(<span class="keywordtype">double</span> s); 
<a name="l01289"></a>01289   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#58bae0bccc08683093e9432fed0e3dbc" title="The method returns the bootstrap current geometric factor for  transport, using DKES...">FbsDkes</a>(<span class="keywordtype">double</span> s);
<a name="l01295"></a>01295   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#123b1460e34219652cbfa4257d0e5b04" title="The method returns the bootstrap current geometric factor for  transport, using Graz...">FbsGraz</a>(<span class="keywordtype">double</span> s);  
<a name="l01301"></a>01301   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#ac10a05b74f96b71b432e9b2c66aad01" title="The method returns the bootstrap current geometric factor  for  transport, using...">GrazLambdab</a>(<span class="keywordtype">double</span> s);
<a name="l01302"></a>01302 
<a name="l01303"></a>01303   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#ad840d452d439c64a18b85078eddc4b4">FbsFtrap</a>(<span class="keywordtype">double</span> s); 
<a name="l01304"></a>01304 
<a name="l01305"></a>01305   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#e036bea1524991d57748758fd8ad61ed">Fbsg2Vmec</a>(<span class="keywordtype">double</span> s);
<a name="l01306"></a>01306   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#78beaa42b5e22133ab5ef65751ea91c0">Fbsg2Dkes</a>(<span class="keywordtype">double</span> s);
<a name="l01307"></a>01307   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#ec185d69b09c35cf736108098ce0bdf9">Fbsg2Graz</a>(<span class="keywordtype">double</span> s);
<a name="l01308"></a>01308 
<a name="l01309"></a>01309 
<a name="l01319"></a>01319   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#5001f267b6ae61f43bcf1694ce63bd2c" title="The method returns flux surface average of g2, where g2 is defined as B*grad(g2/B^2)...">Fbsg2</a>(<span class="keywordtype">double</span> s);
<a name="l01324"></a>01324   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#c49db7d45af15a00b65096a7b6f399e3" title="The method returns flux surface average of u, where u is defined as B*grad(u) = -B...">Fbsu</a>(<span class="keywordtype">double</span> s); 
<a name="l01329"></a>01329   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#9caa7d589cc10b38a53ee36ba22cd571" title="The method returns flux surface average of u*B^2, where u is defined as B*grad(u)...">FbsuB2</a>(<span class="keywordtype">double</span> s); 
<a name="l01334"></a>01334   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#98947e6c6363baba9700f97077512ccd" title="The method returns flux surface average of u^2*B^2, where u is defined as B*grad(u)...">Fbsu2B2</a>(<span class="keywordtype">double</span> s); 
<a name="l01337"></a>01337   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#f01d1c333b07b99e9ccbfb0e94531672" title="The method returns flux surface average of B^2.">FbsB2</a>(<span class="keywordtype">double</span> s); 
<a name="l01338"></a>01338 
<a name="l01349"></a>01349   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#eb92495917b3100f4b98e9726a5a7d27" title="The method returns flux surface average of g4, where g4 is defined as B*grad(g4/xi)...">Fbsg4</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">double</span> mu);
<a name="l01350"></a>01350   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#9fa346fee5062a5df6f2c740f7564cb9">Fbsg4Vmec</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">double</span> mu);
<a name="l01351"></a>01351 
<a name="l01366"></a>01366   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#0fa3761e1f825b3c24347a21ec74265b" title="The method returns bounce average of  according formula  for elecrons, where  , ...">omega_d_BounceAveraged</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;mag0, <span class="keywordtype">double</span> dphi=0.00698 , <span class="keywordtype">int</span> iotaDenominator=0);
<a name="l01367"></a>01367   
<a name="l01380"></a>01380   std::vector&lt;double&gt; <a class="code" href="classMConf_1_1CStconfig.html#be3335a3bc7ff4723d8c1a66ba8b1f1f" title="The method returns the parallel adiabatic invariant with the integral taken between...">Jinvariant</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;mag, <span class="keywordtype">double</span> dphi=0.00698 , <span class="keywordtype">int</span> iotaDenominator=0);
<a name="l01381"></a>01381 
<a name="l01391"></a>01391   std::vector&lt;double&gt; <a class="code" href="classMConf_1_1CStconfig.html#5873b7faa899e187eff85156caef68d6" title="The method returns bounce average of  ( see omega_d_BounceAveraged() ) and the parallel...">Jinv_omega_d_BounceAveraged</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;mag0, <span class="keywordtype">double</span> dphi=0.00698 , <span class="keywordtype">int</span> iotaDenominator=0);
<a name="l01392"></a>01392 
<a name="l01402"></a>01402   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#4445f4eeef83217a7a578afe9f8dd202" title="The method returns the magnetic coordinates of the point (that belongs to the given...">getMagCoordAtB</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; mag, <span class="keywordtype">double</span> Bt);
<a name="l01403"></a>01403 
<a name="l01404"></a>01404   std::vector&lt;Vector3d&gt; <a class="code" href="classMConf_1_1CStconfig.html#a884cb94028ad29a76c7bbbfc2af8079">getAllMagCoordAtB</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; mag0, <span class="keywordtype">double</span> Bt); 
<a name="l01405"></a>01405   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#bdb0a668349ff379475872204a63949f">getNextMagCoordAtB</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; mag0, <span class="keywordtype">double</span> Bt);
<a name="l01406"></a>01406 
<a name="l01408"></a>01408   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#cbd9eeb755933dd05eef5c9ddd414631" title="The method returns &amp;lt;|grad(s)|&amp;gt; .">GradsAvrg</a>(<span class="keywordtype">double</span> s); 
<a name="l01410"></a>01410   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#215e6cdf832b5c2d3df5d8e624936cf1" title="The method returns &amp;lt;(grad(s))^2&amp;gt; .">Grads2Avrg</a>(<span class="keywordtype">double</span> s); 
<a name="l01412"></a>01412   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#4205ba290a039ab8980dd25ec32b8858" title="The method returns &amp;lt;(grad(s)/B)^2&amp;gt; .">Grads2overB2Avrg</a>(<span class="keywordtype">double</span> s); 
<a name="l01414"></a>01414   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#bd825d2040f3ff303ef8fde2bf0d4de5" title="The method returns the normalized poloidal flux, where s is the normalized toroidal...">sPol</a>  (<span class="keywordtype">double</span> s);
<a name="l01416"></a>01416   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#2f3ce906858af6611327895c204a8c32" title="The method returns the poloidal flux, where s is the normalized toroidal flux.">PoloidalFlux</a>(<span class="keywordtype">double</span> s);
<a name="l01418"></a>01418   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#7048a807d4ad1d3a7d0d7a2cc33d3f8c" title="The method returns the normalized toroidal flux, where s is the normalized poloidal...">sToroidal</a>(<span class="keywordtype">double</span> sPoloidal);
<a name="l01420"></a>01420   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#edef0b58e6ab7917ae149d1ca29ec0fd" title="The method returns the iota, where s is the normalized toroidal flux.">iota</a>  (<span class="keywordtype">double</span> s) <span class="keyword">const</span>;
<a name="l01422"></a>01422   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#75e38a6dc5c899ce62608d1966b95d12" title="The method returns the pressure in Pa, where s is the normalized toroidal flux.">pressure</a>  (<span class="keywordtype">double</span> s) <span class="keyword">const</span>;
<a name="l01429"></a>01429   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#e409f871ed0efc6c70b33a918f965e0c" title="The method returns rational aproximation to iota: iota = numerator/denominator.">iotaRational</a>(<span class="keywordtype">double</span> s,<span class="keywordtype">int</span> denom_guess,<span class="keywordtype">int</span> &amp;numerator,<span class="keywordtype">int</span> &amp;denominator);
<a name="l01432"></a>01432   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#d7fd641c6725330cf539741f3be57899" title="The method returns the diota/ds, where s is the normalized toroidal flux.">iotaPrime</a>(<span class="keywordtype">double</span> s) <span class="keyword">const</span>;
<a name="l01435"></a>01435   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#c3852ad9657fd13676d77b41bbc7bf62" title="The method returns the poloidal current in [A].">Ip</a>    (<span class="keywordtype">double</span> s) <span class="keyword">const</span>;   <span class="comment">// poloidal current [A]</span>
<a name="l01438"></a>01438 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#b39a1261117683b2bd498ebf3f00685c" title="The method returns the toroidal current in [A].">It</a>    (<span class="keywordtype">double</span> s) <span class="keyword">const</span>;   <span class="comment">// toroidal current [A]</span>
<a name="l01441"></a>01441 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#4a8d9384e6ee9e4fc9da90526f973421" title="The method returns the toroidal flux in [Wb].">Flux</a>  (<span class="keywordtype">double</span> s) <span class="keyword">const</span>;   <span class="comment">// toroidal flux [Tm^2]</span>
<a name="l01444"></a>01444 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#114c3125aa5650be725d8914234f73cd" title="The method returns dp/ds [Pa], where p is the pressure in [Pa].">pp</a>    (<span class="keywordtype">double</span> s);   <span class="comment">// dp/ds,[Pa]  pressure gradient</span>
<a name="l01449"></a>01449 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#4e14be0491cdd6b7e65cfd8a4fcdc85a" title="The method returns the area of the cross section of the surface s at angle fi.">crossSectionArea</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">double</span> ficyl);
<a name="l01453"></a>01453   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#4ebccc046795bb45dadcd47b59cb72d4" title="The method returns the average area of the cross section of the surface s.">averageCrossSectionArea</a>(<span class="keywordtype">double</span> s=1.);
<a name="l01458"></a>01458   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#341967fb5c3f492c487765aebd72264b" title="The method returns Volume in [m3] inside surface s.">Volume</a>(<span class="keywordtype">double</span> s);   
<a name="l01462"></a>01462   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#009ba2510ec5b936135f8b576168b375" title="The method returns Vprime=dVolume/ds in [m3].">Vprime</a>(<span class="keywordtype">double</span> s) <span class="keyword">const</span>; 
<a name="l01472"></a>01472  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#5edb6aabe8162913caa5b5293186972c" title="The method calculates dVolume/ds in [m^3], integrating the Jacobian.">VprimeIntJ</a>(<span class="keywordtype">double</span> s,<span class="keywordtype">int</span> nth=120,<span class="keywordtype">int</span> nph=120);<span class="comment">// dVolume/ds [m^3], as integral from Jacobian</span>
<a name="l01492"></a>01492 <span class="comment"></span>  <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> * <a class="code" href="classMConf_1_1CStconfig.html#a4ca49ba3aeeb7abce834ddcf2001444" title="The method calculates the Susceptance matrix in (Flux,theta,phi)-coordinates.">SMatrix</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> npol=180, <span class="keywordtype">int</span> ntor=200);
<a name="l01498"></a>01498   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#cab84ea12208d8d4f61d9ec6d8ec99fc" title="Susceptance matrix: S11 in (Flux,theta,phi)-coordinates.">S11</a>(<span class="keywordtype">double</span> s); <span class="comment">// S11(s)</span>
<a name="l01502"></a>01502 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#fce64877da83002f3804bc30ccd30feb" title="Susceptance matrix: S12 in (Flux,theta,phi)-coordinates.">S12</a>(<span class="keywordtype">double</span> s); <span class="comment">// S12(s)</span>
<a name="l01504"></a>01504 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#0db28f90ea9bcd19a6521d5cc1fb34af" title="Susceptance matrix: S21 in (Flux,theta,phi)-coordinates.">S21</a>(<span class="keywordtype">double</span> s); <span class="comment">// S21(s)</span>
<a name="l01506"></a>01506 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#d1c393bcd1fe2d8563e65b069accb97e" title="Susceptance matrix: S22 in (Flux,theta,phi)-coordinates.">S22</a>(<span class="keywordtype">double</span> s); <span class="comment">// S22(s)</span>
<a name="l01522"></a>01522 <span class="comment"></span>  <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#7596bc81d8235673412988f3112f53d4" title="The method calculates the flux average of normal and geodesic curvatures.">curvatureAvrg</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> nth=120, <span class="keywordtype">int</span> nph=120);
<a name="l01524"></a>01524 
<a name="l01525"></a>01525 
<a name="l01526"></a>01526 
<a name="l01527"></a>01527   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#5674af3761be023b6bb190ffbbd69712" title="The method returns the position of Bmax on the surface s.">findBminBmaxPosition</a>(<span class="keywordtype">double</span> s, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magcrdBmin, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magcrdBmax, <span class="keywordtype">bool</span> useInputAsGuess=<span class="keyword">false</span>);
<a name="l01529"></a>01529   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#34b1dc8832f889b8ed9a240b1d02539e" title="The method returns the minimum value of magnetic field.">Bmin</a>  (<span class="keywordtype">double</span> s);
<a name="l01531"></a>01531   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#19b04e3914feba7e055c33c996d7662e" title="The method returns the maximum value of magnetic field.">Bmax</a>  (<span class="keywordtype">double</span> s);
<a name="l01533"></a>01533   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#34b1dc8832f889b8ed9a240b1d02539e" title="The method returns the minimum value of magnetic field.">Bmin</a>  ();
<a name="l01535"></a>01535   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#19b04e3914feba7e055c33c996d7662e" title="The method returns the maximum value of magnetic field.">Bmax</a>  ();
<a name="l01538"></a>01538   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#7c6e5e52253e0c811102381ee989846b" title="The method returns the &amp;lt;B&amp;gt; -- flux average of magnetic field on the surface...">Bavrg</a> (<span class="keywordtype">double</span> s);
<a name="l01541"></a>01541   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#0e08824d30fbff86113470e3996d2b24" title="The method returns the &amp;lt;B2&amp;gt; -- flux average of magnetic field on the surface...">B2avrg</a> (<span class="keywordtype">double</span> s);
<a name="l01543"></a>01543   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#e3c79caac1a942738db0c812446fd7a5" title="The method returns the volume average of B2.">B2VolAvrg</a>();
<a name="l01546"></a>01546   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#957faffa3b62d532892a252b093781a4" title="The method returns the &amp;lt;B-2&amp;gt; -- flux average of magnetic field on the surface...">B_2avrg</a>(<span class="keywordtype">double</span> s); 
<a name="l01549"></a>01549   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#9d85273d6d2b17b7c4a930d10a167fe4" title="The method returns the &amp;lt;grads^2*B^-2&amp;gt; -- flux average on the surface s.">grads2B_2avrg</a>(<span class="keywordtype">double</span> s); 
<a name="l01552"></a>01552   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#38350a132e86a9f30506ea76e766dca4" title="The method returns the &amp;lt;R2&amp;gt; -- flux average of R^2 on the surface s.">R2avrg</a>(<span class="keywordtype">double</span> s); 
<a name="l01555"></a>01555   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#780f04d78955c15cd1eb6232fed12e47" title="The method returns the &amp;lt;R-2&amp;gt; -- flux average of R^-2 on the surface s.">R_2avrg</a>(<span class="keywordtype">double</span> s);
<a name="l01558"></a>01558   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#2e2ed65285ce59dd9d903f2ea84b3944" title="The method returns the contribution of passed particles to the neoclassical polarization...">NeoPolarizationPass</a>(<span class="keywordtype">double</span> s);
<a name="l01561"></a>01561   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#d0ee24ee36e9d2b683a05d583f465e48" title="The method returns the contribution of traped particles to the neoclassical polarization...">NeoPolarizationTrap</a>(<span class="keywordtype">double</span> s);
<a name="l01564"></a>01564   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#a9aa14fc2a2135ddf09d5670d0886c0b" title="The method returns the neoclassical polarization on the surface s.">NeoPolarization</a>(<span class="keywordtype">double</span> s);
<a name="l01567"></a>01567   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#d8948fda5f665746931f824cbd552500" title="The method returns the value of &amp;lt;(1-b)0.5&amp;gt;, where b=B(s,th,ph)/Bmax(s).">db12Avrg</a>(<span class="keywordtype">double</span> s);  <span class="comment">// &lt;(1-b)^0.5&gt;; b = B(s,th,phi)/Bmax(s)</span>
<a name="l01570"></a>01570 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#428ab2b4ae5a1fdb863038a5a6864141" title="The method returns the value of &amp;lt;(1-b)1.5&amp;gt;, where b=B(s,th,ph)/Bmax(s).">db32Avrg</a>(<span class="keywordtype">double</span> s);  <span class="comment">// &lt;(1-b)^1.5&gt;</span>
<a name="l01573"></a>01573 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#8e34f48e6b37186bdf4d80cac91bd9ae" title="The method returns the fraction of trapped particles on the surface s.">ftrapped</a>(<span class="keywordtype">double</span> s);
<a name="l01574"></a>01574 <span class="comment">// &lt;ro_paralell^-1&gt;</span>
<a name="l01575"></a>01575 <span class="comment">// f(s,x) = &lt;b/sqrt(1-x*b)&gt;, where 0&lt;=x&lt;=1, 0&lt;=s&lt;=1, and b=B(s,th,ph)/Bmax(s)</span>
<a name="l01576"></a>01576   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#d2919476e0a7298d21ba11bae7d3a1a7">roParInvAvrg</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">double</span> x) <span class="keyword">const</span>;
<a name="l01580"></a>01580   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#0fcd4e26a025b31c16c780b3f8c3ed0e" title="The method returns the &amp;lt;p&amp;gt; -- flux average of pitch angle on the surface s...">pavrg</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">double</span> x) <span class="keyword">const</span>;
<a name="l01583"></a>01583   <span class="comment">//  0&lt;=x&lt;=1, 0&lt;=s&lt;=1  and definition of x is the following x=(1-p^2)/b, p is the pitch angle, b=B(s,th,ph)/Bmax(s).</span>
<a name="l01584"></a>01584   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#166c496408d708413fcdb5b0a215da1d" title="The method returns the Integral(from x to 1) dx&amp;#39;/P(s,x&amp;#39;) on the surface s...">integralInvPavrg</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">double</span> x) <span class="keyword">const</span>;
<a name="l01596"></a>01596   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#dea52be394ab8b089b5fd80d89a8494f" title="The method returns Bmin and Bmax -- the minimum and maximum values of magnetic field...">getBminmax</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">double</span> &amp;<a class="code" href="classMConf_1_1CStconfig.html#34b1dc8832f889b8ed9a240b1d02539e" title="The method returns the minimum value of magnetic field.">Bmin</a>,<span class="keywordtype">double</span> &amp;<a class="code" href="classMConf_1_1CStconfig.html#19b04e3914feba7e055c33c996d7662e" title="The method returns the maximum value of magnetic field.">Bmax</a>,<span class="keywordtype">int</span> npol=120,<span class="keywordtype">int</span> ntor=120);
<a name="l01614"></a>01614   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#a995cb9aba1c79f2cea662d8b416747c" title="The method returns the fraction of trapped particles on the surface s.">getFtrappedBminmax</a>(<span class="keywordtype">double</span> s,<span class="keywordtype">double</span> &amp;Ftrapped, <span class="keywordtype">double</span> &amp;<a class="code" href="classMConf_1_1CStconfig.html#34b1dc8832f889b8ed9a240b1d02539e" title="The method returns the minimum value of magnetic field.">Bmin</a>,<span class="keywordtype">double</span> &amp;<a class="code" href="classMConf_1_1CStconfig.html#19b04e3914feba7e055c33c996d7662e" title="The method returns the maximum value of magnetic field.">Bmax</a>,
<a name="l01615"></a>01615                           <span class="keywordtype">double</span> &amp;Bavr,<span class="keywordtype">double</span> &amp;B2avr,<span class="keywordtype">int</span> nth=120,<span class="keywordtype">int</span> nph=120);
<a name="l01617"></a>01617 
<a name="l01618"></a>01618 
<a name="l01619"></a>01619   <span class="comment">// Splined Fourier coefficients</span>
<a name="l01627"></a>01627 <span class="comment"></span>  <span class="keywordtype">double</span>  <a class="code" href="classMConf_1_1CStconfig.html#0b38926b33c2711af8433cc9bb101f2d" title="The method returns Fourier coefficient of |B|-expansion.">Bmn_sp</a>  (<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n) <span class="keyword">const</span>;
<a name="l01629"></a>01629   <span class="keywordtype">double</span>  <a class="code" href="classMConf_1_1CStconfig.html#20f857c945d3e676b0cf59fb116bd795" title="The method returns Fourier coefficient of R-expansion, for parameters see Bmn_sp()...">Rmn_sp</a>  (<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n) <span class="keyword">const</span>;
<a name="l01631"></a>01631   <span class="keywordtype">double</span>  <a class="code" href="classMConf_1_1CStconfig.html#bd9e3ac08387117bf45d3cbaabf15632" title="The method returns Fourier coefficient of Z-expansion, for parameters see Bmn_sp()...">Zmn_sp</a>  (<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n) <span class="keyword">const</span>;
<a name="l01633"></a>01633   <span class="keywordtype">double</span>  <a class="code" href="classMConf_1_1CStconfig.html#59fff645e5550eaa287701dd904a4943" title="The method returns Fourier coefficient of Phi-expansion, for parameters see Bmn_sp()...">Phimn_sp</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n) <span class="keyword">const</span>;
<a name="l01635"></a>01635   <span class="keywordtype">double</span>  <a class="code" href="classMConf_1_1CStconfig.html#d6053633dd29187e45514140c9226ed6" title="The method returns Fourier coefficient of VMEC lambda expansion, for parameters see...">lmn_sp</a>  (<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n) <span class="keyword">const</span>;
<a name="l01637"></a>01637   <span class="keywordtype">double</span>  <a class="code" href="classMConf_1_1CStconfig.html#6320750ccd4171c976eaff72283e04de" title="The method returns Fourier coefficient of VMEC Jacobian expansion, for parameters...">gmn_sp</a>  (<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n) <span class="keyword">const</span>;
<a name="l01639"></a>01639   <span class="keywordtype">double</span>  <a class="code" href="classMConf_1_1CStconfig.html#3a625de236bf7dd15006fdc593a30556" title="The method returns Fourier coefficient of expansion of poloidal contravariant B,...">BcontrPolmn_sp</a>  (<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n) <span class="keyword">const</span>;
<a name="l01641"></a>01641   <span class="keywordtype">double</span>  <a class="code" href="classMConf_1_1CStconfig.html#8bd35fe100d318daaab267237e329e45" title="The method returns Fourier coefficient of expansion of toroidal contravariant B,...">BcontrTormn_sp</a>  (<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n) <span class="keyword">const</span>;
<a name="l01642"></a>01642 
<a name="l01643"></a>01643   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#09c66a50a5bcaae23f85fb7ca0fae9fc">Bmn_sp_prime</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n) <span class="keyword">const</span>;
<a name="l01644"></a>01644 
<a name="l01645"></a>01645   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#087bc68d9484dce56a0712cfcaf3ef39">Boozer2Bmn</a>(<span class="keywordtype">double</span> s,<span class="keywordtype">int</span> m,<span class="keywordtype">int</span> n);
<a name="l01646"></a>01646   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#931d5f85bfe12de7b08a885eca853b67">BoozerBmn</a>(<span class="keywordtype">double</span> s,<span class="keywordtype">int</span> m,<span class="keywordtype">int</span> n);
<a name="l01647"></a>01647 
<a name="l01649"></a>01649 
<a name="l01650"></a>01650 
<a name="l01651"></a>01651 
<a name="l01652"></a>01652 
<a name="l01653"></a><a class="code" href="classMConf_1_1CStconfig.html#e1ded5206b0fdf9efc18ce09967ac1cb">01653</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#e1ded5206b0fdf9efc18ce09967ac1cb" title="The method returns flux surface label s(norm.tor.flux).">get_s</a>(<span class="keywordtype">int</span> is)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> ms[is];}
<a name="l01655"></a><a class="code" href="classMConf_1_1CStconfig.html#0ff93b03e1e9e9de0cf8acfe960e0cf4">01655</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#0ff93b03e1e9e9de0cf8acfe960e0cf4" title="The method returns the s value of the first surface stored in a file.">get1st_s</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> s1st;}   <span class="comment">// get the first s, which is stored in a bc-file.</span>
<a name="l01657"></a><a class="code" href="classMConf_1_1CStconfig.html#bc823e28decce22d485f4666c47034e3">01657</a> <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#bc823e28decce22d485f4666c47034e3" title="The method returns the s value of the last surface stored in a file.">getLast_s</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> sLast;}  <span class="comment">// get the last  s, which is stored in a bc-file</span>
<a name="l01660"></a><a class="code" href="classMConf_1_1CStconfig.html#2bcac606976c905fa3e18c150619f91b">01660</a> <span class="comment"></span>  <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#2bcac606976c905fa3e18c150619f91b" title="The method returns the index of the first flux surface in array CStconfig::ms.">getIdx1st_s</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> m1stSindex;}  <span class="comment">// ms[]-index of the first surface from bc-file</span>
<a name="l01663"></a><a class="code" href="classMConf_1_1CStconfig.html#15fadfbbc06b4d1bf7788ae2b817aef2">01663</a> <span class="comment"></span>  <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#15fadfbbc06b4d1bf7788ae2b817aef2" title="The method returns the index of the last flux surface in array CStconfig::ms.">getIdxLst_s</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mLCMSindex;}  <span class="comment">// ms[]-index of the LCMS from bc-file</span>
<a name="l01666"></a>01666 <span class="comment"></span>  <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#aac98f9e7462857caafcce10a5e3c9d6" title="The method returns the index in array CStconfig::ms, which corresponds to s.">SearchSindx</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">bool</span> halfMesh=<span class="keyword">true</span>) <span class="keyword">const</span>;
<a name="l01668"></a>01668 
<a name="l01669"></a>01669 
<a name="l01670"></a>01670 
<a name="l01671"></a>01671 
<a name="l01672"></a>01672   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord) <span class="keyword">const</span>; <span class="comment">// |B|</span>
<a name="l01679"></a>01679 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#2261450d0718c7ca2b731a05fe67e99d" title="The method returns |B| on the field line that passes through the point given by (s0...">BonFieldLine</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord0, <span class="keywordtype">double</span> phi); 
<a name="l01689"></a>01689   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#d996bc4266de8a45c4809d65181da743" title="The method returns magnetic coordinates of the point of a field line, that passes...">magCoordFieldLine</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord0, <span class="keywordtype">double</span> phi, <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#edef0b58e6ab7917ae149d1ca29ec0fd" title="The method returns the iota, where s is the normalized toroidal flux.">iota</a>=0);
<a name="l01690"></a>01690 <span class="keyword">private</span>:
<a name="l01692"></a>01692   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> magCoordFieldLine2(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord0, <span class="keywordtype">double</span> theta, <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#edef0b58e6ab7917ae149d1ca29ec0fd" title="The method returns the iota, where s is the normalized toroidal flux.">iota</a>=0);
<a name="l01693"></a>01693 <span class="keyword">public</span>:
<a name="l01705"></a>01705   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#428bcdd632a30b021370f9336ffc8888" title="The method returns magnetic coordinates of the point of a field line, that passes...">mixCoordFieldLine</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;mixCoord0, <span class="keywordtype">double</span> fcyl);
<a name="l01709"></a>01709   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#8815b83783c9f05c322d3946bb07c2ed" title="The method returns grad(|B|).">gradB</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord);
<a name="l01714"></a>01714   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#b846f6c6ac5682aa76824da02e96a001" title="The method returns covariant components of grad(|B|).">getCovaGradB</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord) <span class="keyword">const</span>;
<a name="l01722"></a>01722   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#a7453dd5a0ea5c92130f20866598b1ea" title="The method returns B and gradients in cylindrical coordinates.">getBandGradients</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;u, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#8815b83783c9f05c322d3946bb07c2ed" title="The method returns grad(|B|).">gradB</a>, 
<a name="l01723"></a>01723                                   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;grads, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;gradTh, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;gradPh);
<a name="l01724"></a>01724 
<a name="l01732"></a>01732   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#6b72996c696387c6cc5699405f27fd84" title="Get B and gradients in cartesian coordinates.">getBandGradientsxyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;u, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#8815b83783c9f05c322d3946bb07c2ed" title="The method returns grad(|B|).">gradB</a>, 
<a name="l01733"></a>01733                                   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;grads, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;gradTh, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;gradPh);
<a name="l01734"></a>01734 
<a name="l01742"></a>01742   <span class="keywordtype">void</span>  <a class="code" href="classMConf_1_1CStconfig.html#a41909991f3b88b72de6028e5e7ce6ec" title="Get B and basis vectors in cartesian coordinates.">getBandBasisVectorsxyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;u, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;Bxyz, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;gradBxyz, 
<a name="l01743"></a>01743                             <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e1con, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e2con, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e3con,
<a name="l01744"></a>01744                             <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e1cov, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e2cov, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e3cov);
<a name="l01745"></a>01745 
<a name="l01747"></a>01747   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#368460ed36b385ce4974577b483412af">getdBGradscyl</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>,
<a name="l01748"></a>01748                        <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdr,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdfir,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdz,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;grads);
<a name="l01750"></a>01750   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#e2bbfaeae1efd9a9d5537db780b79c72">getdBGradsxyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>,
<a name="l01751"></a>01751                        <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdx,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdy,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdz,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;grads );
<a name="l01752"></a>01752 
<a name="l01759"></a>01759   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#bece49dae12f6cab1f2ee5a68d0bd964" title="The method returns B and curl(B) in cylindrical coordinates.">getBcurlBGradscyl</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;u,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;curlB,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;grads);
<a name="l01760"></a>01760 
<a name="l01765"></a>01765   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#e4bbaeb9605fa5855a1305fa0fbd7839" title="The method returns the local shear.">getLocalShear</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCrd,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;grads);
<a name="l01766"></a>01766   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#e4bbaeb9605fa5855a1305fa0fbd7839" title="The method returns the local shear.">getLocalShear</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCrd);
<a name="l01767"></a>01767 
<a name="l01769"></a>01769   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#644bfa9c71f1bf4f8b1bf2b175824286" title="If sw==true then the method forces to use Jacobian=dX/dFlux*(dX/dtheta^dX/dphi) for...">useMixedProductForJacobian</a>(<span class="keywordtype">bool</span> sw);
<a name="l01770"></a>01770 
<a name="l01780"></a>01780   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#b06b5a7dac1e2b09c117db41c529cd45" title="Jacobian: dV = Jacobian(s,theta,phi)*ds*dtheta*dphi.">Jacobian</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord, <span class="keywordtype">double</span> *Bmod=0) <span class="keyword">const</span>; 
<a name="l01782"></a>01782 
<a name="l01783"></a>01783 
<a name="l01784"></a>01784 
<a name="l01785"></a>01785 
<a name="l01786"></a>01786 
<a name="l01787"></a>01787   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#f9d57bc16554663cda6e627a3b4d95e6" title="The method returns the cartesian coordinates of the point.">mag2xyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord) <span class="keyword">const</span>; <span class="comment">// return vector (x,y,z) for point (s,theta,phi)</span>
<a name="l01792"></a>01792 <span class="comment"></span>  <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#f9d57bc16554663cda6e627a3b4d95e6" title="The method returns the cartesian coordinates of the point.">mag2xyz</a>(<span class="keywordtype">double</span> s,<span class="keywordtype">double</span> theta,<span class="keywordtype">double</span> phi) <span class="keyword">const</span>;
<a name="l01796"></a>01796   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#ffdda6b1e5a549d46b23c22810dcc1f6" title="The method makes transformation from magnetic coordinates to cylindrical.">mag2cyl</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord) <span class="keyword">const</span>; <span class="comment">// return vector (R,fi,Z) for point (s,theta,phi)</span>
<a name="l01801"></a>01801 <span class="comment"></span>  <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#ffdda6b1e5a549d46b23c22810dcc1f6" title="The method makes transformation from magnetic coordinates to cylindrical.">mag2cyl</a>(<span class="keywordtype">double</span> s,<span class="keywordtype">double</span> theta,<span class="keywordtype">double</span> phi) <span class="keyword">const</span>;
<a name="l01809"></a>01809   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#7c7243a8b3a4188bb316881beb1351d9" title="The method returns cylindrical coordinates which correspond to the mixed coordinates...">mixcoord2cyl</a>(<span class="keywordtype">double</span> s,<span class="keywordtype">double</span> theta,<span class="keywordtype">double</span> fi,<span class="keywordtype">double</span>* phi=0,
<a name="l01810"></a>01810                                  <a class="code" href="classMConf_1_1CStconfig.html#2de55c2b29fb1b50576f926e610aee2e">sumDat</a> *sdat=0) <span class="keyword">const</span>;
<a name="l01815"></a>01815   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#7c7243a8b3a4188bb316881beb1351d9" title="The method returns cylindrical coordinates which correspond to the mixed coordinates...">mixcoord2cyl</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;mixcoord, <span class="keywordtype">double</span>* phi=NULL) <span class="keyword">const</span>;
<a name="l01820"></a>01820   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#63a012cc3b23f3b2ae6ebee9e37f593a" title="The method returns cartesian coordinates which correspond to the mixed coordinates...">mixcoord2xyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;mixcoord, <span class="keywordtype">double</span>* phi=NULL) <span class="keyword">const</span>;
<a name="l01824"></a><a class="code" href="classMConf_1_1CStconfig.html#2148b55321886090d20ff2320a93de2f">01824</a>   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#2148b55321886090d20ff2320a93de2f" title="The method returns cylindrical coordinates of the magnetic axis.">Axiscyl</a>(<span class="keywordtype">double</span> ficyl)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#7c7243a8b3a4188bb316881beb1351d9" title="The method returns cylindrical coordinates which correspond to the mixed coordinates...">mixcoord2cyl</a>(0,0,ficyl);}
<a name="l01826"></a>01826 
<a name="l01827"></a>01827 
<a name="l01828"></a>01828 
<a name="l01829"></a>01829 
<a name="l01830"></a><a class="code" href="classMConf_1_1CStconfig.html#9f0c719e8c86e045f6cb653adf2ab970">01830</a>   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#9f0c719e8c86e045f6cb653adf2ab970" title="The method forces to use the stream function lambda for B-field calculatioins, the...">useVmecLambdaOn</a>() {
<a name="l01831"></a>01831     useVmecLambda=<span class="keyword">true</span>;
<a name="l01832"></a>01832   }
<a name="l01835"></a><a class="code" href="classMConf_1_1CStconfig.html#dbd405b6b931d2dcff50c5cb334a12df">01835</a>   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#dbd405b6b931d2dcff50c5cb334a12df" title="The method forces to use the VMEC contravariant B in B-field calculatioins, the method...">useVmecLambdaOff</a>() {
<a name="l01836"></a>01836     <span class="keywordflow">if</span>(<a class="code" href="classMConf_1_1CStconfig.html#86e74dd3850d30428a0bcd171d96f938" title="VMEC Coordinates if true.">vmecCoordinates</a>) useVmecLambda=<span class="keyword">false</span>;
<a name="l01837"></a>01837   }
<a name="l01838"></a>01838 <span class="comment">//Newton's method</span>
<a name="l01854"></a>01854 <span class="comment"></span>  <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> *<a class="code" href="classMConf_1_1CStconfig.html#7688b0a377acb9ba2bc03b71d20ea8d9" title="The method calculates Jacobian matrix for Newton&amp;#39;s iteration.">NJacobian</a> (<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord);
<a name="l01858"></a>01858   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> *<a class="code" href="classMConf_1_1CStconfig.html#bb6c85240615a14d49e9058e9119cbc3" title="The method calculates Jacobian matrix for Newton&amp;#39;s iteration using linear interpolation...">NJacobianL</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord);
<a name="l01867"></a>01867   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#ae9197428dc2fa53ea8c415d42630748" title="The method makes transformation from cylindrical to magnetic coordinates.">cyl2mag</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl); <span class="comment">// return vector (s,theta,phi) for point (R,fi,Z)</span>
<a name="l01876"></a>01876 <span class="comment"></span>  <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#ae9197428dc2fa53ea8c415d42630748" title="The method makes transformation from cylindrical to magnetic coordinates.">cyl2mag</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoordGuess);
<a name="l01877"></a>01877 <span class="keyword">private</span>:
<a name="l01878"></a>01878   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#ae9197428dc2fa53ea8c415d42630748" title="The method makes transformation from cylindrical to magnetic coordinates.">cyl2mag</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl, <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoordGuess, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> *Jguess);
<a name="l01879"></a>01879 <span class="keyword">public</span>:
<a name="l01888"></a>01888   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#d7dea2a77452b811ef05afdeba787471" title="The method makes transformation from cartesian to magnetic coordinates.">xyz2mag</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz); <span class="comment">// return vector (s,theta,phi) for point (x,y,z)</span>
<a name="l01892"></a><a class="code" href="classMConf_1_1CStconfig.html#8779c559cbf3003d7b847c93ce9dcd23">01892</a> <span class="comment"></span>  <span class="keywordtype">double</span>   <a class="code" href="classMConf_1_1CStconfig.html#8779c559cbf3003d7b847c93ce9dcd23" title="The method finds the flux label s which corresponds to the point in space.">cyl2s</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl) {<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#ae9197428dc2fa53ea8c415d42630748" title="The method makes transformation from cylindrical to magnetic coordinates.">cyl2mag</a>(cyl)[0];}
<a name="l01896"></a><a class="code" href="classMConf_1_1CStconfig.html#69db861acfc315919fa03281a6521db6">01896</a>   <span class="keywordtype">double</span>   <a class="code" href="classMConf_1_1CStconfig.html#69db861acfc315919fa03281a6521db6" title="The method finds the flux label s which corresponds to the point in space.">xyz2s</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz) {<span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#d7dea2a77452b811ef05afdeba787471" title="The method makes transformation from cartesian to magnetic coordinates.">xyz2mag</a>(xyz)[0];}
<a name="l01913"></a>01913   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#7daa4dfe6dee19f523ae628226af6f97" title="The method makes transformation from cylindrical to magnetic coordinates using 2d-iteration...">cyl2guess</a> (<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<span class="keywordtype">double</span> eps, <span class="keywordtype">double</span> smax=1, <span class="keywordtype">bool</span> *inside=0); 
<a name="l01914"></a>01914 <span class="comment">//The following function must be called only after calling of NJacobian, or xyz2mag, or cyl2mag</span>
<a name="l01918"></a>01918 <span class="comment"></span>  <span class="keywordtype">double</span>     <a class="code" href="classMConf_1_1CStconfig.html#e709bda82c924e3697a39ee99e4b47a7" title="The method returns |B|.">getmodB</a>() <span class="keyword">const</span>;   <span class="comment">// |B|</span>
<a name="l01920"></a>01920 <span class="comment"></span>  <span class="keywordtype">double</span>     <a class="code" href="classMConf_1_1CStconfig.html#e709bda82c924e3697a39ee99e4b47a7" title="The method returns |B|.">getmodB</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl); 
<a name="l01925"></a>01925   <span class="keywordtype">double</span>     <a class="code" href="classMConf_1_1CStconfig.html#956db319cd477deaa4665d37c9881be6" title="The method returns Jacobian=mu0*(Ipol+iota*Itor)/(4pi2B2).">getJac</a>() <span class="keyword">const</span>;  <span class="comment">// Jacobian in coordinates (torFlux,theta,phi)</span>
<a name="l01927"></a>01927 <span class="comment"></span>  <span class="keywordtype">double</span>     <a class="code" href="classMConf_1_1CStconfig.html#956db319cd477deaa4665d37c9881be6" title="The method returns Jacobian=mu0*(Ipol+iota*Itor)/(4pi2B2).">getJac</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl);  <span class="comment">// Jacobian in coordinates (torFlux,theta,phi)</span>
<a name="l01932"></a>01932 <span class="comment"></span>  <span class="keywordtype">double</span>     <a class="code" href="classMConf_1_1CStconfig.html#951b28905de3849d1df00c2fb21f9dec" title="The method returns Jacobian=Flux(1)*mu0*(Ipol+iota*Itor)/(4pi2B2).">getJ</a>() <span class="keyword">const</span>;      <span class="comment">// Jacobian in coordinates (s,theta,phi)</span>
<a name="l01934"></a>01934 <span class="comment"></span>  <span class="keywordtype">double</span>     <a class="code" href="classMConf_1_1CStconfig.html#951b28905de3849d1df00c2fb21f9dec" title="The method returns Jacobian=Flux(1)*mu0*(Ipol+iota*Itor)/(4pi2B2).">getJ</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl);      <span class="comment">// Jacobian in coordinates (s,theta,phi)</span>
<a name="l01939"></a>01939 <span class="comment"></span>  <span class="keywordtype">double</span>     <a class="code" href="classMConf_1_1CStconfig.html#ff009d9e04d94fc095f11cc259b75b0f" title="The method returns Jacobian=dX/dFlux*(dX/dtheta^dX/dphi).">getJac2</a>() <span class="keyword">const</span>;
<a name="l01942"></a>01942   <span class="keywordtype">double</span>     <a class="code" href="classMConf_1_1CStconfig.html#ff009d9e04d94fc095f11cc259b75b0f" title="The method returns Jacobian=dX/dFlux*(dX/dtheta^dX/dphi).">getJac2</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl);
<a name="l01947"></a>01947   <span class="comment">// Jacobian(s,theta,phi) = R*(R,s*R,t^R,p)) -- jacobian, where ^ is a cross product</span>
<a name="l01948"></a>01948   <span class="keywordtype">double</span>     <a class="code" href="classMConf_1_1CStconfig.html#7b6abd54a497f0c4382df9e09c0001d5" title="The method returns Jacobian=dX/ds*(dX/dtheta^dX/dphi).">getJ2</a>() <span class="keyword">const</span>;
<a name="l01951"></a>01951   <span class="keywordtype">double</span>     <a class="code" href="classMConf_1_1CStconfig.html#7b6abd54a497f0c4382df9e09c0001d5" title="The method returns Jacobian=dX/ds*(dX/dtheta^dX/dphi).">getJ2</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl);
<a name="l01955"></a>01955   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#4bac07e1d4bf7f03f018ea2aaf0fa187" title="The method returns cartesian B-vector.">getBxyz</a>();   <span class="comment">// B-vector in cartesian coord.</span>
<a name="l01957"></a>01957 <span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#4bac07e1d4bf7f03f018ea2aaf0fa187" title="The method returns cartesian B-vector.">getBxyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz);
<a name="l01961"></a>01961   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#0c64d7e5e55395a92da943d990181cc2" title="The method returns cylindrical B-vector.">getBcyl</a>() <span class="keyword">const</span>;   <span class="comment">// B-vector in cylindrical coord.</span>
<a name="l01963"></a>01963 <span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#0c64d7e5e55395a92da943d990181cc2" title="The method returns cylindrical B-vector.">getBcyl</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl); 
<a name="l01967"></a>01967   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#d9cf11bb0e3a9665427596b235b320d5" title="The method returns cylindrical vector grad(theta).">getGradtheta</a>() <span class="keyword">const</span>;
<a name="l01969"></a>01969   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#d9cf11bb0e3a9665427596b235b320d5" title="The method returns cylindrical vector grad(theta).">getGradtheta</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl); 
<a name="l01972"></a>01972   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#87eeab3f00a2018ca51ad07ff1f514f5" title="The method returns cylindrical vector grad(lambda) for VMEC coordinates, where lambda...">getGradlambda</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl);
<a name="l01977"></a>01977   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#87eeab3f00a2018ca51ad07ff1f514f5" title="The method returns cylindrical vector grad(lambda) for VMEC coordinates, where lambda...">getGradlambda</a>() <span class="keyword">const</span>;
<a name="l01978"></a>01978 
<a name="l01982"></a>01982   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#3a532d4e9a8aabfaa4543c7887ebabd1" title="The method returns cylindrical vector grad(phi).">getGradphi</a>() <span class="keyword">const</span>;
<a name="l01984"></a>01984   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#3a532d4e9a8aabfaa4543c7887ebabd1" title="The method returns cylindrical vector grad(phi).">getGradphi</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl);
<a name="l01988"></a>01988   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#2124430971b90595077ef572da23768e" title="The method returns cylindrical vector grad(Flux).">getGradFlux</a>() <span class="keyword">const</span>;
<a name="l01990"></a>01990   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#2124430971b90595077ef572da23768e" title="The method returns cylindrical vector grad(Flux).">getGradFlux</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl);
<a name="l01994"></a>01994   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#f8c19c4c1925c0bf4474bd4383c80d4b" title="The method returns cylindrical vector grad(s).">getGrads</a>() <span class="keyword">const</span>; 
<a name="l01996"></a>01996   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#f8c19c4c1925c0bf4474bd4383c80d4b" title="The method returns cylindrical vector grad(s).">getGrads</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl);  <span class="comment">// grad(s)</span>
<a name="l02000"></a>02000 <span class="comment"></span>  <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#54d7b1c697abc21b061ad13c2623ba46" title="The method returns cartesian vector grad(s).">getGradsxyz</a>() <span class="keyword">const</span>;
<a name="l02002"></a>02002   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#54d7b1c697abc21b061ad13c2623ba46" title="The method returns cartesian vector grad(s).">getGradsxyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz);
<a name="l02006"></a>02006   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#d20dbe87a2ef6aaa4614d8b071b0f709" title="The method returns cylindrical vector grad(reff).">getGradreff</a>() <span class="keyword">const</span>;<span class="comment">// grad(r_eff)</span>
<a name="l02008"></a>02008 <span class="comment"></span>  <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#d20dbe87a2ef6aaa4614d8b071b0f709" title="The method returns cylindrical vector grad(reff).">getGradreff</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl); 
<a name="l02013"></a>02013   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> * <a class="code" href="classMConf_1_1CStconfig.html#c1bb132652ebcb6c2cb87e72b6430f32" title="The method retuns pointer to the Jacobian matrix for Newton&amp;#39;s iteration calculated...">getNJmatrix</a>();
<a name="l02016"></a>02016   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> * <a class="code" href="classMConf_1_1CStconfig.html#c1bb132652ebcb6c2cb87e72b6430f32" title="The method retuns pointer to the Jacobian matrix for Newton&amp;#39;s iteration calculated...">getNJmatrix</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl); 
<a name="l02034"></a>02034   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> * <a class="code" href="classMConf_1_1CStconfig.html#623d5dfd8537ae6dd5a3ccda5e7dbdd3" title="The method retuns pointer to the MetricTensor calculated by CStconfig::NJacobian...">getMetricTensor</a>();
<a name="l02048"></a>02048   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> * <a class="code" href="classMConf_1_1CStconfig.html#623d5dfd8537ae6dd5a3ccda5e7dbdd3" title="The method retuns pointer to the MetricTensor calculated by CStconfig::NJacobian...">getMetricTensor</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl);
<a name="l02052"></a>02052   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#3b9657a98c53bf8622f367317838b304" title="The method returns the cylindrical coordinates of the last point used in coordinate...">getRcyl</a>() <span class="keyword">const</span>;
<a name="l02056"></a>02056   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#d06b298ad1464b8cecc2f2d699f5917e" title="The method returns the cartesian coordinates of the last point used in coordinate...">getRxyz</a>() <span class="keyword">const</span>;
<a name="l02060"></a>02060   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#b98a481b90f364541a0421da9d82bbd3" title="The method returns covariant components of B = (B_s,B_theta,B_phi) in (s,theta,phi)...">getBcova</a>() <span class="keyword">const</span>;
<a name="l02064"></a>02064   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#c0f67d5a96d3e5da6b0fa021d021b04e" title="The method returns contravariant components of B = (0,B^theta,B^phi).">getBcontra</a>() <span class="keyword">const</span>;
<a name="l02068"></a>02068   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#40e3ce7e5d21d9cd10053288f488f4bd" title="The method returns covariant-basis vectors e_i = dX/du^i in cylindrical coordinates...">getCovaBasis</a>  (<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e1, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e2, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e3) <span class="keyword">const</span>;
<a name="l02072"></a>02072   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#7ef07c3566416626796d4aa0d5d1c0a3" title="The method returns contravariant-basis vectors e^i = grad(u^i) in cylindrical coordinates...">getContraBasis</a>(<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e1, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e2, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e3) <span class="keyword">const</span>;
<a name="l02077"></a>02077   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#19fd2a5466a6ed5fcdbb943c6d7f594d" title="The method returns grad(|B|) in cylindrical coordinates.">getGradBcyl</a>();
<a name="l02081"></a>02081   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#19fd2a5466a6ed5fcdbb943c6d7f594d" title="The method returns grad(|B|) in cylindrical coordinates.">getGradBcyl</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl);
<a name="l02086"></a>02086   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#d8743964f1bd7a958c65d2bb8f3ac5a8" title="The method returns grad(|B|) in cartesian coordinates.">getGradBxyz</a>();
<a name="l02090"></a>02090   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a>  <a class="code" href="classMConf_1_1CStconfig.html#d8743964f1bd7a958c65d2bb8f3ac5a8" title="The method returns grad(|B|) in cartesian coordinates.">getGradBxyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz);
<a name="l02091"></a>02091 
<a name="l02094"></a>02094 
<a name="l02105"></a>02105   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#ab04c804ead818e1aa22410f3660fcb9" title="VMEC coordinates vmecCoord=(s,theta,phi).">Vmec2Pest</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;vmec);
<a name="l02106"></a>02106   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#1cba9a2908bf641ea19de25d20bbdd6e">Pest2Vmec</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;pest);
<a name="l02107"></a>02107   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#60d7339723e10f8af888f1db382dea4d">SFLcoordOnBlineAtTheta</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;pest0, <span class="keywordtype">double</span> theta, <span class="keywordtype">double</span> iotA=0);
<a name="l02108"></a>02108   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#c17e3819bea9151989ba798ffa3b0678">SFLcontraBasis</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;pest, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e1, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e2, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e3, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;vmec);
<a name="l02109"></a>02109   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#faf3333f97391fa98d3326561f501b76">BoozerContraBasis</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;booz, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e1, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e2, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e3, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;vmec);
<a name="l02110"></a>02110   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#5f9d3bd653ccc912a1438e6829fb018c">Vmec2PestContraBasis</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;vmec, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e1, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e2, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;e3, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;pest);
<a name="l02112"></a>02112 
<a name="l02113"></a>02113 
<a name="l02114"></a>02114 
<a name="l02126"></a>02126   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#332cf8154672d5e697c11687b3d3643a" title="The method transforms the VMEC coordinates to Boozer.">Vmec2Boozer</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;vmecCoord);
<a name="l02139"></a>02139   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#b4c9d5f55be0526b19b49a6e7fe99972" title="The method transforms the Boozer coordinates to VMEC.">Boozer2Vmec</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;boozer);
<a name="l02160"></a>02160   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#13c116c659fa2709492341b5977000de" title="The method transforms the VMEC wout-file to Boozer-coordinate data file.">writeVmec2Boozer</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>, <span class="keywordtype">int</span> method=0, <span class="keywordtype">int</span> M=0, <span class="keywordtype">int</span> N=0);
<a name="l02165"></a>02165   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#503ee2e48a2e9e8930cfb3c75d0e6e07" title="The method peforms test, that d(theta_booz,phi_booz)/d(theta_vmec,phi_vmec) == (Jacobian_vmec/Jacobi...">Vmec2BoozerTest</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;vmecCoord);
<a name="l02167"></a>02167 
<a name="l02168"></a>02168 
<a name="l02169"></a>02169 
<a name="l02170"></a>02170 
<a name="l02171"></a>02171 
<a name="l02172"></a>02172 
<a name="l02173"></a>02173 
<a name="l02174"></a>02174 
<a name="l02175"></a>02175   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#a31e4e959155885ff8cd790f5d68b921" title="The method tests whether the point lies inside LCMS.">cylIsInside</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<span class="keywordtype">double</span> * distance=0) <span class="keyword">const</span>;
<a name="l02182"></a>02182   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#c1eb0b6b838bc6c9a7fc538f7300ca6b" title="The method tests whether the point lies inside LCMS.">xyzIsInside</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz,<span class="keywordtype">double</span> * distance=0) <span class="keyword">const</span>;
<a name="l02194"></a>02194   <span class="keywordtype">bool</span>  <a class="code" href="classMConf_1_1CStconfig.html#9954f2daeead51238315dba118fa2d06" title="The method tests whether the point lies inside the given border.">cylIsInsideBorder</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<span class="keywordtype">double</span> *distance=0,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> *point=0,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> *magCoord=0) <span class="keyword">const</span>;
<a name="l02200"></a>02200   <span class="keywordtype">bool</span>  <a class="code" href="classMConf_1_1CStconfig.html#99361269507f2b5fc1372ea8912d1b88" title="The method creates the border -- &amp;#39;s&amp;#39;-contour at cylindrical angle &amp;#39;ficyl&amp;#39;...">createBorder</a>(<span class="keywordtype">double</span> s,<span class="keywordtype">double</span> ficyl,<span class="keywordtype">int</span> borderSize=150);
<a name="l02202"></a><a class="code" href="classMConf_1_1CStconfig.html#476658b9c24d48a658ee8302dadc90be">02202</a>   <span class="keywordtype">int</span>   <a class="code" href="classMConf_1_1CStconfig.html#476658b9c24d48a658ee8302dadc90be" title="The method returns the number of points in the border created by createBorder() method...">getBorderSize</a>() { <span class="keywordflow">return</span> mBorder.<a class="code" href="classMConf_1_1CArray1d.html#b8e4e3e2a7bf18888b71bdf9dda0770b" title="get the the first dimention of the array.">size</a>();}
<a name="l02206"></a><a class="code" href="classMConf_1_1CStconfig.html#864d7307cb10d3b82ab372808a546e86">02206</a>   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#864d7307cb10d3b82ab372808a546e86" title="The method returns the cylindrical cooordinates of the k-point of the border.">getBorder</a>(<span class="keywordtype">int</span> k)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mBorder[k];}
<a name="l02210"></a><a class="code" href="classMConf_1_1CStconfig.html#1c578c0d0306f9702529a4a4c7a762a0">02210</a>   <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; <a class="code" href="classMConf_1_1CStconfig.html#1c578c0d0306f9702529a4a4c7a762a0" title="The method returns the magnetic cooordinates of the k-point of the border.">getBorderMag</a>(<span class="keywordtype">int</span> k)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mBorderMagCoord[k];}
<a name="l02212"></a><a class="code" href="classMConf_1_1CStconfig.html#fa998aa3157e8f30932ce88b86e6d218">02212</a>   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; <a class="code" href="classMConf_1_1CStconfig.html#fa998aa3157e8f30932ce88b86e6d218" title="The method returns the min value of R-cooordinate of the border.">getBorderRmin</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mBorderRmin;}
<a name="l02214"></a><a class="code" href="classMConf_1_1CStconfig.html#6bfe1f0f089daf4951c887feca080765">02214</a>   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; <a class="code" href="classMConf_1_1CStconfig.html#6bfe1f0f089daf4951c887feca080765" title="The method returns the max value of R-cooordinate of the border.">getBorderRmax</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mBorderRmax;}
<a name="l02215"></a><a class="code" href="classMConf_1_1CStconfig.html#2cd9604f8367d61610388e360cd67258">02215</a>   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; <a class="code" href="classMConf_1_1CStconfig.html#2cd9604f8367d61610388e360cd67258">getBorderZmin</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mBorderZmin;}
<a name="l02216"></a><a class="code" href="classMConf_1_1CStconfig.html#58404e0c9382704698a55fa2eaeb5a7f">02216</a>   <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; <a class="code" href="classMConf_1_1CStconfig.html#58404e0c9382704698a55fa2eaeb5a7f">getBorderZmax</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> mBorderZmax;}
<a name="l02224"></a>02224   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#c80822d8c817c68a81389c8c3b9a7a8b" title="The method traces the Last Closed Magnetic Surface (LCMS).">getRayEntryPoint</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;r0,<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;rd,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;entryPoint);
<a name="l02233"></a>02233   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#b142545dee93b8bc6964e2d513e4e550" title="The method traces the Last Closed Magnetic Surface (LCMS).">getRayIntersectionPoints</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;r0,<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;rd,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;entryPoint,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;exitPoint);
<a name="l02234"></a>02234   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#d00a6862ab3f2435c40984a970bfa696">xyzAtB</a>(<span class="keywordtype">double</span> Bres,<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;r0,<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;rd, <span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;entryPoint);
<a name="l02235"></a>02235 
<a name="l02248"></a>02248   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#fd56f334691f7cccd5ade4ed83626a04">getCoeffForAstraCode</a>(<span class="keywordtype">double</span> sqrts, <span class="keywordtype">double</span> &amp;<a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>, <span class="keywordtype">double</span> &amp;gradr2, <span class="keywordtype">double</span> &amp;J, <span class="keywordtype">double</span> &amp;G2, <span class="keywordtype">double</span> &amp;hV, <span class="keywordtype">double</span> &amp;B0, <span class="keywordtype">double</span> &amp;<a class="code" href="classMConf_1_1CStconfig.html#5071bac3b69aa33e84e7b741f8c4083a" title="The method returns the major radius in [m].">R0</a>, <span class="keywordtype">double</span> &amp;h);
<a name="l02249"></a>02249 
<a name="l02251"></a>02251 
<a name="l02252"></a>02252 
<a name="l02253"></a>02253 
<a name="l02254"></a>02254   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#d7e78d86f6eb6f562fd8cc2d976df85f" title="Clear statistics.">zeroStatistics</a>();
<a name="l02257"></a><a class="code" href="classMConf_1_1CStconfig.html#2d9157c99687de8f5841442af2066bff">02257</a>   <span class="keywordtype">int</span> &amp; <a class="code" href="classMConf_1_1CStconfig.html#2d9157c99687de8f5841442af2066bff" title="The method returns the number of NJacobian calls.">nJac</a>() { <span class="keywordflow">return</span> <a class="code" href="group__NewtonMethod.html#g985ec02fa37f4c1923e2e2933c9dca27" title="number of jacobian calculation">mNjac</a>;} <span class="comment">// number of NJacobian calls</span>
<a name="l02260"></a><a class="code" href="classMConf_1_1CStconfig.html#ae269bb25542ca0366b23dcbfa21774f">02260</a> <span class="comment"></span>  <span class="keywordtype">int</span> &amp; <a class="code" href="classMConf_1_1CStconfig.html#ae269bb25542ca0366b23dcbfa21774f" title="The method returns the number of coordinate transformations from real space to magnetic...">n2mag</a>() { <span class="keywordflow">return</span> <a class="code" href="group__NewtonMethod.html#gebcb75c75476c06501df15a8b113e72a" title="number of calling of cyl2mag-function(Newton&amp;#39;s iteration)">mNcyl2mag</a>;} <span class="comment">// number of cyl2bmag calls</span>
<a name="l02264"></a>02264 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#5d440adbd445ec30264bb7891ba75dfd" title="The method returns the average number of poloidal harmonics used in summation during...">MAverage</a>() <span class="keyword">const</span>;
<a name="l02268"></a>02268   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#8e986b8aacf34edecd043acd348e4055" title="The method returns the average number of toroidal harmonics used in summation during...">NAverage</a>() <span class="keyword">const</span>;
<a name="l02271"></a>02271   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#69d62cfbd7364cbb21adedc2d6a974c2" title="The method returns the number of NJacobian calls.">NNjacCalls</a>() <span class="keyword">const</span>;
<a name="l02274"></a>02274   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#99c6779f65240dbc6614c9f2f763d33e" title="The method returns the number of mag2cyl calls.">Nmag2cylCalls</a>() <span class="keyword">const</span>;
<a name="l02277"></a>02277   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#2bbe955b8e53e020b37bc38290982e9e" title="The method returns the number of cyl2mag calls.">Ncyl2magCalls</a>() <span class="keyword">const</span>;
<a name="l02278"></a>02278   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#b086ce4f2e40b41d2b21b0f3a220f112">NGuessCalls</a>() <span class="keyword">const</span>;
<a name="l02279"></a>02279 
<a name="l02281"></a>02281 
<a name="l02282"></a>02282 
<a name="l02283"></a>02283 <span class="comment">// Find magnetic toroidal angle phi for point (s,theta,ficyl), ficyl is a cylindrical angle</span>
<a name="l02289"></a>02289 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#fbb5b88e734d3c9548676110cf471f56" title="The method returns the magnetic toroidal angle which corresponds to the mixed coordinates...">phimag</a>(<span class="keywordtype">double</span> s,<span class="keywordtype">double</span> theta,<span class="keywordtype">double</span> ficyl) <span class="keyword">const</span>;
<a name="l02294"></a>02294   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#fbb5b88e734d3c9548676110cf471f56" title="The method returns the magnetic toroidal angle which corresponds to the mixed coordinates...">phimag</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;mixcoord) <span class="keyword">const</span>;
<a name="l02297"></a>02297   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#36a23eeb80c3a5fd06afddeb323449da" title="The method returns the sizes of a rectangle circumscribed about the cross section...">getExtent</a>(<span class="keywordtype">double</span> &amp;Rmin,<span class="keywordtype">double</span> &amp;Rmax,<span class="keywordtype">double</span> &amp;Zmin,<span class="keywordtype">double</span> &amp;Zmax,<span class="keywordtype">double</span> s,<span class="keywordtype">double</span> fi) <span class="keyword">const</span>;
<a name="l02299"></a>02299   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#36a23eeb80c3a5fd06afddeb323449da" title="The method returns the sizes of a rectangle circumscribed about the cross section...">getExtent</a>(<span class="keywordtype">double</span> &amp;Rmin,<span class="keywordtype">double</span> &amp;Rmax,<span class="keywordtype">double</span> &amp;Zmin,<span class="keywordtype">double</span> &amp;Zmax,<span class="keywordtype">double</span> s) <span class="keyword">const</span>;
<a name="l02301"></a>02301   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#21f32e7d8fe04d73b5ef76312078b868" title="The method returns the sizes of a rectangle circumscribed about the cross section...">getExtentLCMS</a>(<span class="keywordtype">double</span> &amp;Rmin, <span class="keywordtype">double</span> &amp;Rmax, <span class="keywordtype">double</span> &amp;Zmin, <span class="keywordtype">double</span> &amp;Zmax) <span class="keyword">const</span>;
<a name="l02304"></a>02304   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#36a23eeb80c3a5fd06afddeb323449da" title="The method returns the sizes of a rectangle circumscribed about the cross section...">getExtent</a>(<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;rmin, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;rmax, <span class="keywordtype">double</span> s, <span class="keywordtype">double</span> f1, <span class="keywordtype">double</span> f2) <span class="keyword">const</span>;
<a name="l02308"></a>02308   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#57f2fdbd8a9eae5d1a303b812b469e8c" title="The method returns the sign of the Jacobian calculating the mixed product dX/ds*(dX/dtheta^dX/dphi)...">getJacobianSign</a>();
<a name="l02313"></a>02313   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#2bf3ae47fd100c9e8ee1bbd207cd5a36" title="The method returns the direction of the poloidal angle.">getThetaDirection</a>();
<a name="l02316"></a>02316   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#4793b3a8b2af93d890b1ac7d4bc58ed3" title="The method returns the direction of the toroidal angle.">getPhiDirection</a>();
<a name="l02320"></a><a class="code" href="classMConf_1_1CStconfig.html#53122104d9e078475c4fdeb7016cbc29">02320</a>   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#53122104d9e078475c4fdeb7016cbc29" title="The method returns the direction of the toroidal current j^phi (in the right-handed...">getSignOfCurrentThatIncreasesAbsIota</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> (mSignJac_s*<a class="code" href="classMConf_1_1CStconfig.html#c3852ad9657fd13676d77b41bbc7bf62" title="The method returns the poloidal current in [A].">Ip</a>(0.25)*<a class="code" href="classMConf_1_1CStconfig.html#edef0b58e6ab7917ae149d1ca29ec0fd" title="The method returns the iota, where s is the normalized toroidal flux.">iota</a>(0.25) &gt;= 0)?1:-1;}
<a name="l02324"></a><a class="code" href="classMConf_1_1CStconfig.html#f4f25b66127baf230b0afd42f0f1f258">02324</a>   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#f4f25b66127baf230b0afd42f0f1f258" title="The method returns the sign of iota increment due to non-inductive current &amp;lt;j*B&amp;gt;/&amp;lt;|B|&amp;gt;...">getDeltaIotaSign</a>(<span class="keywordtype">double</span> Itor)<span class="keyword"> const </span>{<span class="keywordflow">return</span> Itor==0?0:( (mSignJac_s*Itor &gt; 0)?1:-1 );}
<a name="l02325"></a>02325 <span class="preprocessor">#if 0 </span>
<a name="l02329"></a>02329 <span class="preprocessor">  double Icyl2Itor(double Ifi) const {return mSignJac_s*Ifi;}</span>
<a name="l02333"></a>02333 <span class="preprocessor">  double Itor2Icyl(double Itor) const {return mSignJac_s*Itor;}</span>
<a name="l02334"></a>02334 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l02337"></a>02337 <span class="preprocessor">  const CArray2d&lt;Vector3d&gt; * LCMS();</span>
<a name="l02339"></a>02339 <span class="preprocessor">  const CArray2d&lt;Vector3d&gt; * BLCMS();</span>
<a name="l02341"></a><a class="code" href="classMConf_1_1CStconfig.html#e43b4e7c1e454d3e9ee5c9a479d63a25">02341</a> <span class="preprocessor">  double mod2pi   (double x) const { return (x&gt;=0)?fmod(x,twopi):(fmod(x,twopi)+twopi);}</span>
<a name="l02345"></a><a class="code" href="classMConf_1_1CStconfig.html#6098c46e0dda2cac4808b26091bd354c">02345</a> <span class="preprocessor">  double mod2piNoWrap   (double x) const </span>
<a name="l02346"></a>02346 <span class="preprocessor"></span>  {
<a name="l02347"></a>02347     <span class="keywordflow">if</span>(x&lt;0) {
<a name="l02348"></a>02348       x = fmod(x,<a class="code" href="classMConf_1_1CStconfig.html#909ffd84606c7ce005c63fd884ed691d">twopi</a>)+<a class="code" href="classMConf_1_1CStconfig.html#909ffd84606c7ce005c63fd884ed691d">twopi</a>;
<a name="l02350"></a>02350     }
<a name="l02351"></a>02351     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(x&gt;<a class="code" href="classMConf_1_1CStconfig.html#909ffd84606c7ce005c63fd884ed691d">twopi</a>) {
<a name="l02352"></a>02352       x = fmod(x,<a class="code" href="classMConf_1_1CStconfig.html#909ffd84606c7ce005c63fd884ed691d">twopi</a>);
<a name="l02354"></a>02354     }
<a name="l02355"></a>02355     <span class="keywordflow">return</span> x;
<a name="l02356"></a>02356   }
<a name="l02358"></a><a class="code" href="classMConf_1_1CStconfig.html#a1a51d53ba7dcb8a44808651f43f5d71">02358</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#a1a51d53ba7dcb8a44808651f43f5d71" title="The method reduces x to the interval 0..2pi/mNp, where mNp is the number of stellarator...">modPeriod</a>(<span class="keywordtype">double</span> x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (x&gt;=0)?fmod(x,<a class="code" href="classMConf_1_1CStconfig.html#980b0313f60f6c13454a331d07772846" title="twopi/mNp">mPeriod</a>):(fmod(x,<a class="code" href="classMConf_1_1CStconfig.html#980b0313f60f6c13454a331d07772846" title="twopi/mNp">mPeriod</a>)+<a class="code" href="classMConf_1_1CStconfig.html#980b0313f60f6c13454a331d07772846" title="twopi/mNp">mPeriod</a>);}
<a name="l02360"></a>02360   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#2cd3bb5729a342a4727dd904302c2766" title="The method sorts angles, so that f1&amp;lt;f2 and f2-f1&amp;lt;pi.">sortAngles</a>(<span class="keywordtype">double</span> &amp;f1, <span class="keywordtype">double</span> &amp;f2) <span class="keyword">const</span>;
<a name="l02362"></a>02362   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#5f269feee73645c42cd27a5282b4bfd2" title="The method creates array of vertexes of the surface s.">createSurface</a>(<span class="keywordtype">double</span> s,<span class="keywordtype">int</span> nTheta,<span class="keywordtype">int</span> nPhi,<a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;Vector3d&gt;</a> &amp;vertex,<a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;Vector3d&gt;</a> *Bfld=0, <span class="keywordtype">bool</span> cylPhi=<span class="keyword">true</span>);
<a name="l02368"></a>02368   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#fffc26e260889ed419aef27bfdfb4517" title="The method creates array of normals to the surface Vertexes.">createNormals</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;Vector3d&gt;</a> &amp;Vertexes, <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;Vector3d&gt;</a> &amp;normals, <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#74361f7f3765536dd1f9ce37e8ddbcf0">sign</a>=1) <span class="keyword">const</span>;
<a name="l02375"></a>02375   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#934dc0bd476ac3328de9384080843b17" title="The method calculates curvature at given point.">curvature</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord);
<a name="l02377"></a>02377   <span class="comment">//   0.01227 = twopi/512</span>
<a name="l02378"></a>02378   <span class="comment">//Vector3d bscurrentFactor(double s, double dphi=0.01227,int numBlevels=513,int numTurns=100);</span>
<a name="l02379"></a>02379 
<a name="l02380"></a>02380 <span class="keyword">private</span>:
<a name="l02381"></a>02381   <a class="code" href="threadtypes_8h.html#a88a5f4b2504d4f7799911938c624249">uiMutex</a> mConfMutex;
<a name="l02382"></a>02382   <span class="keyword">typedef</span> <span class="keywordtype">double</span> REAL;
<a name="l02383"></a>02383   <span class="keywordtype">bool</span> getRayIntersection(<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> dr, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;intersectionPoint);
<a name="l02384"></a>02384   <span class="keywordtype">bool</span> isRationalIota(<span class="keywordtype">double</span> s, <span class="keywordtype">double</span> eps=2e-2);
<a name="l02385"></a>02385   <span class="keywordtype">void</span> advanceDataForEpsEff02(<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;mag, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;r1, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;B1, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;n1, 
<a name="l02386"></a>02386                              REAL &amp;Bmod, REAL &amp;grads, REAL &amp;kG, REAL &amp;dl, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> *<a class="code" href="classMConf_1_1CStconfig.html#934dc0bd476ac3328de9384080843b17" title="The method calculates curvature at given point.">curvature</a>,
<a name="l02387"></a>02387                              <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;dphi, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;iotaRatnl);
<a name="l02388"></a>02388   <span class="keywordtype">void</span> advanceDataForEpsEff(<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;mag, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>, <span class="keywordtype">double</span> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>, <span class="keywordtype">double</span> &amp;gradReff, <span class="keywordtype">double</span> &amp;kG, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;dphi);
<a name="l02389"></a>02389   <span class="keywordtype">void</span> advanceDataForJinvariant(<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;mag, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;r1,REAL &amp;Bmod,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;covaGradB, REAL &amp;dl, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;dphi, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;iotaRatnl);
<a name="l02390"></a>02390   <span class="keywordtype">double</span> getOmega_d(<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; mag1, <span class="keywordtype">double</span> Bma, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp; curvature1,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdu1);
<a name="l02391"></a>02391 
<a name="l02392"></a>02392   <span class="comment">// dphi=0.00698  == 0.4 degree</span>
<a name="l02393"></a>02393   <span class="keywordtype">void</span> epsEff(<span class="keywordtype">double</span> s, __allEps &amp;eps);
<a name="l02394"></a>02394   <span class="keywordtype">void</span> calculateEpsEff();
<a name="l02395"></a>02395   <span class="keywordtype">void</span> calculateEpsEffExe(<a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * objR, <span class="keywordtype">int</span> low, <span class="keywordtype">int</span> upper, <span class="keywordtype">bool</span> setup);
<a name="l02396"></a>02396 
<a name="l02397"></a>02397   <span class="keywordtype">void</span> calculateFbs();
<a name="l02398"></a>02398   <span class="keywordtype">void</span> calculateFbsExe(<a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * objR, <span class="keywordtype">int</span> low, <span class="keywordtype">int</span> upper, <span class="keywordtype">bool</span> setup);
<a name="l02399"></a>02399   <span class="keywordtype">void</span> bscurrentFactor(<span class="keywordtype">double</span> s, __allFbs &amp;retValue);
<a name="l02400"></a>02400 
<a name="l02401"></a>02401   <span class="keywordtype">void</span> calculateGradsAvrg(<span class="keywordtype">int</span> size=34);
<a name="l02402"></a>02402   <span class="keywordtype">void</span> calculateGradsAvrgExe(<a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * objR, <span class="keywordtype">int</span> low, <span class="keywordtype">int</span> upper, <span class="keywordtype">bool</span> setup);
<a name="l02403"></a>02403 
<a name="l02404"></a>02404   <span class="keywordtype">void</span> calculateSMatrix(<span class="keywordtype">int</span> size = 30);
<a name="l02405"></a>02405   <span class="keywordtype">void</span> calculateSMatrixExe(<a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * objR, <span class="keywordtype">int</span> low, <span class="keywordtype">int</span> upper, <span class="keywordtype">bool</span> setup);
<a name="l02406"></a>02406 
<a name="l02408"></a>02408   <span class="keywordtype">void</span> calculateBminmax();
<a name="l02409"></a>02409   <span class="keywordtype">void</span> calculateBminmaxExe(<a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * objR, <span class="keywordtype">int</span> low, <span class="keywordtype">int</span> upper, <span class="keywordtype">bool</span> setup);
<a name="l02410"></a>02410 
<a name="l02411"></a>02411   <span class="keywordtype">void</span> calculateFtrappedBminmax();
<a name="l02412"></a>02412   <span class="keywordtype">void</span> calculateFtrappedBminmaxExe(<a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * objR, <span class="keywordtype">int</span> low, <span class="keywordtype">int</span> upper, <span class="keywordtype">bool</span> setup);
<a name="l02413"></a>02413 
<a name="l02414"></a>02414   <span class="keywordtype">void</span> calculateIpolItorFromSij(<span class="keywordtype">int</span> ntheads=-1);
<a name="l02415"></a>02415   <span class="keywordtype">void</span> calculateIpolItorFromSijExe(<a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * objR, <span class="keywordtype">int</span> low, <span class="keywordtype">int</span> upper, <span class="keywordtype">bool</span> setup);
<a name="l02416"></a>02416 
<a name="l02417"></a>02417   <span class="keywordtype">void</span> calculateIpolItor(<span class="keywordtype">int</span> ntheads=-1);
<a name="l02418"></a>02418   <span class="keywordtype">void</span> calculateIpolItorExe(<a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * objR, <span class="keywordtype">int</span> low, <span class="keywordtype">int</span> upper, <span class="keywordtype">bool</span> setup);
<a name="l02419"></a>02419   <span class="keywordtype">double</span> calculateItor(<span class="keywordtype">int</span> is, <span class="keywordtype">int</span> Ntheta=180);
<a name="l02420"></a>02420   <span class="keywordtype">double</span> calculateIpol(<span class="keywordtype">int</span> is, <span class="keywordtype">int</span> Ntphi=180);
<a name="l02421"></a>02421 
<a name="l02422"></a>02422 
<a name="l02423"></a>02423   <span class="keywordtype">void</span> calculateVp();
<a name="l02424"></a>02424   <span class="keywordtype">void</span> calculateVpExe(<a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * objR, <span class="keywordtype">int</span> low, <span class="keywordtype">int</span> upper, <span class="keywordtype">bool</span> setup);
<a name="l02425"></a>02425 <span class="comment">//template &lt;class TR&gt; void calculateVpExe(TR * objR, int low, int upper, bool setup);</span>
<a name="l02426"></a>02426 
<a name="l02427"></a>02427   <span class="keywordtype">void</span> calcEfitFourierMods(<span class="keywordtype">void</span> * efit);
<a name="l02428"></a>02428   <span class="keywordtype">void</span> calcEfitFourierModsExe(<a class="code" href="classMConf_1_1CEfit.html" title="Helper class that reads EFIT GEQDSK file and transforms it to the Tokamak Symmetry...">CEfit</a>* ef,<span class="keywordtype">int</span> low, <span class="keywordtype">int</span> upper, <span class="keywordtype">bool</span> setup);
<a name="l02429"></a>02429   <span class="comment">//template &lt;class efit&gt; void calcEfitFourierModsExe(efit* ef,int low, int upper, bool setup);</span>
<a name="l02430"></a>02430 
<a name="l02433"></a>02433   <span class="keywordtype">bool</span> resize(<span class="keywordtype">int</span> ns,<span class="keywordtype">int</span> m,<span class="keywordtype">int</span> n);
<a name="l02441"></a>02441   <span class="keywordtype">double</span> fi(<span class="keywordtype">double</span> s,<span class="keywordtype">double</span> theta,<span class="keywordtype">double</span> phi,<span class="keywordtype">double</span> &amp;dfi_dphi,<span class="keywordtype">bool</span> onFildLine=<span class="keyword">false</span>) <span class="keyword">const</span>;
<a name="l02443"></a>02443   <span class="keywordtype">double</span> fi(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCrd,<span class="keywordtype">double</span> &amp;dfi_dphi,<span class="keywordtype">bool</span> onFildLine=<span class="keyword">false</span>) <span class="keyword">const</span>;
<a name="l02445"></a>02445   <span class="keywordtype">double</span> fi(<span class="keywordtype">double</span> s,<span class="keywordtype">double</span> costheta,<span class="keywordtype">double</span> sintheta,<span class="keywordtype">double</span> cosNpPhi,<span class="keywordtype">double</span> snNpPhi,
<a name="l02446"></a>02446     <span class="keywordtype">double</span> phi,<span class="keywordtype">double</span> &amp;dfi_dphi,<span class="keywordtype">bool</span> onFildLine=<span class="keyword">false</span>) <span class="keyword">const</span>;
<a name="l02449"></a>02449   <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c">fileFormat</a> getfileformat(<span class="keyword">const</span> <span class="keywordtype">char</span> * fullname,<span class="keyword">const</span> <span class="keywordtype">char</span> *nam,<span class="keywordtype">long</span> fPostn) <span class="keyword">const</span>;
<a name="l02450"></a>02450 <span class="keyword">protected</span>:
<a name="l02453"></a>02453   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#04d7e86b811bab702d35da7dc1bd9c68" title="helper function for CStconfig::load()">loadfile</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> * filename,<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c">fileFormat</a> t, <span class="keywordtype">long</span> fPostn=0);
<a name="l02454"></a>02454 <span class="keyword">private</span>:
<a name="l02457"></a>02457   <span class="keywordtype">bool</span> loadascii(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename,<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c">fileFormat</a> fmt, <span class="keywordtype">long</span> fPostn=0);
<a name="l02460"></a>02460   <span class="keywordtype">bool</span> writeascii(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename) <span class="keyword">const</span>;
<a name="l02461"></a>02461 
<a name="l02462"></a>02462   <span class="keywordtype">bool</span> writeBoozerCoord(<span class="keyword">const</span> <span class="keywordtype">void</span> *mcdb, <span class="keywordtype">int</span> magneticgeometryrunlogid, <span class="keywordtype">int</span> Nsmax,<span class="keywordtype">bool</span> magAxis) <span class="keyword">const</span>;
<a name="l02463"></a>02463 
<a name="l02468"></a>02468   <span class="keywordtype">bool</span> loadwout (<span class="keyword">const</span> <span class="keywordtype">char</span> * filename);
<a name="l02472"></a>02472   <span class="keywordtype">bool</span> loadvmec (<span class="keyword">const</span> <span class="keywordtype">char</span> * filename,<span class="keywordtype">long</span> fPostn=0);
<a name="l02473"></a>02473   <span class="keywordtype">bool</span> loadnemec(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename,<span class="keywordtype">long</span> fPostn=0);
<a name="l02477"></a>02477 <span class="preprocessor">#ifdef NETCDF</span>
<a name="l02478"></a>02478 <span class="preprocessor"></span>  <span class="keywordtype">bool</span> loadvmecnetcdf(<span class="keyword">const</span> <span class="keywordtype">char</span> * filename,<span class="keywordtype">long</span> fPostn=0);
<a name="l02479"></a>02479 <span class="preprocessor">#endif</span>
<a name="l02483"></a>02483 <span class="preprocessor">  bool loadlhd (const char * filename);</span>
<a name="l02502"></a>02502 <span class="preprocessor"></span>
<a name="l02510"></a>02510 <span class="preprocessor"></span>
<a name="l02517"></a>02517 <span class="preprocessor"></span>
<a name="l02520"></a>02520 <span class="preprocessor"></span>
<a name="l02525"></a>02525 <span class="preprocessor"></span>
<a name="l02529"></a>02529 <span class="preprocessor"></span>
<a name="l02530"></a>02530 <span class="preprocessor"></span>  <span class="keywordtype">bool</span> loadEfit_p(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>, <span class="keywordtype">double</span> scaleBpol=0, <span class="keywordtype">double</span> scaleBtor=0,<span class="keywordtype">int</span> signBpol=0,<span class="keywordtype">int</span> signBtor=0, 
<a name="l02531"></a>02531                   <span class="keywordtype">int</span> signQ=0, <span class="keywordtype">int</span> psiOverTwopi=0, <span class="keyword">const</span> <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> *mconf=0, <span class="keywordtype">long</span> fPostn=0);
<a name="l02532"></a>02532 <span class="keyword">public</span>:
<a name="l02540"></a><a class="code" href="classMConf_1_1CStconfig.html#f59a4415b55f2a22671597886a61ea6d">02540</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#f59a4415b55f2a22671597886a61ea6d" title="The method loads the G EQDSK file and transforms it to the tokamak-symmetry flux...">loadEfitAndScale</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>, <span class="keywordtype">double</span> scaleBpol=0, <span class="keywordtype">double</span> scaleBtor=0,<span class="keywordtype">int</span> signBpol=0,<span class="keywordtype">int</span> signBtor=0,<span class="keywordtype">int</span> signQ=0,<span class="keywordtype">int</span> psiOverTwopi=0) {
<a name="l02541"></a>02541     <span class="keywordflow">return</span> loadEfit_p(fname, scaleBpol,scaleBtor,signBpol,signBtor,signQ,psiOverTwopi);
<a name="l02542"></a>02542   }
<a name="l02545"></a>02545   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#272e43aec6b5ddb8c32851d844249a0f" title="The method creates the circular tokamak with the same R0, a, and iota as in the mconf...">loadTokamak</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> *mconf);
<a name="l02546"></a>02546 <span class="keyword">protected</span>:
<a name="l02550"></a><a class="code" href="classMConf_1_1CStconfig.html#afd868d361aa110904a47ea5fb23e3a0">02550</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#afd868d361aa110904a47ea5fb23e3a0" title="The method loads torbeam equilibria file.">loadTopfile</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>) {fname; <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1CStconfig.html#36af5bac69565649de012257e9a1f251" title="result of the last operation">mOK</a>=<span class="keyword">false</span>;}
<a name="l02552"></a>02552   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#3801bda9db3de15bd4d8f7ac5cb7b681" title="Adjust number of integration points and steps.">adjustNumbersForSimpson</a>(<span class="keywordtype">int</span> &amp;Npol, <span class="keywordtype">int</span> &amp;<a class="code" href="classMConf_1_1CStconfig.html#f4ad5065890c58b13d1ff22248996ef6" title="The method returns the number of toroidal harmonics.">Ntor</a>, <span class="keywordtype">double</span> &amp;dpol, <span class="keywordtype">double</span> &amp;dtor) <span class="keyword">const</span>;
<a name="l02554"></a>02554   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#620819aed9fcae29172c9caca330fcc1" title="The method calculates currents and dV/ds if needed.">calculateCurrents</a>(); 
<a name="l02556"></a>02556   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#944ee092f3306de1814e883cb3959c4d" title="The method calculates dV/ds and then Volume integrating Jacobian.">calculateVprime</a>();
<a name="l02557"></a>02557   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#87e51d95baadbd6b0b70a6457968eaa4">calculateFluxAverages1</a>(<span class="keywordtype">int</span> npol=180, <span class="keywordtype">int</span> ntor=200);
<a name="l02560"></a>02560   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#9d32eedba64cf530eb6e1ca86f8b15bd" title="The method tabulate arrays for finding Sij(s).">calculateSMatrixArrays</a>(<span class="keywordtype">int</span> npol=180, <span class="keywordtype">int</span> ntor=200);
<a name="l02562"></a>02562   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#285a552c687c2333ba2b30d76b0fad31" title="ajust Fourier coefficients and create radial meshes">ajustFourierCoeffMeshes</a>();
<a name="l02564"></a>02564   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#c91e6f7bc32029da99d384400e75e12f" title="The method adds surfaces near magnetic axis and calculates spline coefficients.">addSurfacesNearAxis</a>();
<a name="l02565"></a>02565   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#6ca9d97dd10ea544b75ab38674815a04">addSurfacesAfterLCMS</a>();
<a name="l02566"></a>02566   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#3efc2e3591ae0bd798fc94741f226276">createSplineCoeff</a>();
<a name="l02571"></a>02571   <span class="keywordtype">int</span>  <a class="code" href="classMConf_1_1CStconfig.html#8d43291624f1278b154416c744bc745a" title="The method searches nearest to s segment in array ms.">getSsegMN</a>(<span class="keywordtype">double</span> s, <span class="keywordtype">int</span> &amp;M, <span class="keywordtype">int</span> &amp;N) <span class="keyword">const</span>;
<a name="l02574"></a>02574   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#cd31e6fdee839bc750c8f08cab49aedd" title="The method returns the Volume inside surface s integrating Jacobian.">VolumeInt</a>(<span class="keywordtype">double</span> s) <span class="keyword">const</span>;              <span class="comment">//Volume(s), [m^3]</span>
<a name="l02576"></a>02576 <span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#cd31e6fdee839bc750c8f08cab49aedd" title="The method returns the Volume inside surface s integrating Jacobian.">VolumeInt</a>(<span class="keywordtype">double</span> s1, <span class="keywordtype">double</span> s2) <span class="keyword">const</span>;  <span class="comment">//Volume(s2)-Volume(s1)</span>
<a name="l02578"></a>02578 <span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#47d5443b0c816ac39bc51d34fe870734" title="The method creates array of vertexes of LCMS.">createLCMS</a>();
<a name="l02580"></a>02580   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#39ac1d3f6042ae37695b01c8d8f0e82b" title="The method calculates the sign of Jacobian and angle directions.">signOfJacobianAndAngles</a>();
<a name="l02582"></a>02582   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#d368293513a3a5096041810892447f6a" title="The method is used to create flux label based on normalized poloidal flux.">FluxPoloidal</a>(<span class="keywordtype">double</span> s1, <span class="keywordtype">double</span> s2) <span class="keyword">const</span>;
<a name="l02583"></a>02583 
<a name="l02585"></a>02585 
<a name="l02586"></a>02586 <span class="keyword">private</span>:
<a name="l02587"></a>02587   <span class="keywordtype">void</span> V2Btrans(<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;boozer, <span class="keywordtype">double</span> &amp;R, <span class="keywordtype">double</span> &amp;Z, <span class="keywordtype">double</span> &amp;p, <span class="keywordtype">double</span> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>);
<a name="l02588"></a>02588   <span class="keywordtype">void</span> V2Btrans(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;vmec, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;boozer, <span class="keywordtype">double</span> &amp;R, <span class="keywordtype">double</span> &amp;Z, <span class="keywordtype">double</span> &amp;p, <span class="keywordtype">double</span> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>, <span class="keywordtype">double</span> &amp;jv_jb);
<a name="l02589"></a>02589   <span class="keywordtype">void</span> FourierUsingBoozerGrid(<span class="keyword">const</span> CComplex &amp;ctm, <span class="keyword">const</span> CComplex &amp;cpn, 
<a name="l02590"></a>02590                 <span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;R, <span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;Z, 
<a name="l02591"></a>02591                 <span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;P, <span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>,                      
<a name="l02592"></a>02592                 <span class="keywordtype">double</span> &amp;Rmn,<span class="keywordtype">double</span> &amp;Zmn,<span class="keywordtype">double</span> &amp;Pmn,<span class="keywordtype">double</span> &amp;Bmn); 
<a name="l02593"></a>02593   <span class="keywordtype">void</span> FourierUsingVmecGrid(<span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n, <span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;Vector3d&gt;</a> &amp;booz, 
<a name="l02594"></a>02594                  <span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;R, <span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;Z, 
<a name="l02595"></a>02595                  <span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;P, <span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>,                      
<a name="l02596"></a>02596                  <span class="keywordtype">double</span> &amp;Rmn,<span class="keywordtype">double</span> &amp;Zmn,<span class="keywordtype">double</span> &amp;Pmn,<span class="keywordtype">double</span> &amp;Bmn); 
<a name="l02597"></a>02597   <span class="keywordtype">void</span> createSurfaceDataOnBoozerGrid(<span class="keywordtype">double</span> s, 
<a name="l02598"></a>02598                          <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;R, <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;Z, 
<a name="l02599"></a>02599                          <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;P, <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>); 
<a name="l02600"></a>02600   <span class="keywordtype">void</span> createSurfaceDataOnVmecGrid(<span class="keywordtype">double</span> s, <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;Vector3d&gt;</a> &amp;booz, 
<a name="l02601"></a>02601                          <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;R, <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;Z, 
<a name="l02602"></a>02602                          <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;P, <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;double&gt;</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>); 
<a name="l02603"></a>02603   <span class="keywordtype">void</span> calcBoozFourierMods(<span class="keywordtype">int</span> Ns, <span class="keywordtype">int</span> M, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> method);
<a name="l02604"></a>02604   <span class="keywordtype">void</span> calcBoozFourierModsExe(<a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> * objR, <span class="keywordtype">int</span> low, <span class="keywordtype">int</span> upper, <span class="keywordtype">bool</span> setup);
<a name="l02605"></a>02605 
<a name="l02606"></a>02606 
<a name="l02607"></a>02607   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> *NJacobian1L(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord);
<a name="l02608"></a>02608   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> *NJacobian1Q(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;magCoord);
<a name="l02609"></a>02609   <span class="keywordtype">void</span>      NJacobian2 (<span class="keywordtype">int</span> typeOfInterp);
<a name="l02611"></a>02611 
<a name="l02612"></a>02612 
<a name="l02613"></a>02613   <span class="comment">// Fourier coefficients</span>
<a name="l02619"></a>02619 <span class="comment"></span>  <span class="keywordtype">double</span>  Bmn(<span class="keywordtype">int</span> is, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n)<span class="keyword"> const </span>{<span class="keywordflow">return</span> mCOEF[(n+mN)*offsetN + m*offsetM + is*offsetS]*fabs(mBnorm); }
<a name="l02620"></a>02620 
<a name="l02621"></a><a class="code" href="CStconfig_8h.html#c824e79fc96b4fa1a0767e6555523752">02621</a> <span class="preprocessor">#define FC(Cmn,i)   double  Cmn(int is,int m,int n) const {return mCOEF[i+(n+mN)*offsetN + m*offsetM + is*offsetS];} \</span>
<a name="l02622"></a>02622 <span class="preprocessor">                    double&amp; Cmn(int is,int m,int n)  {return mCOEF.rw()[i+(n+mN)*offsetN + m*offsetM + is*offsetS];}</span>
<a name="l02623"></a>02623 <span class="preprocessor"></span>
<a name="l02624"></a><a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">02624</a> <span class="preprocessor">#define FC_d2(Cmn,i)   double  Cmn##_d2(int is,int m,int n) const {return mCOEF[i+(n+mN)*offsetN + m*offsetM + is*offsetS];} \</span>
<a name="l02625"></a>02625 <span class="preprocessor">                       double&amp; Cmn##_d2(int is,int m,int n)  {return mCOEF.rw()[i+(n+mN)*offsetN + m*offsetM + is*offsetS];}</span>
<a name="l02626"></a>02626 <span class="preprocessor"></span>
<a name="l02627"></a>02627   FC(bmn,0) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(bmn,1)
<a name="l02629"></a>02629   FC(Rmn,2) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(Rmn,3)
<a name="l02631"></a>02631   FC(Zmn,4) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(Zmn,5);
<a name="l02633"></a>02633   FC(Phimn,6) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(Phimn,7)
<a name="l02636"></a>02636   FC(lmn,8) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(lmn,9)
<a name="l02637"></a>02637   FC(gmn,10) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(gmn,11)
<a name="l02638"></a>02638   FC(bContraTheta_mn,12) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(bContraTheta_mn,13)
<a name="l02639"></a>02639   FC(bContraFi_mn,14)   <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(bContraFi_mn,15)
<a name="l02640"></a>02640 
<a name="l02641"></a>02641  <span class="comment">// VMEC additional fourier coefficients in asymmetrical mode  if vmecAsym is true</span>
<a name="l02642"></a>02642 
<a name="l02643"></a>02643   FC(bmns,16) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(bmns,17)
<a name="l02645"></a>02645   FC(Rmns,18) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(Rmns,19)
<a name="l02647"></a>02647   FC(Zmnc,20) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(Zmnc,21);
<a name="l02649"></a>02649   FC(Phimns,22) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(Phimns,23)
<a name="l02652"></a>02652   FC(lmnc,24) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(lmnc,25)
<a name="l02653"></a>02653   FC(gmns,26) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(gmns,27)
<a name="l02654"></a>02654   FC(bContraTheta_mns,28) <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(bContraTheta_mns,29)
<a name="l02655"></a>02655   FC(bContraFi_mns,30)    <a class="code" href="CStconfig_8h.html#5d9a8d770ac565c1da92743b4a3a963b">FC_d2</a>(bContraFi_mns,31)
<a name="l02656"></a>02656 
<a name="l02657"></a>02657 
<a name="l02658"></a>02658   <span class="keywordtype">void</span> calcVmecLgB(const Vector3d &amp;u, Vector3d * Bcontrav=0, <span class="keywordtype">bool</span> boozTrans=false);
<a name="l02659"></a>02659   <span class="keywordtype">double</span>  JacobianVmec(const Vector3d &amp;magCoord);
<a name="l02660"></a>02660   <span class="keywordtype">int</span> vmecErrorCode;
<a name="l02661"></a>02661   <span class="keywordtype">bool</span> useVmecLambda;
<a name="l02663"></a>02663 
<a name="l02664"></a>02664 
<a name="l02665"></a>02665   <span class="keywordtype">double</span> extrapolate0(<span class="keywordtype">double</span> u, const <span class="keywordtype">double</span> *x, const <span class="keywordtype">double</span> *y) const;
<a name="l02666"></a>02666   <span class="keywordtype">double</span> extrapolateLCMS(<span class="keywordtype">double</span> u, const <span class="keywordtype">double</span> *x, const <span class="keywordtype">double</span> *y,<span class="keywordtype">int</span> n,<span class="keywordtype">int</span> h=1) const;
<a name="l02667"></a>02667   <span class="comment">//double S_interp  (double s, const double *y, const double *y_d2) const;</span>
<a name="l02668"></a>02668   <span class="comment">//double S_interp_D(double s, const double *y, const double *y_d2) const;</span>
<a name="l02669"></a>02669   <span class="keywordtype">double</span> Linterp(const <span class="keywordtype">double</span> *y)  const;  <span class="comment">// Linear interpolation</span>
<a name="l02670"></a>02670   <span class="keywordtype">double</span> interp2(<span class="keywordtype">double</span> u, const CArray1d&lt;<span class="keywordtype">double</span>&gt; &amp;x, const CArray1d&lt;<span class="keywordtype">double</span>&gt; &amp;y) const;
<a name="l02671"></a>02671   <span class="keywordtype">double</span> interp1(<span class="keywordtype">double</span> u, const CArray1d&lt;<span class="keywordtype">double</span>&gt; &amp;x, const CArray1d&lt;<span class="keywordtype">double</span>&gt; &amp;y) const;
<a name="l02672"></a>02672 
<a name="l02674"></a>02674   struct splineCoeffs {
<a name="l02675"></a>02675     <span class="keywordtype">double</span> e2rcurr;    <span class="comment">//= 0.5/sqrt(s)</span>
<a name="l02676"></a>02676     <span class="keywordtype">double</span> eds01,ds0,ds0eds01; <span class="comment">// data for Linterp (linear interpolation)</span>
<a name="l02677"></a>02677     <span class="keywordtype">int</span> is0;                   <span class="comment">// current segment in ms[] or in msFull[]</span>
<a name="l02678"></a>02678     <span class="comment">// coeffs for spline follow</span>
<a name="l02679"></a>02679     <span class="keywordtype">double</span> eh;
<a name="l02680"></a>02680     <span class="keywordtype">double</span> a;
<a name="l02681"></a>02681     <span class="keywordtype">double</span> b;
<a name="l02682"></a>02682     <span class="keywordtype">double</span> c;
<a name="l02683"></a>02683     <span class="keywordtype">double</span> d;
<a name="l02684"></a>02684     <span class="keywordtype">double</span> c1;
<a name="l02685"></a>02685     <span class="keywordtype">double</span> d1;
<a name="l02686"></a>02686   };
<a name="l02687"></a>02687 
<a name="l02688"></a>02688   splineCoeffs halfMesh;
<a name="l02689"></a>02689   splineCoeffs fullMesh;
<a name="l02690"></a>02690 
<a name="l02692"></a>02692   <span class="keyword">class </span><a class="code" href="classMConf_1_1CStconfig.html#2de55c2b29fb1b50576f926e610aee2e">sumDat</a> { <span class="comment">// data to speed up summation in cyl2guess</span>
<a name="l02693"></a>02693   <span class="keyword">public</span>:
<a name="l02694"></a>02694     <span class="keywordtype">double</span> s;
<a name="l02695"></a>02695     <span class="keywordtype">double</span> fi;
<a name="l02696"></a>02696     <span class="keywordtype">double</span> csNp;
<a name="l02697"></a>02697     <span class="keywordtype">double</span> snNp;
<a name="l02698"></a>02698     <span class="keyword">const</span> <span class="keywordtype">double</span> * fCh;
<a name="l02699"></a>02699     <span class="keyword">const</span> <span class="keywordtype">double</span> * fCf;
<a name="l02700"></a>02700     <span class="keywordtype">int</span> M,N;
<a name="l02701"></a>02701     splineCoeffs halfMesh;
<a name="l02702"></a>02702     splineCoeffs fullMesh;
<a name="l02703"></a>02703     splineCoeffs * hMesh;
<a name="l02704"></a>02704     splineCoeffs * RZmesh;
<a name="l02705"></a>02705     <a class="code" href="classMConf_1_1CStconfig.html#2de55c2b29fb1b50576f926e610aee2e">sumDat</a>() { };
<a name="l02706"></a>02706     <a class="code" href="classMConf_1_1CStconfig.html#2de55c2b29fb1b50576f926e610aee2e">sumDat</a>(<a class="code" href="classMConf_1_1CStconfig.html#122d35601e255373ff9019be8c741013" title="The constructor creates an empty instance of CStconfig.">CStconfig</a> &amp;thiz, <span class="keywordtype">double</span> s, <span class="keywordtype">double</span> fi) {<span class="keyword">set</span>(thiz,s,fi); };
<a name="l02707"></a>02707     <span class="keywordtype">void</span> <span class="keyword">set</span>(<a class="code" href="classMConf_1_1CStconfig.html#122d35601e255373ff9019be8c741013" title="The constructor creates an empty instance of CStconfig.">CStconfig</a> &amp;thiz, <span class="keywordtype">double</span> s, <span class="keywordtype">double</span> fi) {
<a name="l02708"></a>02708       this-&gt;fi = fi;
<a name="l02709"></a>02709       <span class="keyword">set</span>(thiz, s);
<a name="l02710"></a>02710       csNp = ::cos(thiz.mNp*fi);
<a name="l02711"></a>02711       snNp = ::sin(thiz.mNp*fi);
<a name="l02712"></a>02712     }
<a name="l02713"></a>02713     <span class="keywordtype">void</span> <span class="keyword">set</span>(<a class="code" href="classMConf_1_1CStconfig.html#122d35601e255373ff9019be8c741013" title="The constructor creates an empty instance of CStconfig.">CStconfig</a> &amp;thiz, <span class="keywordtype">double</span> s) {
<a name="l02714"></a>02714       this-&gt;s = s;
<a name="l02715"></a>02715       thiz.getSsegMN(s, M, N); <span class="comment">// search nearest segment in array ms;</span>
<a name="l02716"></a>02716       halfMesh = thiz.halfMesh;
<a name="l02717"></a>02717       fullMesh = thiz.fullMesh;
<a name="l02718"></a>02718       fCh = thiz.mCOEF.constArray()+thiz.mN*thiz.offsetN+ halfMesh.is0*thiz.offsetS;
<a name="l02719"></a>02719       fCf = thiz.mCOEF.constArray()+thiz.mN*thiz.offsetN+ fullMesh.is0*thiz.offsetS;
<a name="l02720"></a>02720       hMesh  = &amp;halfMesh;
<a name="l02721"></a>02721       RZmesh = thiz.vmecCoordinates? &amp;fullMesh:&amp;halfMesh;
<a name="l02722"></a>02722    }
<a name="l02723"></a>02723   };
<a name="l02724"></a>02724 
<a name="l02726"></a>02726 <span class="comment">//arrays for flux surface averages</span>
<a name="l02727"></a>02727   <span class="keywordtype">int</span> mNsK;           
<a name="l02728"></a>02728   CArray1d&lt;double&gt; mreK;       
<a name="l02729"></a>02729   CArray1d&lt;double&gt; mBmin;      
<a name="l02730"></a>02730   CArray1d&lt;double&gt; mBmax;      
<a name="l02731"></a>02731   CArray1d&lt;double&gt; mFtrap;     
<a name="l02732"></a>02732   CArray1d&lt;double&gt; mBavrg;     
<a name="l02733"></a>02733   CArray1d&lt;double&gt; mB2avrg;    
<a name="l02734"></a>02734   CArray1d&lt;double&gt; mR2avrg;    
<a name="l02735"></a>02735   CArray1d&lt;double&gt; mB_2avrg;   
<a name="l02736"></a>02736   CArray1d&lt;double&gt; mR_2avrg;   
<a name="l02737"></a>02737   CArray1d&lt;double&gt; mGrads2B_2avrg;   
<a name="l02738"></a>02738   CArray1d&lt;double&gt; mNeoPolarztnPass;   
<a name="l02739"></a>02739   CArray1d&lt;double&gt; mNeoPolarztnTrap;   
<a name="l02740"></a>02740   CArray1d&lt;double&gt; mb12;    <span class="comment">// &lt;(1-b)^0.5&gt;  , array of length mNsK</span>
<a name="l02741"></a>02741   CArray1d&lt;double&gt; mb32;    <span class="comment">// &lt;(1-b)^1.5&gt;  , array of length mNsK</span>
<a name="l02742"></a>02742 
<a name="l02743"></a>02743   <span class="keywordtype">double</span> mBminGlobal;           
<a name="l02744"></a>02744   <span class="keywordtype">double</span> mBmaxGlobal;           
<a name="l02745"></a>02745 
<a name="l02746"></a>02746   <span class="keywordtype">int</span> mNxK;           <span class="comment">// must be odd!!</span>
<a name="l02747"></a>02747   CArray1d&lt;double&gt; mxtr;   <span class="comment">// = x[i] for trapped particles fraction calculation,array[mNxK]</span>
<a name="l02748"></a>02748   CArray1d&lt;double&gt; mpavr2; <span class="comment">// = (&lt;sqrt(1-x[i]*b)&gt;)^2 for given surface, array[mNxK]</span>
<a name="l02749"></a>02749   CArray1d&lt;double&gt; mpavrI; <span class="comment">// = integral(from x to 1) (dx/&lt;sqrt(1-x[i]*b)&gt;) for given surface,array[mNxK]</span>
<a name="l02750"></a>02750   CArray1d&lt;double&gt; mpavrb2;<span class="comment">// = (&lt;b/sqrt(1-x[i]*b)&gt;)^-2 for given surface,array[mNxK], for Mishchenko</span>
<a name="l02751"></a>02751 <span class="preprocessor">#ifdef __INTEL_COMPILER</span>
<a name="l02752"></a>02752 <span class="preprocessor"></span><span class="comment">// These pragmas are to quiet icc about "virtual function override intended?"</span>
<a name="l02753"></a>02753 <span class="preprocessor">#pragma warning( push )</span>
<a name="l02754"></a>02754 <span class="preprocessor"></span><span class="preprocessor">#pragma warning( disable : 1125 )</span>
<a name="l02755"></a>02755 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l02756"></a>02756 <span class="preprocessor"></span>  CArray2d&lt;double&gt; mpavr_sx;  <span class="comment">// f(s,x)= square(&lt;sqrt(1-x*b(s))&gt;), array[mNsK][mNxK], see also CStconfig::pavrg</span>
<a name="l02757"></a>02757   CArray2d&lt;double&gt; mpavrI_sx; <span class="comment">// integral(from x to 1) dx/&lt;sqrt(1-x*b(s))&gt; , array[mNsK][mNxK]</span>
<a name="l02758"></a>02758   CArray2d&lt;double&gt; mpavrb_sx; <span class="comment">// f(s,x)= (&lt;b/sqrt(1-x*b(s))&gt;)^-2, array[mNsK][mNxK], see also CStconfig::roParInvAvrg, for Mishchenko</span>
<a name="l02759"></a>02759 <span class="preprocessor">#ifdef __INTEL_COMPILER</span>
<a name="l02760"></a>02760 <span class="preprocessor"></span><span class="preprocessor">#pragma warning( pop )</span>
<a name="l02761"></a>02761 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l02762"></a>02762 <span class="preprocessor"></span>
<a name="l02763"></a>02763 <span class="comment">//arrays for Smatrix</span>
<a name="l02764"></a>02764   CArray1d&lt;double&gt; msK;    
<a name="l02765"></a>02765   CArray1d&lt;double&gt; mS11;   
<a name="l02766"></a>02766   CArray1d&lt;double&gt; mS12;   
<a name="l02767"></a>02767   CArray1d&lt;double&gt; mS21;   
<a name="l02768"></a>02768   CArray1d&lt;double&gt; mS22;   
<a name="l02769"></a>02769 
<a name="l02770"></a>02770 Vector3d getGradsAverages(<span class="keywordtype">double</span> s,<span class="keywordtype">int</span> ithmax=180,<span class="keywordtype">int</span> ipmax=200);
<a name="l02771"></a>02771 
<a name="l02772"></a>02772 <span class="keywordtype">void</span> getFluxAverages(<span class="keywordtype">double</span> s,<span class="keywordtype">double</span> &amp;Ftrapped,
<a name="l02773"></a>02773                                   <span class="keywordtype">double</span> &amp;<a class="code" href="classMConf_1_1CStconfig.html#34b1dc8832f889b8ed9a240b1d02539e" title="The method returns the minimum value of magnetic field.">Bmin</a>,<span class="keywordtype">double</span> &amp;<a class="code" href="classMConf_1_1CStconfig.html#19b04e3914feba7e055c33c996d7662e" title="The method returns the maximum value of magnetic field.">Bmax</a>,
<a name="l02774"></a>02774                                   <span class="keywordtype">double</span> &amp;Bavr,
<a name="l02775"></a>02775                                   <span class="keywordtype">double</span> &amp;B2avr,  <span class="comment">// &lt;B^2&gt;</span>
<a name="l02776"></a>02776                                   CArray1d&lt;double&gt; &amp;mpavrI,
<a name="l02777"></a>02777                                   CArray1d&lt;double&gt; &amp;mpavr2,
<a name="l02778"></a>02778                                   <span class="keywordtype">int</span> itmax,<span class="keywordtype">int</span> ipmax);
<a name="l02779"></a>02779 <span class="comment">// for A.Mishchenko</span>
<a name="l02780"></a>02780 <span class="keywordtype">void</span> getFluxAverages1(<span class="keywordtype">double</span> s,
<a name="l02781"></a>02781                                   <span class="keywordtype">double</span> &amp;B_2avr, <span class="comment">// &lt;B^-2&gt;</span>
<a name="l02782"></a>02782                                   <span class="keywordtype">double</span> &amp;R2avr,  <span class="comment">// &lt;R^2&gt;</span>
<a name="l02783"></a>02783                                   <span class="keywordtype">double</span> &amp;R_2avr,  <span class="comment">// &lt;R^-2&gt;</span>
<a name="l02784"></a>02784                                   <span class="keywordtype">double</span> &amp;g2B_2avr, <span class="comment">// &lt;grads^2*B^-2&gt;</span>
<a name="l02785"></a>02785                                   <span class="keywordtype">double</span> &amp;b_12,   <span class="comment">// &lt;(1-b)^0.5&gt;</span>
<a name="l02786"></a>02786                                   <span class="keywordtype">double</span> &amp;b_32,   <span class="comment">// &lt;(1-b)^1.5&gt;</span>
<a name="l02787"></a>02787                                   <span class="keywordtype">double</span> &amp;neoPolarPass,   <span class="comment">// for Mishchenko</span>
<a name="l02788"></a>02788                                   <span class="keywordtype">double</span> &amp;neoPolarTrap,   <span class="comment">// for Mishchenko</span>
<a name="l02789"></a>02789                                   <span class="keywordtype">int</span> itmax,<span class="keywordtype">int</span> ipmax);
<a name="l02790"></a>02790 <span class="keyword">protected</span>:
<a name="l02791"></a><a class="code" href="classMConf_1_1CStconfig.html#3f822d76cc567aefc94e9a605b987998">02791</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#3f822d76cc567aefc94e9a605b987998">jacobianIsMixedProduct</a>;
<a name="l02792"></a><a class="code" href="classMConf_1_1CStconfig.html#1c4eef1782556c51e97f8c63731dced5">02792</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#1c4eef1782556c51e97f8c63731dced5">Averages1Ready</a>;
<a name="l02793"></a><a class="code" href="classMConf_1_1CStconfig.html#bb0118b40d95fd689bb8d78bb7222aa9">02793</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#bb0118b40d95fd689bb8d78bb7222aa9">ftrappedReady</a>;
<a name="l02794"></a><a class="code" href="classMConf_1_1CStconfig.html#352285493e341278c3744287eeff9f4f">02794</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#352285493e341278c3744287eeff9f4f">BminmaxReady</a>;
<a name="l02795"></a><a class="code" href="classMConf_1_1CStconfig.html#be4b7073818f7bca48c8f21163d6abb0">02795</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#be4b7073818f7bca48c8f21163d6abb0">SMatrixReady</a>;
<a name="l02796"></a><a class="code" href="classMConf_1_1CStconfig.html#a554cddde93c05efd79f6da00ff7c1a7">02796</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#a554cddde93c05efd79f6da00ff7c1a7">tokamakSymmetryFluxCoordinates</a>;
<a name="l02797"></a><a class="code" href="classMConf_1_1CStconfig.html#86e74dd3850d30428a0bcd171d96f938">02797</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#86e74dd3850d30428a0bcd171d96f938" title="VMEC Coordinates if true.">vmecCoordinates</a>;   
<a name="l02798"></a><a class="code" href="classMConf_1_1CStconfig.html#9676e0e4f693988b9520bda6cb78a354">02798</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#9676e0e4f693988b9520bda6cb78a354" title="VMEC additional fourier coefficients in asymmetrical mode if true.">vmecAsym</a>;          
<a name="l02799"></a><a class="code" href="classMConf_1_1CStconfig.html#229ce464e82f6f85759159e4e94d7664">02799</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#229ce464e82f6f85759159e4e94d7664" title="VMEC Coordinates from FP if true.">fpCoordinates</a>;     
<a name="l02800"></a><a class="code" href="classMConf_1_1CStconfig.html#d4c11a312434bc0739dfc9a56dc49410">02800</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#d4c11a312434bc0739dfc9a56dc49410">fpCoordinates2</a>;    
<a name="l02801"></a><a class="code" href="classMConf_1_1CStconfig.html#f484cb0f29d014419547366ba2df7c97">02801</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#f484cb0f29d014419547366ba2df7c97">fpCoordinates5</a>;    
<a name="l02802"></a><a class="code" href="classMConf_1_1CStconfig.html#7422b51cf012f899df5357102847b3e0">02802</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#7422b51cf012f899df5357102847b3e0" title="same as tokamakSymmetryFluxCoordinates">tokamakEQDSK</a>;      
<a name="l02803"></a><a class="code" href="classMConf_1_1CStconfig.html#312cbfcbbde8f37e3b1cc8c6f8135f6d">02803</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#312cbfcbbde8f37e3b1cc8c6f8135f6d" title="mN==0 &amp;amp;&amp;amp; mNp==1">tokamakConfig</a>;     
<a name="l02804"></a><a class="code" href="classMConf_1_1CStconfig.html#31d94b691f25ac543bf85f7c63cb2bfe">02804</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#31d94b691f25ac543bf85f7c63cb2bfe" title="signal to load() function that currents must be calculated">polCurrentNeeded</a>;  
<a name="l02805"></a><a class="code" href="classMConf_1_1CStconfig.html#11775d6db8add34b5f7713e2b85968bc">02805</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#11775d6db8add34b5f7713e2b85968bc" title="signal to load() function that currents must be calculated">torCurrentNeeded</a>;  
<a name="l02806"></a><a class="code" href="classMConf_1_1CStconfig.html#42b1e8c02cbd4a6f1c441bcd5652f82f">02806</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#42b1e8c02cbd4a6f1c441bcd5652f82f" title="signal to load() function that dV/ds must be calculated">vprimeNeeded</a>;      
<a name="l02807"></a>02807 
<a name="l02808"></a>02808   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#02fd73d861ef2e4aabb38c0c9ff82947" title="init everything before loading magnetic configuration">init</a>();
<a name="l02811"></a>02811   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#b701e7df7fd30573b16f005dd14d177a" title="the method is called when the configuration is reloaded to another coordinate system...">clearImportantFlags</a>();
<a name="l02813"></a>02813   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#74431875d7e371873a5d73fbf75f0729" title="Free all memory used.">freeConf</a>();
<a name="l02815"></a>02815   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#568c9f5df4e349dd0f64690a8d8a829b" title="write identification and comments into bc-file.">writeIdentificationComment</a>(FILE * fp) <span class="keyword">const</span>;
<a name="l02817"></a>02817   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#22b2eb1d195551c53ae834f2b6b7b49a" title="return the sign of B-normalization factor">getSignOfBnormFactor</a>() <span class="keyword">const</span>;
<a name="l02819"></a>02819   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#142981de52bfb11ce704897d68046bef" title="helper function for write(), see also C3dMesh::writeMeshbin();">writebin</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>, T szType, FILE *ff=NULL) <span class="keyword">const</span>;
<a name="l02821"></a>02821   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#8b87749dd24760340af0d4b066063ba4" title="helper function for write(), see also C3dMesh::writeMeshbin();">writebin4</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>, FILE *ff) <span class="keyword">const</span>;
<a name="l02823"></a>02823   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#3b10a14b6373d0efb372003ebc9a089e" title="helper function for write(), see also C3dMesh::writeMeshbin();">writebin8</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>, FILE *ff) <span class="keyword">const</span>;
<a name="l02825"></a>02825   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#545b78f59517889457d0b3da00bb8c5c" title="helper function for load(), see also C3dMesh::loadMeshbin();">loadbin</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>, T szType, FILE *ff=NULL);
<a name="l02827"></a>02827   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#5e94c6fda5be54a339573e49dde764e2" title="helper function for load(), see also C3dMesh::loadMeshbin();">loadbin4</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>, FILE *ff);
<a name="l02829"></a>02829   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#aa134e0759c633ba9fbefeba17d7cf9c" title="helper function for load(), see also C3dMesh::loadMeshbin();">loadbin8</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>, FILE *ff);
<a name="l02831"></a>02831   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#61a5644f254664b8f64af8d1e9499726" title="calculate spline coeffitients and add surfaces near axis.">initAfterLoad</a>(<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c">fileFormat</a> fmt=<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c605159e8a4c32319fd69b5d151369d93" title="file-format types, for internal use">UNDEFINED</a>);
<a name="l02833"></a>02833   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#e5d386b656a43e66e6a2f598f0888659" title="test whether point ri lies inside triangle r ">isInsideTriangle</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> *<a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>,<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;n, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;ri) <span class="keyword">const</span>;
<a name="l02834"></a>02834   <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#cc3f46f97a16cba5684c75358807b15a">isTriangleHitted</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> *<a class="code" href="classMConf_1_1CStconfig.html#13ca6399f56f45a51ca84ca24f8ad6f3" title="The method returns the effective radius r=a*sqrt(s), where a is the plasma minor...">r</a>,<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;rayR0) <span class="keyword">const</span>;
<a name="l02836"></a>02836   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classMConf_1_1CStconfig.html#cb34a2107aaebfb3fd0422cc2994c420" title="Returns a pointer to the last period in buf.">fname_ext</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *buf) <span class="keyword">const</span>;
<a name="l02838"></a>02838   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classMConf_1_1CStconfig.html#272830dbb5ee138923155cbfc87d9f64" title="returns a pointer to the filename, or null if name ends with &amp;#39;/&amp;#39;">fname_name</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name) <span class="keyword">const</span>;
<a name="l02846"></a>02846   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1CStconfig.html#4c1e0f8ea86e02edebfc2b794cd00161" title="The method tests whether the point lies inside LCMS.">cylIsInsideEx</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<span class="keyword">const</span> <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;Vector3d&gt;</a> &amp;vertex, <span class="keywordtype">double</span> dFi,<span class="keywordtype">double</span> * distance) <span class="keyword">const</span>;
<a name="l02847"></a>02847   
<a name="l02848"></a><a class="code" href="classMConf_1_1CStconfig.html#a1f1c00c6287328a49993fd235c1dc52">02848</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#a1f1c00c6287328a49993fd235c1dc52">Swap</a>  (T &amp;v1, T &amp;v2)<span class="keyword"> const </span>{T w = v1;  v1 = v2;  v2 = w;}
<a name="l02849"></a><a class="code" href="classMConf_1_1CStconfig.html#132573a4e70032d4713246b7dd33563d">02849</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1CStconfig.html#132573a4e70032d4713246b7dd33563d">SwapN</a> (T &amp;v1, T &amp;v2)<span class="keyword"> const </span>{T w = -v1;  v1 = -v2;  v2 = w;} <span class="comment">// swap and change sign</span>
<a name="l02850"></a><a class="code" href="classMConf_1_1CStconfig.html#1031d32bf9e9df4cf7ded61a50f240ce">02850</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; T <a class="code" href="classMConf_1_1CStconfig.html#1031d32bf9e9df4cf7ded61a50f240ce">square</a>(<span class="keyword">const</span> T x)<span class="keyword"> const  </span>{ <span class="keywordflow">return</span>( x*x );  }
<a name="l02851"></a><a class="code" href="classMConf_1_1CStconfig.html#53415a225775180d82c67251ba2eea4d">02851</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; T <a class="code" href="classMConf_1_1CStconfig.html#53415a225775180d82c67251ba2eea4d">cube</a>  (<span class="keyword">const</span> T x)<span class="keyword"> const  </span>{ <span class="keywordflow">return</span>( x*x*x );  }
<a name="l02852"></a><a class="code" href="classMConf_1_1CStconfig.html#48c51c4a7b5b5a544b767768c432614c">02852</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; T <a class="code" href="classMConf_1_1CStconfig.html#48c51c4a7b5b5a544b767768c432614c">mmin</a> ( T x,  T y)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (x&lt;y)?x:y; }
<a name="l02853"></a><a class="code" href="classMConf_1_1CStconfig.html#26fd5e4cacb6d325b0d9e0762c93de98">02853</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; T <a class="code" href="classMConf_1_1CStconfig.html#26fd5e4cacb6d325b0d9e0762c93de98">mmax</a> ( T x,  T y)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (x&gt;y)?x:y; }
<a name="l02854"></a><a class="code" href="classMConf_1_1CStconfig.html#4497b7e04000899fe34028733c66745d">02854</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; T <a class="code" href="classMConf_1_1CStconfig.html#4497b7e04000899fe34028733c66745d">abs</a>(T x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (x&gt;=0)?x:-x; }
<a name="l02855"></a><a class="code" href="classMConf_1_1CStconfig.html#9ecd02f2baba39b5dde721ee19ad69cb">02855</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; T <a class="code" href="classMConf_1_1CStconfig.html#9ecd02f2baba39b5dde721ee19ad69cb">setSign</a>(T target,T <a class="code" href="classMConf_1_1CStconfig.html#74361f7f3765536dd1f9ce37e8ddbcf0">sign</a>)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (sign&gt;=0)?(<a class="code" href="classMConf_1_1CStconfig.html#4497b7e04000899fe34028733c66745d">abs</a>(target)):(-<a class="code" href="classMConf_1_1CStconfig.html#4497b7e04000899fe34028733c66745d">abs</a>(target)); }
<a name="l02856"></a><a class="code" href="classMConf_1_1CStconfig.html#74361f7f3765536dd1f9ce37e8ddbcf0">02856</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#74361f7f3765536dd1f9ce37e8ddbcf0">sign</a>(T x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> x&gt;=0?1:-1; }
<a name="l02857"></a><a class="code" href="classMConf_1_1CStconfig.html#9077cd207b6300aab0912adaebacb738">02857</a>   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#9077cd207b6300aab0912adaebacb738">mantissa</a>(T x) { <span class="keywordflow">return</span>(x-floor(x)); }
<a name="l02858"></a>02858   <span class="comment">//*********************************************************************</span>
<a name="l02859"></a>02859   <span class="comment">// Heaviside function H = H(x)</span>
<a name="l02860"></a><a class="code" href="classMConf_1_1CStconfig.html#b101e9e31adeffbf9d7ab49160dce81f">02860</a>   <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#b101e9e31adeffbf9d7ab49160dce81f">Heaviside</a>(<span class="keywordtype">double</span> x) { <span class="keywordflow">return</span> x&gt;0?1:0; }
<a name="l02861"></a>02861   <span class="comment">//*********************************************************************</span>
<a name="l02862"></a>02862   <span class="comment">// "smooth" Heaviside function H = H(x)</span>
<a name="l02863"></a>02863   <span class="comment">// H(x)=(1+tanh(4*x/w))/2 = 1/(1+exp(-8*x/w))</span>
<a name="l02864"></a>02864   <span class="comment">// |smoothHeaviside(x)-H(x)|&lt;0.02 if |x|&gt;w/2</span>
<a name="l02865"></a>02865   <span class="comment">//    where H(x) is the Heaviside step function</span>
<a name="l02866"></a><a class="code" href="classMConf_1_1CStconfig.html#8b9373546e1e6f667da1c10b9f39120b">02866</a>   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#8b9373546e1e6f667da1c10b9f39120b">smoothHeaviside</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> w=1) { <span class="keywordflow">return</span> w==0?<a class="code" href="classMConf_1_1CStconfig.html#b101e9e31adeffbf9d7ab49160dce81f">Heaviside</a>(x):(1/(1+exp(-8*x/w))); }
<a name="l02867"></a>02867 
<a name="l02868"></a>02868 <span class="keyword">private</span>:
<a name="l02877"></a>02877   <span class="keywordtype">int</span> spline(<span class="keywordtype">int</span> n,<span class="keyword">const</span> <span class="keywordtype">double</span> x[],<span class="keyword">const</span> <span class="keywordtype">double</span> y[],<span class="keywordtype">double</span> b[],<span class="keywordtype">double</span> c[],<span class="keywordtype">double</span> d[],
<a name="l02878"></a>02878             <span class="keywordtype">int</span> end1=0,<span class="keywordtype">int</span> end2=0,<span class="keywordtype">double</span> slope1=0,<span class="keywordtype">double</span> slope2=0);
<a name="l02880"></a>02880   <span class="keywordtype">double</span> seval (<span class="keywordtype">int</span> n,<span class="keywordtype">double</span> u,<span class="keyword">const</span> <span class="keywordtype">double</span> x[],<span class="keyword">const</span> <span class="keywordtype">double</span> y[],
<a name="l02881"></a>02881                       <span class="keyword">const</span> <span class="keywordtype">double</span> b[],<span class="keyword">const</span> <span class="keywordtype">double</span> c[],<span class="keyword">const</span> <span class="keywordtype">double</span> d[],<span class="keywordtype">double</span> &amp;yp);
<a name="l02882"></a>02882 
<a name="l02889"></a>02889   <span class="keywordtype">int</span> splineNRC(<span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">double</span> *x, <span class="keyword">const</span> <span class="keywordtype">double</span> *y, <span class="keywordtype">double</span> *y2, <span class="keywordtype">double</span> yp1=1e30, <span class="keywordtype">double</span> ypn=1e30);
<a name="l02891"></a>02891   <span class="keywordtype">double</span> sevalNRC(<span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">double</span> *xa, <span class="keyword">const</span> <span class="keywordtype">double</span> *ya, <span class="keyword">const</span> <span class="keywordtype">double</span> *y2a, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> &amp;yp);
<a name="l02892"></a>02892   
<a name="l02893"></a>02893   <span class="keywordtype">int</span> SearchXindx(<span class="keywordtype">double</span> x, <span class="keywordtype">bool</span> halfMesh=<span class="keyword">true</span>) <span class="keyword">const</span>;
<a name="l02894"></a>02894 
<a name="l02895"></a>02895 <span class="keyword">private</span>:
<a name="l02897"></a>02897 
<a name="l02898"></a>02898 
<a name="l02900"></a>02900   <span class="keyword">class </span>amoebaFunc {
<a name="l02901"></a>02901     <span class="keywordtype">double</span> s_; 
<a name="l02902"></a>02902     <span class="keywordtype">int</span> sign_;
<a name="l02903"></a>02903     <span class="keywordtype">int</span> ncall;
<a name="l02904"></a>02904     <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> *mC;
<a name="l02905"></a>02905   <span class="keyword">public</span>:
<a name="l02906"></a>02906     amoebaFunc(<a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> *magConf, <span class="keywordtype">double</span> s, <span class="keywordtype">int</span> <a class="code" href="classMConf_1_1CStconfig.html#74361f7f3765536dd1f9ce37e8ddbcf0">sign</a>) { mC = magConf; s_=s; sign_=sign;ncall=0;}
<a name="l02908"></a>02908     <span class="keywordtype">double</span> operator() ( <span class="keyword">const</span> <span class="keywordtype">double</span> *x ) {
<a name="l02909"></a>02909       ncall++;
<a name="l02915"></a>02915       <span class="keywordflow">return</span> sign_*mC-&gt;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>(Vector3d(s_,x[0],x[1])); <span class="comment">// sign_*B(s,theta, phi)</span>
<a name="l02916"></a>02916     }
<a name="l02917"></a>02917     <span class="keywordtype">int</span> ncalls() {<span class="keywordflow">return</span> ncall;}
<a name="l02918"></a>02918   };
<a name="l02919"></a>02919   <span class="keywordtype">void</span>   amoeba(<span class="keywordtype">double</span> **p,<span class="keywordtype">double</span> *y,<span class="keywordtype">int</span> ndim,<span class="keywordtype">double</span> ftol,amoebaFunc &amp;func);
<a name="l02920"></a>02920   <span class="keywordtype">double</span> amotry(<span class="keywordtype">double</span> **p,<span class="keywordtype">double</span> *y,<span class="keywordtype">double</span> *psum,<span class="keywordtype">int</span> ndim,<span class="keywordtype">int</span> ihi,<span class="keywordtype">double</span> fac,<span class="keywordtype">double</span> *ptry,amoebaFunc &amp;func);
<a name="l02922"></a>02922 
<a name="l02923"></a>02923 <span class="keyword">private</span>: <span class="comment">// these are former public functions I disabled</span>
<a name="l02925"></a>02925 <span class="comment"></span>
<a name="l02926"></a>02926 
<a name="l02927"></a>02927 
<a name="l02928"></a>02928 
<a name="l02929"></a>02929 
<a name="l02930"></a>02930 
<a name="l02931"></a>02931 
<a name="l02932"></a>02932 
<a name="l02933"></a>02933   Vector3d  <a class="code" href="classMConf_1_1CStconfig.html#d7dea2a77452b811ef05afdeba787471" title="The method makes transformation from cartesian to magnetic coordinates.">xyz2mag</a>(<span class="keyword">const</span> Vector3d &amp;xyz,<span class="keyword">const</span> Vector3d &amp;guess);
<a name="l02934"></a>02934   <span class="comment">// g00 :  dV/ds = |g00(s)*Np|</span>
<a name="l02935"></a>02935   <span class="keywordtype">double</span> g00   (<span class="keywordtype">double</span> s) <span class="keyword">const</span>;   
<a name="l02936"></a>02936   <span class="comment">// Following function returns 'true' if the point lies inside LCMS</span>
<a name="l02937"></a>02937   <span class="keywordtype">bool</span>  xyzIsInside1(Vector3d &amp;xyz) <span class="keyword">const</span>;
<a name="l02938"></a>02938   <span class="keywordtype">bool</span>  cylIsInside1(Vector3d &amp;cyl) <span class="keyword">const</span>;
<a name="l02940"></a>02940 
<a name="l02976"></a>02976   <span class="comment">// Gamma_v defined by eq.(28)</span>
<a name="l02977"></a>02977 };
<a name="l02978"></a>02978 
<a name="l02979"></a>02979 <span class="preprocessor">#ifdef _MSC_VER</span>
<a name="l02980"></a>02980 <span class="preprocessor"></span><span class="preprocessor">#pragma warning( pop )</span>
<a name="l02981"></a>02981 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l02982"></a>02982 <span class="preprocessor"></span>
<a name="l02983"></a>02983 };   <span class="comment">//namespace MConf</span>
<a name="l02984"></a>02984 
<a name="l02985"></a>02985 <span class="preprocessor">#endif //MC_CSTCONFIG_H</span>
<a name="l02986"></a>02986 <span class="preprocessor"></span>
<a name="l02987"></a>02987 
<a name="l02988"></a>02988 <span class="comment">/* usage example</span>
<a name="l02989"></a>02989 <span class="comment"></span>
<a name="l02990"></a>02990 <span class="comment">#include "CStconfig.h"</span>
<a name="l02991"></a>02991 <span class="comment"></span>
<a name="l02992"></a>02992 <span class="comment">int main() {</span>
<a name="l02993"></a>02993 <span class="comment">  CStconfig mConf;</span>
<a name="l02994"></a>02994 <span class="comment">  mConf.load ("w7x-sc1.bin4");      //load configuration with Boozer coordinates</span>
<a name="l02995"></a>02995 <span class="comment">  mConf.truncate(1e-5);             //truncate spectrum</span>
<a name="l02996"></a>02996 <span class="comment">  mConf.setAccuracy(epsA);          //set accuracy of transformation</span>
<a name="l02997"></a>02997 <span class="comment">  mConf.setB0(2.5);                 //set minimum value of B on magn. axis</span>
<a name="l02998"></a>02998 <span class="comment"></span>
<a name="l02999"></a>02999 <span class="comment">  Vector3d cyl(6,1*degree,0.5);     // R=6,fi=1deg,Z=0.5</span>
<a name="l03000"></a>03000 <span class="comment">  //  coordinate transformation form cylindrical to magnetic coordinates</span>
<a name="l03001"></a>03001 <span class="comment">  Vector3d boozer = mConf.cyl2mag(cyl); // boozer is (s,theta,phi)</span>
<a name="l03002"></a>03002 <span class="comment">  Vector3d B = mConf.getBcyl(cyl);         // B-vector in cylindrical coord.</span>
<a name="l03003"></a>03003 <span class="comment"></span>
<a name="l03004"></a>03004 <span class="comment">  double s = boozer[0];               // norm. toroidal flux</span>
<a name="l03005"></a>03005 <span class="comment">  double reff = mConf.r(s);           // effective r</span>
<a name="l03006"></a>03006 <span class="comment">}</span>
<a name="l03007"></a>03007 <span class="comment"></span>
<a name="l03008"></a>03008 <span class="comment">*/</span>
</pre></div></div>
    <p><a class="anchor" name="BottomOfPage"></a></p>
    <div class="no-print" align="right">
      <table border="0">
        <tr>
        <td>[ <a class="el" href="#TopOfPage">top</a> ]</td>
        <td>[ <a class="el" href="javascript:history.back(-1);"><b>back</b></a> ]</td> 
        </tr>
      </table>
    </div>
    <hr class="separator">
    <div class="ippAddress" align="right">
      <table border="0">
        <tr>
          <td class="ippAddress">13 Oct 2021 &nbsp;&nbsp;&nbsp;&nbsp;</td>
          <td class="ippAddress">
            <a href="http://www.ipp.mpg.de"><img src="IPP.png" alt="www.ipp.mpg.de" border="0"></a>
          </td>
          <td class="ippAddress">
            <!-- Copyright &copy; 2005-2008<br> --> 
            Max-Planck-Institut<br>f&uuml;r Plasmaphysik
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>
</body>
</html>
