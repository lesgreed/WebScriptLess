<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>MConf: cpp2for.cpp</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <meta name="author" content="Yuriy Turkin">
  <meta name="keywords" content="stellarator, w7x, W7-X, W7-X software">
  <meta name="description" content="W7-X Software">
  <link href="myCss.css" rel="stylesheet" type="text/css">
  <link href="tabs.css" rel="stylesheet" type="text/css" >
</head>
<body>
  <div class="centerAll" id="TopOfPage">
    <div class="bodyForAll">
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>cpp2for.cpp</h1>This is an example of how to write interface C-function in order to call C++ function from within FORTRAN programs.<p>
<div class="fragment"><pre class="fragment"><span class="comment">//*********************************************************************</span>
<span class="comment">// Fortran Interface to C++</span>
<span class="comment">/*</span>
<span class="comment">!USAGE:</span>
<span class="comment">  implicit none</span>
<span class="comment">  character (len=80) fname</span>
<span class="comment">  real(8) cyl(3),boozer(3),Bfield(3),epsTrunc/1d-6/,epsA/1d-4/,ficyl/0/</span>
<span class="comment">  integer(8) mcObj/0/         ! this variable holds the address of C++ object</span>
<span class="comment">  integer(4) False/0/,mcload</span>
<span class="comment"></span>
<span class="comment">  EXTERNAL mcload,mcsetB0,mctruncate,mcsetAccuracy,mcsetB0,mccyl2mag</span>
<span class="comment">! Here EXTERNAL operator is used, but for true FORTRAN-90 program you have to</span>
<span class="comment">! use FORTRAN-statement INTERFACE for defining prototypes of subroutine called:</span>
<span class="comment">!</span>
<span class="comment">!   INTERFACE</span>
<span class="comment">!    INTEGER(4) FUNCTION MCLOAD(mcObj,fname)</span>
<span class="comment">!     INTEGER(8) mcObj</span>
<span class="comment">!     CHARACTER *(*) fname</span>
<span class="comment">!    END FUNCTION MCLOAD</span>
<span class="comment">!   END INTERFACE</span>
<span class="comment"></span>
<span class="comment">  fname = 'w7x-sc1.bc'</span>
<span class="comment">  if  (mcload (mcObj,fname)==False ) stop     ! stop if error</span>
<span class="comment"></span>
<span class="comment">  call mctruncate   (mcObj,epsTrunc)          ! truncate spectrum</span>
<span class="comment">  call mcsetAccuracy(mcObj,epsA)              ! set accuracy of coordinate transformation</span>
<span class="comment">  call mcsetB0      (mcObj,2.5d0,ficyl)       ! scale B, set value of B on magn. axis</span>
<span class="comment"></span>
<span class="comment">  cyl = (/6d0,1d-2,5d-1/)</span>
<span class="comment"></span>
<span class="comment">  call mccyl2mag (mcObj,cyl,boozer,Bfield) ! coordinate transformation cyl -&gt; boozer</span>
<span class="comment"></span>
<span class="comment">  if(boozer(1) &gt; 1)  print '(/a)', 'Point outside plasma!'</span>
<span class="comment">  print '(/a,3f14.6 )','cyl   = (r, fi, z)  =',cyl</span>
<span class="comment">  print '( a,3f14.6 )','boozer=(s,theta,phi)=',boozer</span>
<span class="comment">  print '( a,3f14.6/)','Bfield=(Br, Bfi, Bz)=',Bfield</span>
<span class="comment"></span>
<span class="comment">  call mcfree(mcObj)                          ! destroy C++ object and free memory</span>
<span class="comment">  end</span>
<span class="comment">*/</span>
<span class="comment">//</span>
<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;time.h&gt;</span>

<span class="preprocessor">#include "../include/C3dMesh.h"</span>
<span class="preprocessor">#include "../include/CPfunction.h"</span>

<span class="preprocessor">#include &lt;iostream&gt;</span>

<span class="keyword">using</span> <a name="_a0"></a><a class="code" href="classMConf_1_1C3dMesh.html" title="This class tabulates magnetic field, flux surface label, grad(s) on a 3d-mesh in...">MConf::C3dMesh</a>;
<span class="keyword">using</span> <a name="_a1"></a><a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">MConf::CStconfig</a>;
<span class="keyword">using</span> <a name="_a2"></a><a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">MConf::Vector3d</a>;
<span class="keyword">using</span> <a name="_a3"></a><a class="code" href="classMConf_1_1CProfile.html" title="This class provides the plasma profile which can be set by set of points or parameterized...">MConf::CProfile</a>;
<span class="keyword">using</span> <a name="_a4"></a><a class="code" href="classMConf_1_1CPfunction.html" title="This class provides the function for creating a plasma profile.">MConf::CPfunction</a>;

<span class="keyword">using namespace </span>std;

<span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">double</span>   <a name="a5"></a><a class="code" href="cpp2for_8cpp.html#43016d873124d39034edb8cd164794db">pi</a> = 3.14159265358979323846;
<span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">double</span>   <a name="a6"></a><a class="code" href="cpp2for_8cpp.html#2675edd2140472f1d48c6178d4052018">degree</a> = <a class="code" href="cpp2for_8cpp.html#43016d873124d39034edb8cd164794db">pi</a>/180;

<span class="preprocessor">#undef True</span>
<span class="preprocessor"></span><span class="preprocessor">#undef False</span>
<span class="preprocessor"></span>
<span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a name="a7"></a><a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>(1);
<span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a name="a8"></a><a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>(0);

<span class="comment">// see option -nomixed_str_len_arg for Intel Fortran </span>
<span class="comment">// or /iface:nomixed_str_len_arg  for Visual Fortran 6</span>
<span class="preprocessor">#define NOMIXED_STR_LEN_ARG</span>
<span class="preprocessor"></span>
<span class="comment">//_WIN32 is defined for Win32 and Win64 applications. Always defined.</span>
<span class="preprocessor">#if defined( _WIN32 )</span>
<span class="preprocessor"></span><span class="preprocessor">    #ifdef _MSC_VER</span>
<span class="preprocessor"></span> <span class="comment">// for Visual Studio 2012 and Intel Fortran 2013 with default calling convention</span>
   <span class="comment">//   #if _MSC_VER &gt; 1600      // Visual Studio 2012 or higher</span>
<span class="preprocessor">      #if _MSC_VER &gt; 1400      // Visual Studio 2008 or higher</span>
<span class="preprocessor"></span><span class="preprocessor">        #define STDCALL </span>
<span class="preprocessor"></span><span class="preprocessor">      #elif _MSC_VER == 1200</span>
<span class="preprocessor"></span>        <span class="comment">// for Visual Fortran 6 with default calling convention</span>
        <span class="comment">// and /iface:nomixed_str_len_arg</span>
<span class="preprocessor">        #define STDCALL __stdcall </span>
<span class="preprocessor"></span><span class="preprocessor">      #else</span>
<span class="preprocessor"></span><span class="preprocessor">        #define STDCALL __stdcall </span>
<span class="preprocessor"></span><span class="preprocessor">      #endif</span>
<span class="preprocessor"></span><span class="preprocessor">    #else</span>
<span class="preprocessor"></span><span class="preprocessor">      #define STDCALL  </span>
<span class="preprocessor"></span><span class="preprocessor">    #endif</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#if defined( _WIN32 )</span>
<span class="preprocessor"></span><span class="preprocessor">    #define WINDLLEXPORT  </span>
<span class="preprocessor"></span><span class="preprocessor">    #ifdef _MT</span>
<span class="preprocessor"></span><span class="preprocessor">      #pragma message( "===&gt; Multithread library" )</span>
<span class="preprocessor"></span>      <span class="keyword">static</span> <span class="keywordtype">char</span>* libDescription = <span class="stringliteral">"Multithread MConf library"</span>;
<span class="preprocessor">    #else</span>
<span class="preprocessor"></span><span class="preprocessor">      #pragma message( "===&gt; Singlethread library")</span>
<span class="preprocessor"></span>     <span class="keyword">static</span> <span class="keywordtype">char</span>* libDescription = <span class="stringliteral">"Singlethread MConf library"</span>;
<span class="preprocessor">    #endif</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>

<span class="comment">// Note: for Intel Fortran 2013</span>
<span class="comment">// if Fortran program under Windows uses BIND(C), like in the the following declaration </span>
<span class="comment">//    INTEGER(4) FUNCTION mcload(mconf,name) BIND(C)</span>
<span class="comment">// then all function names must be lowcase names</span>

<span class="preprocessor">#if (defined( __unix__ ) || (defined(linux)) || defined(__sun)|| defined(__APPLE__) )</span>
<span class="preprocessor"></span><span class="preprocessor">  #define WINDLLEXPORT  </span>
<span class="preprocessor"></span><span class="preprocessor">  #define STDCALL</span>
<span class="preprocessor"></span><span class="preprocessor">  #define PROFILEFUNCTION  profilefunction_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCLOAD        mcload_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCISVMEC      mcisvmec_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCISTOKPEST   mcistokpest_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCLOADVMEC    mcloadvmec_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCLOADVMECNETCDF    mcloadvmecnetcdf_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCLOADLHD     mcloadlhd_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCLOADEFIT    mcloadefit_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCISOK        mcisok_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCISMESHOK    mcismeshok_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCFREE        mcfree_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCCLONE       mcclone_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCTRUNCATE    mctruncate_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCSETACCURACY mcsetaccuracy_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCSETMINB0    mcsetminb0_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCSETB0       mcsetb0_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETB0       mcgetb0_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCSETB00      mcsetb00_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETB00      mcgetb00_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCSCALEB      mcscaleb_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCSETICOIL    mcseticoil_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCSETBDIRECTION mcsetbdirection_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETBDIRECTION mcgetbdirection_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCRESTOREBDIRECTION mcrestorebdirection_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCGETCOVAGRADB  mcgetcovagradb_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETGRADB      mcgetgradb_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETBANDGRADIENTS  mcgetbandgradients_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETBCURLBGRADFCYL     mcgetbcurlbgradfcyl_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCCYL2MAG     mccyl2mag_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCCYL2MAG2    mccyl2mag2_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCXYZ2MAG2    mcxyz2mag2_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCXYZ2S       mcxyz2s_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCCYL2S       mccyl2s_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCREFF        mcreff_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCTORFLUX     mctorflux_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCVPRIME      mcvprime_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCIOTA        mciota_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCIOTAPRIME   mciotaprime_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCVOLUME      mcvolume_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCFTRAPPED    mcftrapped_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCBAVRG       mcbavrg_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCB2AVRG      mcb2avrg_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCR2AVRG      mcr2avrg_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCB_2AVRG     mcb_2avrg_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGRADS2B_2AVRG     mcgrads2b_2avrg_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCR_2AVRG     mcr_2avrg_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCDB12AVRG    mcdb12avrg_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCDB32AVRG    mcdb32avrg_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCBDB12AVRG   mcbdb12avrg_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCNEOPOLARIZATION   mcneopolarization_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCNEOPOLARIZATIONPASS   mcneopolarizationpass_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCNEOPOLARIZATIONTRAP   mcneopolarizationtrap_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCRHPOTENCIAL   mcrhpotencial_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCIPOL         mcipol_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCITOR         mcitor_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCB            mcb_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCJACOBIAN     mcjacobian_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCBANDJACOBIAN     mcbandjacobian_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCROPARINVAVRG mcroparinvavrg_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCBPHI        mcbphi_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCBMIN        mcbmin_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCBMAX        mcbmax_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCPAVRG       mcpavrg_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCINTINVPAVRG mcintinvpavrg_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCTORFLUX2POLFLUX  mctorflux2polflux_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCJACOBIANB2  mcjacobianb2_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCRMN          mcrmn_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCZMN          mczmn_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCFMN          mcfmn_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCBMN          mcbmn_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCBOOZERBMN    mcboozerbmn_</span>
<span class="preprocessor"></span>     

<span class="preprocessor">  #define MCAVERAGECROSSSECTIONAREA  mcaveragecrosssectionarea_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCR0          mcr0_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCRMINOR      mcrminor_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCNPERIODS    mcnperiods_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCCURRENTSIGNTOINCREASEIOTA mccurrentsigntoincreaseiota_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCTRACELCMS     mctracelcms_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCCREATEBORDER  mccreateborder_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCISINSIDEBORDER mcisinsideborder_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCWRITE          mcwrite_</span>
<span class="preprocessor"></span>
<span class="comment">// mesh</span>
<span class="preprocessor">  #define MCM3DGETRAYENTRYPOINT  mcm3dgetrayentrypoint_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCCREATEMESH    mccreatemesh_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCCREATEMESHUSINGSYMMETRY    mccreatemeshusingsymmetry_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCWRITEMESH     mcwritemesh_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCM3DCYL2S      mcm3dcyl2s_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCM3DXYZ2S      mcm3dxyz2s_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCM3DGETDBCYL   mcm3dgetdbcyl_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCM3DGETDBXYZ   mcm3dgetdbxyz_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCM3DGETGRADS   mcm3dgetgrads_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCM3DGETGRADSXYZ mcm3dgetgradsxyz_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETGRADSXYZ    mcgetgradsxyz_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCXYZISINSIDE   mcxyzisinside_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCCYLISINSIDE   mccylisinside_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCGETALLXYZ     mcgetallxyz_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCM3DGETALLXYZ  mcm3dgetallxyz_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCM3DGETALLCYL  mcm3dgetallcyl_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCM3DGETSBXYZ   mcm3dgetsbxyz_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCM3DGETSBCYL   mcm3dgetsbcyl_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETSBCYL      mcgetsbcyl_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETSBXYZ      mcgetsbxyz_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETBCYL       mcgetbcyl_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETDBCYL      mcgetdbcyl_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCM3DSETSMAX    mcm3dsetsmax_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCM3DGETSMAX    mcm3dgetsmax_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETBMINMAX    mcgetbminmax_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETBMINMAXGLOBAL mcgetbminmaxglobal_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCRAXIS         mcraxis_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETEXTENT       mcgetextent_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETEXTENTLCMS   mcgetextentlcms_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCMIXCOORD2CYL    mcmixcoord2cyl_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCMIXCOORD2XYZ    mcmixcoord2xyz_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCMAG2CYL         mcmag2cyl_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCMAG2XYZ         mcmag2xyz_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCPEST2VMEC       mcpest2vmec_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCVMEC2PEST       mcvmec2pest_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCBOOZER2VMEC     mcboozer2vmec_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCVMEC2BOOZER     mcvmec2boozer_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCCOORDFIELDLINE  mccoordfieldline_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCSAVEREDUCED     mcsavereduced_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETGFACTORS     mcgetgfactors_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETEPSEFF       mcgetepseff_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCEPSEFFPARAMS    mcepseffparams_</span>
<span class="preprocessor"></span>
<span class="preprocessor">  #define MCSFLCOORDONBLINEATTHETA mcsflcoordonblineattheta_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCSFLCONTRABASIS    mcsflcontrabasis_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCBOOZERCONTRABASIS mcboozercontrabasis_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCPRESSUREPRIME mcpressureprime_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCPRESSURE      mcpressure_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define SETARGV SETARGV_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCGETMAGCOORDATB mcgetmagcoordatb_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCJINVARIANT     mcjinvariant_</span>
<span class="preprocessor"></span><span class="preprocessor">  #define MCUSEMIXEDPRODUCTFORJACOBIAN mcusemixedproductforjacobian_</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>

<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">static</span> <span class="keyword">inline</span> T <a name="a9"></a><a class="code" href="cpp2for_8cpp.html#48010e075e703438fab9943f5f6a576c">mmin</a> (T x, T y) { <span class="keywordflow">return</span> (x&lt;y)?x:y; }
<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keyword">static</span> <span class="keyword">inline</span> T <a name="a10"></a><a class="code" href="cpp2for_8cpp.html#42af2ca7ecd9ddfa9c9a609023ee50bb">mmax</a> (T x, T y) { <span class="keywordflow">return</span> (x&gt;y)?x:y; }

<span class="keyword">static</span> <span class="keywordtype">void</span> <a name="a11"></a><a class="code" href="cpp2for_8cpp.html#643dc94e8c4da8dd5e46205950d9aba4">strtrim</a>(<span class="keywordtype">char</span> *f)  <span class="comment">// remove initial and trailing blanks</span>
{
  <span class="keywordtype">char</span> *p,*p2;
  <span class="keywordtype">int</span> i=strlen(f);
  <span class="keywordflow">for</span>(p=f; p!=f+i-1; p++) <span class="keywordflow">if</span>(*p!=<span class="charliteral">' '</span>) <span class="keywordflow">break</span>;
  i=strlen(p);
  <span class="keywordflow">for</span>(p2=p+i-1; p2!=p; p2--) <span class="keywordflow">if</span>(*p2!=<span class="charliteral">' '</span>) {*(p2+1)=0; <span class="keywordflow">break</span>; }
  memmove(f,p,p2-p+2);
};

<span class="comment">// remove initial and trailing blanks from FORTRAN string: character(i) fname</span>
<span class="comment">// size of dest must be large than fname</span>
<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="cpp2for_8cpp.html#643dc94e8c4da8dd5e46205950d9aba4">strtrim</a>(<span class="keywordtype">char</span> *dest, <span class="keywordtype">char</span> *fname, <span class="keywordtype">int</span> i)
{
  <span class="keywordtype">char</span> *p;
  <span class="comment">// remove initial blanks</span>
  <span class="keywordflow">for</span>(p=fname; p!=fname+i-1; p++) <span class="keywordflow">if</span>(*p!=<span class="charliteral">' '</span>) <span class="keywordflow">break</span>;
  i -= p-fname;
  strncpy(dest,p,i);
  dest[i]=0;
  <span class="comment">// remove trailing blanks</span>
  <span class="keywordflow">for</span>(p=dest+i-1; p!=dest; p--) <span class="keywordflow">if</span>(*p!=<span class="charliteral">' '</span>) {*(p+1)=0; <span class="keywordflow">break</span>; }
}


<span class="comment">//*********************************************************************</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a name="a12"></a><a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a13"></a><a class="code" href="cpp2for_8cpp.html#ffe530b6074f5ef5e6d963742cc89c18">PROFILEFUNCTION</a>(<span class="keywordtype">double</span> *x,<span class="keywordtype">double</span> *g)
{
  CPfunction profile;
  <span class="keywordflow">return</span> profile.PF(*x,g);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// 'destructor'</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a14"></a><a class="code" href="cpp2for_8cpp.html#9ac26c2d2d51fec05301b62be1cf0c24">MCFREE</a>(C3dMesh **mConf)
{
  <span class="keywordflow">if</span> (*mConf) <span class="keyword">delete</span> (*mConf);
  *mConf=0;
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// clone object  C3dMesh</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> C3dMesh * STDCALL <a name="a15"></a><a class="code" href="cpp2for_8cpp.html#4533e1eb99845aa1ec1c678d31552adc">MCCLONE</a>(C3dMesh **mConf)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.clone();
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// create object  C3dMesh</span>
<span class="comment">// and load magnetic coordinate data file: *.bc; *.bc_old; *.bin4; *.bin8</span>
<span class="comment">// This function must be called before others.</span>
<span class="comment">// The first call must be made with *mConf==0, the following calls</span>
<span class="comment">//  will reload configuration into the same object</span>
<span class="comment">//</span>
<span class="keyword">static</span> <span class="keywordtype">int</span> <a name="a16"></a><a class="code" href="cpp2for_8cpp.html#60f11126bf7ce6cba586242c55aaa231">MC_load</a>(C3dMesh **mConf, <span class="keywordtype">char</span> * fname, <span class="keywordtype">int</span> i, CStconfig::fileFormat fmt)
{
  <span class="keywordtype">char</span> *fn = <span class="keyword">new</span> <span class="keywordtype">char</span>[i+2];
  <a class="code" href="cpp2for_8cpp.html#643dc94e8c4da8dd5e46205950d9aba4">strtrim</a>(fn,fname,i);
  <span class="keywordflow">if</span> (*mConf==0) *mConf = <span class="keyword">new</span> C3dMesh;   <span class="comment">// create object C3dMesh and return to caller the address</span>
  <span class="keywordtype">bool</span> ok = (*mConf)-&gt;load(fn,fmt);
  <span class="keywordflow">if</span>(!ok) {
    cerr &lt;&lt; <span class="stringliteral">"MCLOAD: Loading error, file:'"</span>&lt;&lt;fn&lt;&lt;<span class="stringliteral">"'\n"</span>;
    <span class="keyword">delete</span> (*mConf);
    *mConf = 0;      <span class="comment">// return NULL if errors</span>
  }
  <span class="keyword">delete</span> fn;
<span class="comment">//  (*mConf)-&gt;M3DpositionTestOff();</span>
  <span class="keywordflow">return</span> ok?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// create object  C3dMesh</span>
<span class="comment">// and load magnetic coordinate data file: *.bc; *.bc_old; *.bin4; *.bin8</span>
<span class="comment">// This function must be called before others.</span>
<span class="comment">// The first call must be made with *mConf==0, the following calls</span>
<span class="comment">//  will reload configuration into the same object</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a17"></a><a class="code" href="cpp2for_8cpp.html#768b0ad45e4920028731bc0b0866bdb8">MCLOAD</a>(C3dMesh **mConf, <span class="keywordtype">char</span> * fname, <span class="keywordtype">int</span> i)
{
  <span class="keywordflow">return</span> <a class="code" href="cpp2for_8cpp.html#60f11126bf7ce6cba586242c55aaa231">MC_load</a>(mConf, fname, i, CStconfig::UNDEFINED);
}

<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a18"></a><a class="code" href="cpp2for_8cpp.html#c7a0572b0de10e60eaafde1a7530fada">MCLOADVMEC</a>(C3dMesh **mConf, <span class="keywordtype">char</span> * fname, <span class="keywordtype">int</span> i)
{
  <span class="keywordflow">return</span> <a class="code" href="cpp2for_8cpp.html#60f11126bf7ce6cba586242c55aaa231">MC_load</a>(mConf, fname, i, CStconfig::VMEC);
}
<span class="preprocessor">#ifdef NETCDF</span>
<span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL MCLOADVMECNETCDF(C3dMesh **mConf, <span class="keywordtype">char</span> * fname, <span class="keywordtype">int</span> i)
{
  <span class="keywordflow">return</span> <a class="code" href="cpp2for_8cpp.html#60f11126bf7ce6cba586242c55aaa231">MC_load</a>(mConf, fname, i, CStconfig::VMECNETCDF);
}
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a19"></a><a class="code" href="cpp2for_8cpp.html#4ec6f0f9cc72374eea91adccfe686f7b">MCLOADLHD</a>(C3dMesh **mConf, <span class="keywordtype">char</span> * fname, <span class="keywordtype">int</span> i)
{
  <span class="keywordflow">return</span> <a class="code" href="cpp2for_8cpp.html#60f11126bf7ce6cba586242c55aaa231">MC_load</a>(mConf, fname, i, CStconfig::LHD);
}

<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a20"></a><a class="code" href="cpp2for_8cpp.html#cc8dee02ac7b6a11fc79b12cab033d00">MCLOADEFIT</a>(C3dMesh **mConf, <span class="keywordtype">char</span> * fname, <span class="keywordtype">int</span> i)
{
  <span class="keywordflow">return</span> <a class="code" href="cpp2for_8cpp.html#60f11126bf7ce6cba586242c55aaa231">MC_load</a>(mConf, fname, i, CStconfig::EFIT);
}

<span class="comment">//*********************************************************************</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a21"></a><a class="code" href="cpp2for_8cpp.html#68401de4f842e23373d1084aa0f69b6e">MCISMESHOK</a>(C3dMesh **mConf)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.isMeshOK()?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//*********************************************************************</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a22"></a><a class="code" href="cpp2for_8cpp.html#33465f5ff9a1203951b24064dc246ec1">MCISOK</a>(C3dMesh **mConf)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.isOK()?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// set truncation level</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a23"></a><a class="code" href="cpp2for_8cpp.html#f486ac41fa085b371d913168eb52ecb5">MCTRUNCATE</a>(C3dMesh **mConf, <span class="keywordtype">double</span> *epsTrunc)
{
  C3dMesh &amp;mc = **mConf;
  mc.truncate(*epsTrunc);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// set accuracy of coordinate transformation</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a24"></a><a class="code" href="cpp2for_8cpp.html#6e1d0504e048fe40ffffff1992b176cf">MCSETACCURACY</a>(C3dMesh **mConf, <span class="keywordtype">double</span> *epsA)
{
  C3dMesh &amp;mc = **mConf;
  mc.setAccuracy(*epsA);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// set value of B on magn. axis at cylindrical angle ficyl</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a25"></a><a class="code" href="cpp2for_8cpp.html#f68c68ff5ed395702a7d95052d83d638">MCSETB0</a>(C3dMesh **mConf, <span class="keywordtype">double</span> *b, <span class="keywordtype">double</span> *ficyl)
{
  C3dMesh &amp;mc = **mConf;
  mc.setB0(*b, *ficyl);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// set minimum value of B on magn. axis</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a26"></a><a class="code" href="cpp2for_8cpp.html#744964a9c0fd6b85df43d176179271ac">MCSETMINB0</a>(C3dMesh **mConf, <span class="keywordtype">double</span> *b)
{
  C3dMesh &amp;mc = **mConf;
  mc.setB0(*b);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Get value of B on magn. axis at cylindrical angle ficyl</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a27"></a><a class="code" href="cpp2for_8cpp.html#17aa32836461bf5f445d2204b09da04a">MCGETB0</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *ficyl)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.getB0(*ficyl);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// set average B on magn. axis</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a28"></a><a class="code" href="cpp2for_8cpp.html#48ccb1ca61b00eccaebb7bdf688c68c2">MCSETB00</a>(C3dMesh **mConf, <span class="keywordtype">double</span> *b)
{
  C3dMesh &amp;mc = **mConf;
  mc.setB00(*b);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// </span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a29"></a><a class="code" href="cpp2for_8cpp.html#d1fbde853cd08eadf87c5cb53b86bda9">MCSETICOIL</a>(C3dMesh **mConf, <span class="keywordtype">double</span> *I)
{
  C3dMesh &amp;mc = **mConf;
  mc.setIcoil(*I);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// </span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a30"></a><a class="code" href="cpp2for_8cpp.html#9919d3a8da5bcd98c0fbf28e6679ae8b">MCSETBDIRECTION</a>(C3dMesh **mConf, <span class="keywordtype">int</span> *dir)
{
  C3dMesh &amp;mc = **mConf;
  mc.setBdirection(*dir);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// </span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a31"></a><a class="code" href="cpp2for_8cpp.html#1d8acf23f37f078c5d891690bb085485">MCGETBDIRECTION</a>(C3dMesh **mConf)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.getBdirection();
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// </span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a32"></a><a class="code" href="cpp2for_8cpp.html#82e71d4b92d08b540b06138388885b5c">MCRESTOREBDIRECTION</a>(C3dMesh **mConf)
{
  C3dMesh &amp;mc = **mConf;
  mc.restoreBdirection();
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Get average B on magn. axis</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a33"></a><a class="code" href="cpp2for_8cpp.html#e82af3110f26912d63e4544acaf80307">MCGETB00</a>(C3dMesh **mConf)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.getB00();
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// get PEST-coordinates 'pest' of the point lying on the B-line at poloidal angle 'thetaStar';  </span>
<span class="comment">// the B-line is going through point pest0</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a34"></a><a class="code" href="cpp2for_8cpp.html#aa7f8ba645ca9adc11b668f669f78363">MCSFLCOORDONBLINEATTHETA</a>(C3dMesh **mConf, <span class="keyword">const</span> <span class="keywordtype">double</span> *pest0, 
                        <span class="keyword">const</span> <span class="keywordtype">double</span> *thetaStar, <span class="keywordtype">double</span> *pest)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d mgc(pest0),b,grB,grs,grT,grP;
  Vector3d pst  = mc.SFLcoordOnBlineAtTheta(mgc, *thetaStar);
  pst.copyTo(pest);   
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Get PEST gradients in cylindrical coordinates</span>
<span class="comment">// @param[in]  pest is the Boozer or PEST coordinate</span>
<span class="comment">// @param[out] mag  is the Boozer coordinates (if input file is Boozer file) or </span>
<span class="comment">//  VMEC coordinates (if input file is VMEC-wout file)</span>
<span class="comment">// @param[out] grad... are gradients at point pest</span>
<span class="comment">// mConf must be originated from Boozer or VMEC file</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a35"></a><a class="code" href="cpp2for_8cpp.html#0cc4758b56b349afff4fa5abf255aba4">MCSFLCONTRABASIS</a>(C3dMesh **mConf, <span class="keyword">const</span> <span class="keywordtype">double</span> *pest, 
                        <span class="keywordtype">double</span> *gradS,<span class="keywordtype">double</span> *gradThetaStar,<span class="keywordtype">double</span> *gradPhi,<span class="keywordtype">double</span> *mag)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d pst(pest),grS, grT, grP, mg;
  
  mc.SFLcontraBasis(pst,grS,grT, grP,mg);
 
  grS.copyTo(gradS);       <span class="comment">// copy to array grads</span>
  grT.copyTo(gradThetaStar);  
  grP.copyTo(gradPhi);    
  mg.copyTo(mag);     
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Get Boozer gradients in cylindrical coordinates</span>
<span class="comment">// u    is the Boozer coordinate</span>
<span class="comment">// mag  is the Boozer or VMEC coordinate</span>
<span class="comment">// grad... are gradients at point u</span>
<span class="comment">// mConf must be originated from Boozer or VMEC file</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a36"></a><a class="code" href="cpp2for_8cpp.html#e071bc1fa782ea899711e3be7e88933f">MCBOOZERCONTRABASIS</a>(C3dMesh **mConf, <span class="keyword">const</span> <span class="keywordtype">double</span> *u, 
                        <span class="keywordtype">double</span> *gradS,<span class="keywordtype">double</span> *gradThetaStar,<span class="keywordtype">double</span> *gradPhi,<span class="keywordtype">double</span> *mag)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d u1(u),grS, grT, grP, mg;
  
  mc.BoozerContraBasis(u1,grS,grT, grP,mg);
 
  grS.copyTo(gradS);       <span class="comment">// copy to array grads</span>
  grT.copyTo(gradThetaStar);  
  grP.copyTo(gradPhi);    
  mg.copyTo(mag);     
}


<span class="comment">//*********************************************************************</span>
<span class="comment">// Get gradients in cylindrical coordinates</span>
<span class="comment">//  gradB  = grad(|B|) </span>
<span class="comment">//  gradF  = grad(torFlux)</span>
<span class="comment">//  gradTh = grad(theta)</span>
<span class="comment">//  gradPh = grad(phi) </span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a37"></a><a class="code" href="cpp2for_8cpp.html#a48b241164bbef61c43a6f641e048773">MCGETBANDGRADIENTS</a>(C3dMesh **mConf, <span class="keywordtype">double</span> *magCoord, 
                     <span class="keywordtype">double</span> *B,<span class="keywordtype">double</span> *gradB,<span class="keywordtype">double</span> *gradF,<span class="keywordtype">double</span> *gradTh,<span class="keywordtype">double</span> *gradPh)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d mgc(magCoord),b,grB,grs,grT,grP;
  
  mc.getBandGradients(mgc,b,grB,grs,grT,grP);
  <span class="keywordtype">double</span> Fluxmax = mc.Flux(1.);
  Vector3d grF = grs*Fluxmax; <span class="comment">// grad(torFlux)</span>

  b.copyTo(B);             <span class="comment">// B=(Br,Bfi,Bz) in cyl. coordinates</span>
  grB.copyTo(gradB);       <span class="comment">// copy to array gradB</span>
  grF.copyTo(gradF);       <span class="comment">// copy to array gradF</span>
  grT.copyTo(gradTh);      <span class="comment">// grad(theta)  in cyl. coord, theta is the poloidal angle</span>
  grP.copyTo(gradPh);      <span class="comment">// grad(phi)    in cyl. coord, phi is the toroidal angle</span>
}

<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a38"></a><a class="code" href="cpp2for_8cpp.html#082c854417f3da72a16a2c1ab917b6bc" title="The method returns B and curl(B) in cylindrical coordinates.">MCGETBCURLBGRADFCYL</a>(C3dMesh **mConf, <span class="keywordtype">double</span> *u, 
                     <span class="keywordtype">double</span> *B,<span class="keywordtype">double</span> *curlB,<span class="keywordtype">double</span> *gradF)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d mgc(u),b,curl,grs;
  
  mc.getBcurlBGradscyl(mgc,b,curl,grs);
  <span class="keywordtype">double</span> Fluxmax = mc.Flux(1.);
  Vector3d grF = grs*Fluxmax; <span class="comment">// grad(torFlux)</span>

  b.copyTo(B);             <span class="comment">// B=(Br,Bfi,Bz) in cyl. coordinates</span>
  curl.copyTo(curlB);      
  grF.copyTo(gradF);       <span class="comment">// copy to array gradF</span>
}



<span class="comment">//*********************************************************************</span>
<span class="comment">//  @return grad(|B|) in cylindrical coordinates</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a39"></a><a class="code" href="cpp2for_8cpp.html#474f129356700b7c8bb51ad58c8b29b2">MCGETGRADB</a>(C3dMesh **mConf, <span class="keywordtype">double</span> *magCoord, <span class="keywordtype">double</span> *gradB)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d bz,gr;
  bz.setFrom(magCoord);   <span class="comment">// copy magCoord to vector bz</span>
  gr = mc.gradB(bz);
  gr.copyTo(gradB);       <span class="comment">// copy to array gradb</span>
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// @return covariant components of  grad(|B|) in magnetic coordinates</span>
<span class="comment">// dB/ds, dB/dtheta, dB/dphi</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a40"></a><a class="code" href="cpp2for_8cpp.html#3d5117039d430609325eafc42f387bb8">MCGETCOVAGRADB</a>(C3dMesh **mConf, <span class="keywordtype">double</span> *magCoord, <span class="keywordtype">double</span> *gradB)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d bz,gr;
  bz.setFrom(magCoord);       <span class="comment">// copy booz to vector bz</span>
  gr = mc.getCovaGradB(bz);
  gr.copyTo(gradB);       <span class="comment">// copy to array gradb</span>
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// set average B on magn. axis</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a41"></a><a class="code" href="cpp2for_8cpp.html#a6f9cb324fcb826a322386c0dc1ab15c">MCSCALEB</a>(C3dMesh **mConf, <span class="keywordtype">double</span> *factor)
{
  C3dMesh &amp;mc = **mConf;
  mc.scaleB(*factor);
}


<span class="comment">//*********************************************************************</span>
<span class="comment">// Coordinate transformation</span>
<span class="comment">// Input :</span>
<span class="comment">//  cyl=(r,fi,z) - point in cyl. coordinates</span>
<span class="comment">// Output:</span>
<span class="comment">//  magCoord=(s,theta,phi)</span>
<span class="comment">//  Bfield=(Br,Bfi,Bz) in cyl. coordinates</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a42"></a><a class="code" href="cpp2for_8cpp.html#779ef4303863c0236a5c5c854bffd73e">MCCYL2MAG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *cyl,<span class="keywordtype">double</span> *magCoord,<span class="keywordtype">double</span> *Bfield)
{
  Vector3d c,b;
  c.setFrom(cyl);            <span class="comment">// copy cyl to vector c</span>
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">if</span>(mc.cylIsInside(c) ) {   <span class="comment">// function cylIsInside returns 'TRUE' if the point lies inside LCMS</span>
    b = mc.cyl2mag(c);       <span class="comment">// b will be Vector3d(s,theta,phi)</span>
    b.copyTo(magCoord);      <span class="comment">// copy to fortran array</span>
    b = mc.getBcyl();
    b.copyTo(Bfield);        <span class="comment">// Bfield=(Br,Bfi,Bz) in cyl. coordinates</span>
  }
  <span class="keywordflow">else</span> {
    b = 0;
    b.copyTo(Bfield);
    b[0]=1e4;              <span class="comment">// point lies outside plasma, set huge value of 's' as signal</span>
    b.copyTo(magCoord);    <span class="comment">// copy to array</span>
  }
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Faster version of MCCYL2MAG, without testing whether point lies inside LCMS</span>
<span class="comment">// Coordinate transformation</span>
<span class="comment">// Input :</span>
<span class="comment">//  cyl=(r,fi,z) - point in cyl. coordinates</span>
<span class="comment">// Output:</span>
<span class="comment">//  magCoord=(s,theta,phi)</span>
<span class="comment">//  Bfield=(Br,Bfi,Bz) in cyl. coordinates</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a43"></a><a class="code" href="cpp2for_8cpp.html#19bf9733f0ecc17e09e42b8185a2815f">MCCYL2MAG2</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *cyl,<span class="keywordtype">double</span> *magCoord,<span class="keywordtype">double</span> *Bfield)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d c(cyl),b;
  b = mc.cyl2mag(c);    <span class="comment">// b is a Vector3d(s,theta,phi)</span>
  b.copyTo(magCoord);      <span class="comment">// copy to array</span>
  b = mc.getBcyl();
  b.copyTo(Bfield);        <span class="comment">// Bfield=(Br,Bfi,Bz) in cyl. coordinates</span>
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Coordinate transformation</span>
<span class="comment">// Input :</span>
<span class="comment">//  xyz -- point in cartesian coordinates</span>
<span class="comment">// Output:</span>
<span class="comment">//  magCoord=(s,theta,phi)</span>
<span class="comment">//  Bfield  in cartesian coordinates</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a44"></a><a class="code" href="cpp2for_8cpp.html#f61c29fa55fcb4c7e8443d06e34ad929">MCXYZ2MAG2</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *xyz,<span class="keywordtype">double</span> *magCoord,<span class="keywordtype">double</span> *Bfield)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d c(xyz),b;
  b = mc.xyz2mag(c);    <span class="comment">// b is a Vector3d(s,theta,phi)</span>
  b.copyTo(magCoord);      <span class="comment">// copy to array</span>
  b = mc.getBxyz();
  b.copyTo(Bfield);        <span class="comment">// Bfield=(Bx,By,Bz) in cart. coordinates</span>
}


<span class="comment">//*********************************************************************</span>
<span class="comment">// Coordinate transformation,</span>
<span class="comment">// Find label of flux surface</span>
<span class="comment">// Input :</span>
<span class="comment">//  xyz -- point in cartesian coordinates</span>
<span class="comment">// Output:</span>
<span class="comment">// function returns label of flux surface -- normalized flux 's'</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a45"></a><a class="code" href="cpp2for_8cpp.html#ae3523a8c6e368593864d5f08b8d82cf">MCXYZ2S</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *xyz)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d c(xyz);
  <span class="keywordflow">return</span> mc.xyz2s(c);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Coordinate transformation,</span>
<span class="comment">// Find label of flux surface</span>
<span class="comment">// Input :</span>
<span class="comment">//  cyl -- point in cartesian coordinates</span>
<span class="comment">// Output:</span>
<span class="comment">// function returns label of flux surface -- normalized flux 's'</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a46"></a><a class="code" href="cpp2for_8cpp.html#4f70c82f3a7c9d7d49ac5142fcb2efdc">MCCYL2S</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *cyl)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d c(cyl);
  <span class="keywordflow">return</span> mc.cyl2s(c);
}

<span class="comment">//*********************************************************************</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a47"></a><a class="code" href="cpp2for_8cpp.html#c2b946e91c55ffd5e422813c48b18e57">MCGETSBXYZ</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *xyz,<span class="keywordtype">double</span> *S,<span class="keywordtype">double</span> *B)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d c(xyz),b;
  *S=mc.xyz2s(c);
  b = mc.getBxyz();
  b.copyTo(B);               <span class="comment">// Bfield=(Bx,By,Bz) in cart. coordinates</span>
}

<span class="comment">//*********************************************************************</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a48"></a><a class="code" href="cpp2for_8cpp.html#5c3563a26e5119c8939192652168906e">MCGETSBCYL</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *cyl,<span class="keywordtype">double</span> *S,<span class="keywordtype">double</span> *B)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d c(cyl),b;
  *S=mc.cyl2s(c);
  b = mc.getBcyl();
  b.copyTo(B);               <span class="comment">// Bfield=(Br,Bfi,Bz) in cyl. coordinates</span>
}


<span class="comment">//*********************************************************************</span>
<span class="comment">// Input :</span>
<span class="comment">//  magCoord=(s,theta,phi) -- point in magnetic coordinates</span>
<span class="comment">// Output:</span>
<span class="comment">//  B  -- magnetic field  in cylindrical coordinates</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a49"></a><a class="code" href="cpp2for_8cpp.html#375f766b0ddcc089a1fa192dbffc7b90">MCGETBCYL</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *magCoord,<span class="keywordtype">double</span> *B)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d b,mag(magCoord);
  mc.NJacobian(mag);
  b = mc.getBcyl();
  b.copyTo(B);               <span class="comment">// Bfield=(Br,Bfi,Bz) in cyl. coordinates</span>
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// s to toroidal Flux</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a50"></a><a class="code" href="cpp2for_8cpp.html#eaca7f7b8c7df61859ff6cf06ab7b466">MCTORFLUX</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.Flux(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// The method returns the direction of the toroidal current, which increases </span>
<span class="comment">// the absolute value of the iota. </span>
<span class="comment">// @return 1 or -1 depending on the sign of the current </span>
<span class="comment">//         in the right-handed cylindrical coordinates system.</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a51"></a><a class="code" href="cpp2for_8cpp.html#ed0d48097a53539648f4cd4b10f5b55c">MCCURRENTSIGNTOINCREASEIOTA</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.getSignOfCurrentThatIncreasesAbsIota();
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// s to r_eff</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a52"></a><a class="code" href="cpp2for_8cpp.html#8e09aa73023016b0783713d9e72f81ad">MCREFF</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.r(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Vprime(s) == dVolume/ds</span>
<span class="comment">// Vprime is negative if (s,theta,phi)-coordinate system is left handed</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a53"></a><a class="code" href="cpp2for_8cpp.html#497a85778d88134a31a7bf8031540bc2">MCVPRIME</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.Vprime(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Volume(s)</span>
<span class="comment">// volume is negative if (s,theta,phi)-coordinate system is left handed</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a54"></a><a class="code" href="cpp2for_8cpp.html#f50ecc525d581a9bafefd93161369c5b">MCVOLUME</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.Volume(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Fraction of trapped particles on surface s</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a55"></a><a class="code" href="cpp2for_8cpp.html#2a3b5f0fb1095769dc57d3c3c24c6e67">MCFTRAPPED</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.ftrapped(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// &lt;B&gt; on surface s</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a56"></a><a class="code" href="cpp2for_8cpp.html#76321fea0005a9ddf54af8028e4ae6cf">MCBAVRG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.Bavrg(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// &lt;B^2&gt; on surface s</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a57"></a><a class="code" href="cpp2for_8cpp.html#acb0bfaa6c3e10d8dfeaca1cc6e64617">MCB2AVRG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.B2avrg(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// &lt;B^-2&gt; on surface s</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a58"></a><a class="code" href="cpp2for_8cpp.html#f5af7227c20f1a2c8ae4c659ec6d60f5">MCB_2AVRG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.B_2avrg(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// &lt;grads^2*B^-2&gt; on surface s</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a59"></a><a class="code" href="cpp2for_8cpp.html#1bcc7c2d9db940c6ea7df28482fd57cd">MCGRADS2B_2AVRG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.grads2B_2avrg(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// &lt;R^2&gt; on surface s</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a60"></a><a class="code" href="cpp2for_8cpp.html#922eb3593568237e9bd1376dd0b31e31">MCR2AVRG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.R2avrg(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// &lt;R^-2&gt; on surface s</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a61"></a><a class="code" href="cpp2for_8cpp.html#aeb1494897850d04c36961c51f765b4a">MCR_2AVRG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.R_2avrg(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a62"></a><a class="code" href="cpp2for_8cpp.html#b175fb0a0c6f1eafde443d67586fe16c">MCNEOPOLARIZATION</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.NeoPolarization(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a63"></a><a class="code" href="cpp2for_8cpp.html#f32efba8063e4e25cceb9286b2dc340f">MCNEOPOLARIZATIONPASS</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.NeoPolarizationPass(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a64"></a><a class="code" href="cpp2for_8cpp.html#18b7712367b2b81c50aaa2c3382fd8dc">MCNEOPOLARIZATIONTRAP</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.NeoPolarizationTrap(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// toroidal covariant component of B in Tesla*m</span>
<span class="comment">// Tokamak's people name it as poloidal current function</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a65"></a><a class="code" href="cpp2for_8cpp.html#38a32f3d6054b03912a91fcad99bdd8b">MCBPHI</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordtype">double</span> <a class="code" href="cpp2for_8cpp.html#43016d873124d39034edb8cd164794db">pi</a>    = 3.14159265358979323846;
  <span class="keywordtype">double</span> <a name="a66"></a><a class="code" href="namespacemathf.html#d996edbbc287b4e5f3dd072a10bd6122">twopi</a> = 2*pi;
  <span class="keywordtype">double</span> mu0   = 4e-7*pi; <span class="comment">// [N/A^2 = henry/m]</span>
  <span class="keywordtype">double</span> Bphi  = mc.Ip(*s)*mu0/twopi;
  <span class="keywordflow">return</span> Bphi;
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// poloidal current in Amp</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a67"></a><a class="code" href="cpp2for_8cpp.html#60360a668f1433d5e1e5534e8addc340">MCIPOL</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.Ip(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// toroidal current in Amp</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a68"></a><a class="code" href="cpp2for_8cpp.html#e8da69bb9d9591dd6f8cf7869acf837b">MCITOR</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.It(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// |B|</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a69"></a><a class="code" href="cpp2for_8cpp.html#36937d05f4263fb25b8c181e6988763e">MCB</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s,<span class="keywordtype">double</span> *polAngle,<span class="keywordtype">double</span> *torAngle)
{
  Vector3d magCoord(*s,*polAngle,*torAngle);
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.B(magCoord);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Calculate Jacobian in coordinates (s,theta,phi)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a70"></a><a class="code" href="cpp2for_8cpp.html#d9fa9b25cf5562962b6432db7a1cef63">MCJACOBIAN</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s,<span class="keywordtype">double</span> *polAngle,<span class="keywordtype">double</span> *torAngle)
{
  Vector3d magCoord(*s,*polAngle,*torAngle);
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.Jacobian(magCoord);
}


<span class="comment">//*********************************************************************</span>
<span class="comment">// Calculate Jacobian in coordinates (s,theta,phi)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a71"></a><a class="code" href="cpp2for_8cpp.html#50cbb6743e72d4840d516dc1a9835d52">MCBANDJACOBIAN</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s,<span class="keywordtype">double</span> *polAngle,
                                                    <span class="keywordtype">double</span> *torAngle,<span class="keywordtype">double</span> *B,<span class="keywordtype">double</span> *jac)
{
  Vector3d magCoord(*s,*polAngle,*torAngle);
  C3dMesh &amp;mc = **mConf;
  *jac = mc.Jacobian(magCoord,B);
}


<span class="comment">//*********************************************************************</span>
<span class="comment">// for A.Mishchenko</span>
<span class="comment">// Rosenbluth-Hinton residual zonal flow for tokamak geometry</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a72"></a><a class="code" href="cpp2for_8cpp.html#f97b67a23daccbb60e665a60c57c346e">MCRHPOTENCIAL</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordtype">double</span> pi    = 3.14159265358979323846;
  <span class="keywordtype">double</span> twopi = 2*pi;
  <span class="keywordtype">double</span> mu0   = 4e-7*pi; <span class="comment">// [N/A^2 = henry/m]</span>
  <span class="keywordtype">double</span> I  = mc.Ip(*s)*mu0/twopi;
  <span class="keywordtype">double</span> L  = mc.NeoPolarization(*s);
  <span class="keywordtype">double</span> R2 = mc.R2avrg(*s);
  <span class="keywordtype">double</span> B_2= mc.B_2avrg(*s);
  <span class="keywordtype">double</span> wrk = 1+I*I*L/( R2 - I*I*B_2 );
  <span class="keywordflow">return</span> 1/wrk;
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// &lt;(1-b)^0.5&gt;; b = B(s,th,phi)/Bmax(s)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a73"></a><a class="code" href="cpp2for_8cpp.html#29b52cb570f4a2137c97bfc773f19ec6">MCDB12AVRG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.db12Avrg(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// &lt;(1-b)^1.5&gt;</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a74"></a><a class="code" href="cpp2for_8cpp.html#69a30933c2111f1e17fb9075cc45a462">MCDB32AVRG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.db32Avrg(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// &lt;b(1-b)^0.5&gt;</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a75"></a><a class="code" href="cpp2for_8cpp.html#00be847bea54f274913543ec6896ab81">MCBDB12AVRG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.db12Avrg(*s)-mc.db32Avrg(*s);;
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// flux average of (b/sqrt(1-x*b)) on the surface</span>
<span class="comment">// f(s,x) = &lt;b/sqrt(1-x*b)&gt;, where 0&lt;=x&lt;=1, 0&lt;=s&lt;=1, and b=B(s,th,ph)/Bmax(s)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a76"></a><a class="code" href="cpp2for_8cpp.html#0d772ec4ad53b9564b3a3cc0c545376d">MCROPARINVAVRG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s,<span class="keywordtype">double</span> *x)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.roParInvAvrg(*s,*x);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// &lt;p&gt; -- flux average of pitch angle on the surface</span>
<span class="comment">//   p_avrg(s,x) = &lt;sqrt(1-x*B(s,th,ph)/Bmax(s))&gt;, where 0&lt;=x&lt;=1, 0&lt;=s&lt;=1,</span>
<span class="comment">// and definition of x is the following x=(1-p^2)/b, b=B/Bmax</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a77"></a><a class="code" href="cpp2for_8cpp.html#71864fc3348f318a241cf90879c6a372">MCPAVRG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s,<span class="keywordtype">double</span> *x)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.pavrg(*s,*x);
}

<span class="comment">//****************************************************************************</span>
<span class="comment">// @return Integral(from x to 1) dx'/p_avrg(s,x') ,</span>
<span class="comment">//         where p_avrg(s,x) = &lt;sqrt(1-x*B(s,th,ph)/Bmax(s))&gt; 0&lt;=x&lt;=1, 0&lt;=s&lt;=1</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a78"></a><a class="code" href="cpp2for_8cpp.html#7dab7345d4ee1596a821a4785c515874">MCINTINVPAVRG</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s,<span class="keywordtype">double</span> *x)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.integralInvPavrg(*s,*x);
}

<span class="preprocessor">#if 0 </span>
<span class="preprocessor"></span><span class="comment">//*********************************************************************</span>
<span class="comment">// fabs(Jacobian*B^2) on surface s for (s,theta,phi)-coordinates</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL MCJACOBIANB2(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.JacobianB2(*s);
}
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="comment">//*********************************************************************</span>
<span class="comment">// iota(s)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a79"></a><a class="code" href="cpp2for_8cpp.html#407f027ba77a674034874bd484f7be0c">MCIOTA</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.iota(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// iotaPrime(s)== diota/ds</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a80"></a><a class="code" href="cpp2for_8cpp.html#3c43cef4c0306dda8a6572d2c2d925a8">MCIOTAPRIME</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.iotaPrime(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// PressurePrime(s)== dP/ds</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a81"></a><a class="code" href="cpp2for_8cpp.html#ed6514308d22f2af9c7de890747ccc09">MCPRESSUREPRIME</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.pp(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Pressure(s) in Pa</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a82"></a><a class="code" href="cpp2for_8cpp.html#cc9dfac91f95bdb2e8730ff72b35fc5d">MCPRESSURE</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.pressure(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// @return normalized poloidal flux</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a83"></a><a class="code" href="cpp2for_8cpp.html#7a38734efc865053b60f4cefea55cff7">MCTORFLUX2POLFLUX</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.sPol(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// R0(s)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a84"></a><a class="code" href="cpp2for_8cpp.html#08d923506e699236df45a3efcfe21e64">MCR0</a>(C3dMesh **mConf)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.R0();
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Rmn(s)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a85"></a><a class="code" href="cpp2for_8cpp.html#e64e9fea501ab2b6f16aad75c5339641">MCRMN</a>(C3dMesh **mConf, <span class="keywordtype">int</span> *m, <span class="keywordtype">int</span> *n, <span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.Rmn_sp(*s,*m,*n);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Zmn(s)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a86"></a><a class="code" href="cpp2for_8cpp.html#721d5f0a31693b4b66dba9e6579a81c4">MCZMN</a>(C3dMesh **mConf, <span class="keywordtype">int</span> *m, <span class="keywordtype">int</span> *n, <span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.Zmn_sp(*s,*m,*n);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Phimn(s)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a87"></a><a class="code" href="cpp2for_8cpp.html#1432e04eb9d12e85f9652733bea5c145">MCFMN</a>(C3dMesh **mConf, <span class="keywordtype">int</span> *m, <span class="keywordtype">int</span> *n, <span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.Phimn_sp(*s,*m,*n);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Bmn(s)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a88"></a><a class="code" href="cpp2for_8cpp.html#85aeb605c06a11dd9bc5f436f51550e7">MCBMN</a>(C3dMesh **mConf, <span class="keywordtype">int</span> *m, <span class="keywordtype">int</span> *n, <span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.Bmn_sp(*s,*m,*n);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// BoozerBmn(s)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a89"></a><a class="code" href="cpp2for_8cpp.html#415979698fc682c612708796d232af7d">MCBOOZERBMN</a>(C3dMesh **mConf, <span class="keywordtype">int</span> *m, <span class="keywordtype">int</span> *n, <span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.BoozerBmn(*s,*m,*n);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// The method returns the average area of the cross section of the surface \e s</span>
<span class="comment">// @param s is the normalized toroidal flux.</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a90"></a><a class="code" href="cpp2for_8cpp.html#0a9aec287d91d821da84e6ef5ced21d4">MCAVERAGECROSSSECTIONAREA</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.averageCrossSectionArea(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// rminor(s)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a91"></a><a class="code" href="cpp2for_8cpp.html#5b7cc00775209d57fa4082b27b07a4e0">MCRMINOR</a>(C3dMesh **mConf)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.rminor();
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// rminor(s)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a92"></a><a class="code" href="cpp2for_8cpp.html#3624956fb9b25cb5228d5ad8c9a87a6e">MCNPERIODS</a>(C3dMesh **mConf)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.nPeriods ();
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Find intersection of the Ray with the last surface.</span>
<span class="comment">// The ray is R(t)=r0+rd*t  with t&gt;0</span>
<span class="comment">// The origin of ray must be outside of the last surface</span>
<span class="comment">//</span>
<span class="comment">// INPUT:</span>
<span class="comment">//   Real *8 R1(3)  -- the first(origin) and</span>
<span class="comment">//   Real *8 R2(3)  --   the second point of the ray (cartesian coord.)</span>
<span class="comment">// OUTPUT:</span>
<span class="comment">//   Real *8 Entry(3) -- entry point of the ray into plasma (cartesian coord.)</span>
<span class="comment">//   Real *8 Exit(3)  -- exit  point of the ray from plasma (cartesian coord.)</span>
<span class="comment">//</span>
<span class="comment"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a93"></a><a class="code" href="cpp2for_8cpp.html#f5af3773e96c504d629b7662ff07fda8" title="The method traces the Last Closed Magnetic Surface (LCMS).">MCTRACELCMS</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *R1,<span class="keywordtype">double</span> *R2,
                                                <span class="keywordtype">double</span> *Entry,<span class="keywordtype">double</span> *Exit)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d r1(R1),r2(R2); <span class="comment">// 1st and 2nd points of the ray</span>
  Vector3d r0(R1),rd(R2); <span class="comment">// origin and direction of the ray</span>
  rd  = r2-r0;            <span class="comment">// direction of the ray</span>
  rd /= rd.abs();         <span class="comment">// normalize; the ray is r(t)=r0+rd*t  with t&gt;0</span>
  Vector3d ent(0.,0.,0.), ex(0.,0.,0.); <span class="comment">// zero output</span>
  ent.copyTo(Entry);
  ex.copyTo(Exit);

  <span class="keywordflow">if</span>(!mc.isOK()) <span class="keywordflow">return</span> -10;
  <span class="keywordflow">if</span>(mc.xyzIsInside(r0)) <span class="keywordflow">return</span> -2; <span class="comment">// if TRUE then point r0 lies inside LCMS</span>

  <span class="keywordtype">double</span> dphi = 1*<a class="code" href="cpp2for_8cpp.html#2675edd2140472f1d48c6178d4052018">degree</a>; <span class="comment">// change this if you need more accurate calculations</span>

  mc.traceLast(r0,rd,dphi,dphi);

  <span class="keywordtype">int</span> size     = mc.getTraceSize();
  <span class="keyword">const</span> Vector3d *R  = mc.getTraceRxyz();
  <span class="keywordflow">if</span>(size==0) <span class="keywordflow">return</span> -1; <span class="comment">// ray does not enter in plasma</span>

  ent = R[0];  <span class="comment">// point where ray enters into plasma</span>
  ex  = R[1];  <span class="comment">// point where ray exits  plasma</span>
  ent.copyTo(Entry);
  ex.copyTo(Exit);

  <span class="keywordtype">double</span> r21 = (r2-r1).abs2();
  <span class="keywordtype">double</span> e1 = (ent-r1).abs2();
  <span class="keywordtype">double</span> x1 = (ex -r1).abs2();
<span class="comment">//  CRayTrace::freeTrace(); // ?</span>
  <span class="keywordflow">if</span>(e1&gt; r21) <span class="keywordflow">return</span> 0;  <span class="comment">// segment r1--r2 is outside plasma</span>
  <span class="keywordflow">if</span>(x1&gt; r21) <span class="keywordflow">return</span> 1;  <span class="comment">// only entry point lies on the segment r1--r2, i.e. r2 is inside plasma</span>
  <span class="keywordflow">if</span>(x1&lt;=r21) <span class="keywordflow">return</span> 2;  <span class="comment">// entry and exit points lie on the segment r1--r2</span>
  <span class="keywordflow">return</span> 0;
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Find entry point of the Ray into the plasma(last closed surface)</span>
<span class="comment">// The ray is R(t)=r0+rd*t  with t&gt;0</span>
<span class="comment">// It is assumed, that the origin of ray lies outside of the last surface</span>
<span class="comment">//</span>
<span class="comment">// INPUT:</span>
<span class="comment">//   r0, rd  -- origin and direction of the ray in cartesian coordinates</span>
<span class="comment">// OUTPUT:</span>
<span class="comment">//  entryPoint</span>
<span class="comment">//  @return  if the method succeeds, the return value is true; false otherwise.</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a94"></a><a class="code" href="cpp2for_8cpp.html#173dad6d772d9f733c8763c68b624edd">MCM3DGETRAYENTRYPOINT</a>(C3dMesh **mConf, 
                                                          <span class="keywordtype">double</span> *r0,<span class="keywordtype">double</span> *rd, <span class="keywordtype">double</span> *entryPoint)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d R0(r0),Rd(rd); <span class="comment">// origin and direction of the ray</span>
  Vector3d entry;
  <span class="keywordtype">bool</span> b = mc.M3DgetRayEntryPoint(R0,Rd,entry);
  entry.copyTo(entryPoint);
  <span class="keywordflow">return</span> b?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//****************************************************************************</span>
<span class="comment">// create border 'slast' of last contour at cylindrical angle 'ficyl'</span>
<span class="comment">// borderSize -- # of point in contour</span>
<span class="comment">// ficyl -- cylindrical angle</span>
<span class="comment">//  function returns 0 if no memory</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a95"></a><a class="code" href="cpp2for_8cpp.html#10a3f2b8db816829b866bf9b30f23974">MCCREATEBORDER</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *slast,<span class="keywordtype">double</span> *ficyl,<span class="keywordtype">int</span> *BrdSize)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordtype">bool</span> b = mc.createBorder(*slast,*ficyl,*BrdSize);
  <span class="keywordflow">return</span> b?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//****************************************************************************</span>
<span class="comment">// MCCREATEBORDER must be callled first!</span>
<span class="comment">// INPUT:</span>
<span class="comment">//  REAL*8 XYZ(3) -- point in cartesian coordinates</span>
<span class="comment">// OUTPUT:</span>
<span class="comment">//  function returns 'TRUE' if the point lies inside Border</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a96"></a><a class="code" href="cpp2for_8cpp.html#64b142026aa54980e4e8b244504a4bd6">MCISINSIDEBORDER</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *XYZ)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d xyz(XYZ);
  <span class="keywordtype">double</span> rc = sqrt(xyz.x()*xyz.x()+xyz.y()*xyz.y());
  <span class="keywordtype">double</span> fi = mc.mod2pi(atan2(xyz.y(),xyz.x()));
  <span class="keywordtype">double</span> zc = xyz.z();
  Vector3d cyl(rc,fi,zc);
  <span class="keywordtype">bool</span> b = mc.cylIsInsideBorder(cyl);
  <span class="keywordflow">return</span> b?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Get B and derivatives using</span>
<span class="comment">// Program returns B and derivatives dB/dr, dB/dfi/r, dB/dz in point cyl</span>
<span class="comment">//  Input:</span>
<span class="comment">//    Real *8 cyl(3) -- cylindrical coordinates</span>
<span class="comment">//  Output:</span>
<span class="comment">//    Real *8 B(3) -- cylindrical coordinates of B</span>
<span class="comment">//    Real *8 dBdr(3)   -- dB/dr, where dBdr(1)=dBr/dr, dBdr(2)=dBfi/dr, dBdr(3)=dBz/dr</span>
<span class="comment">//    Real *8 dBdfir(3) -- dB/dfi/r</span>
<span class="comment">//    Real *8 dBdz(3)   -- dB/dz</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a97"></a><a class="code" href="cpp2for_8cpp.html#e47a8e6c7d61c24c87764b592f7b9f58">MCGETDBCYL</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *cyl,
                                                <span class="keywordtype">double</span> *B,<span class="keywordtype">double</span> *dBdr,<span class="keywordtype">double</span> *dBdfir,<span class="keywordtype">double</span> *dBdz)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d c(cyl);
  Vector3d b,dbdr, dbdfir, dbdz, grads;
  <span class="keywordtype">double</span> s = mc.getdBGradscyl(c,b,dbdr,dbdfir,dbdz,grads);
  b.copyTo(B);
  dbdr.copyTo(dBdr);
  dbdfir.copyTo(dBdfir);
  dbdz.copyTo(dBdz);
}

<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a98"></a><a class="code" href="cpp2for_8cpp.html#0ae47f35921187163aa60a792475c513" title="The method returns magnetic coordinates of the point of a field line, that passes...">MCCOORDFIELDLINE</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *mixCoord0,
                                                      <span class="keywordtype">double</span> *fcyl,<span class="keywordtype">double</span> *magCoord)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d mxCoord(mixCoord0);
  Vector3d mag = mc.mixCoordFieldLine(mxCoord, *fcyl);
  mag.copyTo(magCoord);
}

<span class="comment">//****************************************************************************</span>
<span class="comment">//****************************************************************************</span>
<span class="comment">//****************************************************************************</span>
<span class="comment">//The function creates 3d-mesh.</span>
<span class="comment">// The function tabulates the magnetic field, the flux surface label, and grad(s) in cylindrical coordinates.</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a99"></a><a class="code" href="cpp2for_8cpp.html#db2e81daf0e7988ead35477508f0da74">MCCREATEMESH</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *dr,<span class="keywordtype">double</span> *dz,<span class="keywordtype">double</span> *dfi)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordtype">bool</span> b = mc.createMesh(*dr,*dz,*dfi);
  <span class="keywordflow">return</span> b?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//The function creates 3d-mesh.</span>
<span class="comment">// The function tabulates the magnetic field, the flux surface label, and grad(s) in cylindrical coordinates.</span>
<span class="comment">// Stellarator symmetry is used</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a100"></a><a class="code" href="cpp2for_8cpp.html#e415c302f0d9207b201d6f5eeccf2e9f">MCCREATEMESHUSINGSYMMETRY</a>(C3dMesh **mConf,
                                                              <span class="keywordtype">double</span> *dr,<span class="keywordtype">double</span> *dz,<span class="keywordtype">double</span> *dfi)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordtype">bool</span> b = mc.createMeshUsingSymmetry(*dr,*dz,*dfi);
  <span class="keywordflow">return</span> b?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// get B and derivatives dB/dx,dB/dy,dB/dz in point xyz</span>
<span class="comment">//  Input:</span>
<span class="comment">//    Real *8 xyz(3) -- cartesian coordinates</span>
<span class="comment">//  Output:</span>
<span class="comment">//    Real *8 B(3) -- cartesian coordinates of B</span>
<span class="comment">//    Real *8 dBdx(3) -- dB/dx, where dBdx(1)=dBx/dx, dBdx(2)=dBy/dx, dBdx(3)=dBx/dx</span>
<span class="comment">//    Real *8 dBdy(3) -- dB/dy</span>
<span class="comment">//    Real *8 dBdz(3) -- dB/dz</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a101"></a><a class="code" href="cpp2for_8cpp.html#c66a00ec8397d1491bbb97bd8d9d6333">MCM3DGETDBXYZ</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *xyz,
                                                   <span class="keywordtype">double</span> *B,<span class="keywordtype">double</span> *dBdx,<span class="keywordtype">double</span> *dBdy,<span class="keywordtype">double</span> *dBdz)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d R(xyz);
  Vector3d dbdx, dbdy, dbdz;

  Vector3d b=mc.M3DgetdBxyz(R,dbdx,dbdy,dbdz);
  b.copyTo(B);
  dbdx.copyTo(dBdx);
  dbdy.copyTo(dBdy);
  dbdz.copyTo(dBdz);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Get B and derivatives using 3d mesh interpolation</span>
<span class="comment">// Program returns B and derivatives dB/dr, dB/dfi/r, dB/dz in point cyl</span>
<span class="comment">//  Input:</span>
<span class="comment">//    Real *8 cyl(3) -- cylindrical coordinates</span>
<span class="comment">//  Output:</span>
<span class="comment">//    Real *8 B(3) -- cylindrical coordinates of B</span>
<span class="comment">//    Real *8 dBdr(3)   -- dB/dr, where dBdr(1)=dBr/dr, dBdr(2)=dBfi/dr, dBdr(3)=dBz/dr</span>
<span class="comment">//    Real *8 dBdfir(3) -- dB/dfi/r</span>
<span class="comment">//    Real *8 dBdz(3)   -- dB/dz</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a102"></a><a class="code" href="cpp2for_8cpp.html#0d0c036b37a689ff82bc14fc96b7591d">MCM3DGETDBCYL</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *cyl,<span class="keywordtype">double</span> *B,
                                                   <span class="keywordtype">double</span> *dBdr,<span class="keywordtype">double</span> *dBdfir,<span class="keywordtype">double</span> *dBdz)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d R(cyl);
  Vector3d dbdr, dbdfir, dbdz;

  Vector3d b=mc.M3DgetdBcyl(R,dbdr,dbdfir,dbdz);
  b.copyTo(B);
  dbdr.copyTo(dBdr);
  dbdfir.copyTo(dBdfir);
  dbdz.copyTo(dBdz);
}


<span class="comment">//*********************************************************************</span>
<span class="comment">// Coordinate transformation using 3d mesh interpolation</span>
<span class="comment">// Find label of flux surface</span>
<span class="comment">// Input :</span>
<span class="comment">//  xyz -- point in cartesian coordinates</span>
<span class="comment">// Output:</span>
<span class="comment">// function returns label of flux surface -- normalized flux 's'</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a103"></a><a class="code" href="cpp2for_8cpp.html#2ab181215221e6387d69552b69ed0d65">MCM3DXYZ2S</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *xyz)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d c(xyz);
  <span class="keywordflow">return</span> mc.M3Dxyz2s(c);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Coordinate transformation using 3d mesh interpolation</span>
<span class="comment">// Find label of flux surface</span>
<span class="comment">// Input :</span>
<span class="comment">//  cyl -- point in cartesian coordinates</span>
<span class="comment">// Output:</span>
<span class="comment">// function returns label of flux surface -- normalized flux 's'</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a104"></a><a class="code" href="cpp2for_8cpp.html#a2596fd63699bdb7131607ce307a8d34">MCM3DCYL2S</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *cyl)
{
  Vector3d c(cyl);
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.M3Dcyl2s(c);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//   function retuns grad(s) = Vector3d(ds/dr, ds/dfi/r, ds/dz)</span>
<span class="comment">//  Input:</span>
<span class="comment">//    Real *8 cyl(3) -- cylindrical coordinates</span>
<span class="comment">//  Output:</span>
<span class="comment">//    Real *8 grads(3) -- Vector3d(ds/dr, ds/dfi/r, ds/dz)</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a105"></a><a class="code" href="cpp2for_8cpp.html#7e39383f658da0510ee2df8ef4a12f2b">MCM3DGETGRADS</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *cyl,<span class="keywordtype">double</span> *grads)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d R(cyl);
  Vector3d g=mc.M3DgetGrads(R);
  g.copyTo(grads);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//   function retuns grad(s) in cartesian coordinates</span>
<span class="comment">//  Input:</span>
<span class="comment">//    Real *8 xyz(3) -- cartesian coordinates</span>
<span class="comment">//  Output:</span>
<span class="comment">//    Real *8 grads(3) --  grads in cartesian coordinates</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a106"></a><a class="code" href="cpp2for_8cpp.html#0d66355c147122987e29d31a22ac3c17">MCM3DGETGRADSXYZ</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *xyz,<span class="keywordtype">double</span> *grads)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d R(xyz);
  Vector3d g=mc.M3DgetGradsxyz(R);
  g.copyTo(grads);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//   function retuns grad(s) in cartesian coordinates</span>
<span class="comment">//  Input:</span>
<span class="comment">//    Real *8 xyz(3) -- cartesian coordinates</span>
<span class="comment">//  Output:</span>
<span class="comment">//    Real *8 grads(3) --  grads in cartesian coordinates</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a107"></a><a class="code" href="cpp2for_8cpp.html#23049bc379a1f0aa08742a3729d1093d">MCGETGRADSXYZ</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *xyz,<span class="keywordtype">double</span> *grads)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d R(xyz);
  <span class="keywordtype">double</span> s=mc.xyz2s(R);
  Vector3d g = mc.getGradsxyz();
  g.copyTo(grads);
}
<span class="comment">//****************************************************************************</span>
<span class="comment">// INPUT:</span>
<span class="comment">//  REAL*8 XYZ(3) -- point in cartesian coordinates</span>
<span class="comment">// OUTPUT:</span>
<span class="comment">//  function returns 'TRUE' if the point lies inside LCMS</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a108"></a><a class="code" href="cpp2for_8cpp.html#c9b7de749a97d81aecf42962e8aeee64">MCXYZISINSIDE</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *XYZ)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d xyz(XYZ);
  <span class="keywordtype">bool</span> b = mc.xyzIsInside(xyz);
  <span class="keywordflow">return</span> b?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//****************************************************************************</span>
<span class="comment">// INPUT:</span>
<span class="comment">//  REAL*8 cyl(3) -- point in cartesian coordinates</span>
<span class="comment">// OUTPUT:</span>
<span class="comment">//  function returns 'TRUE' if the point lies inside LCMS</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a109"></a><a class="code" href="cpp2for_8cpp.html#12665118b207320710f6187d53550f93">MCCYLISINSIDE</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *cyl)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d c(cyl);
  <span class="keywordtype">bool</span> b = mc.cylIsInside(c);
  <span class="keywordflow">return</span> b?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// save mesh file</span>
<span class="comment">// *.bin4; *.bin8 are supported</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a110"></a><a class="code" href="cpp2for_8cpp.html#eb24d75e418b7ed854741ac33b17493f">MCWRITEMESH</a>(C3dMesh **mConf,<span class="keywordtype">char</span> * fname,<span class="keywordtype">int</span> i)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordtype">char</span> *fn = <span class="keyword">new</span> <span class="keywordtype">char</span>[i+2];
  <a class="code" href="cpp2for_8cpp.html#643dc94e8c4da8dd5e46205950d9aba4">strtrim</a>(fn,fname,i);
  <span class="keywordtype">bool</span> ok= mc.writeMesh(fn);
  <span class="keywordflow">if</span>(!ok) cerr &lt;&lt; <span class="stringliteral">"mcWriteMesh: writing error\n"</span>;
  <span class="keyword">delete</span> fn;
  <span class="keywordflow">return</span> ok?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}


<span class="comment">//*********************************************************************</span>
<span class="comment">// save magnetic coordinate file</span>
<span class="comment">// *.bin4; *.bin8 are supported</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a111"></a><a class="code" href="cpp2for_8cpp.html#60c4b8c6e8c3730b9bcec271eea6ad1f">MCWRITE</a>(C3dMesh **mConf,<span class="keywordtype">char</span> * fname,<span class="keywordtype">int</span> i)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordtype">char</span> *fn = <span class="keyword">new</span> <span class="keywordtype">char</span>[i+2];
  <a class="code" href="cpp2for_8cpp.html#643dc94e8c4da8dd5e46205950d9aba4">strtrim</a>(fn,fname,i);
  <span class="keywordtype">bool</span> ok= mc.write(fn);
  <span class="keywordflow">if</span>(!ok) cerr &lt;&lt; <span class="stringliteral">"mcWrite: writing error\n"</span>;
  <span class="keyword">delete</span> fn;
  <span class="keywordflow">return</span> ok?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// get B and derivatives dB/dx,dB/dy,dB/dz in point xyz</span>
<span class="comment">//  Input:</span>
<span class="comment">//    Real *8 xyz(3) -- cartesian coordinates</span>
<span class="comment">//  Output:</span>
<span class="comment">//    Real *8 s (normalized toroidal flux), which normally satisfies \b 0&lt;=s&lt;=1;</span>
<span class="comment">//            s&gt;1 means that point lies outside from LCMS; </span>
<span class="comment">//    Real *8 B(3) -- cartesian coordinates of B</span>
<span class="comment">//    Real *8 dB(9)</span>
<span class="comment">//</span>
<span class="comment">//    dB(1:3) -- dB/dx, where dB(1)=dBx/dx, dB(2)=dBy/dx, dB(3)=dBz/dx</span>
<span class="comment">//    dB(4:6) -- dB/dy, where dB(4)=dBx/dy, dB(5)=dBy/dy, dB(6)=dBz/dy</span>
<span class="comment">//    dB(7:9) -- dB/dz, where dB(7)=dBx/dz, dB(8)=dBy/dz, dB(9)=dBz/dz</span>
<span class="comment">// </span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a112"></a><a class="code" href="cpp2for_8cpp.html#0ae3bb03e56a71f56e508e834ebc9b52">MCGETALLXYZ</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *xyz,<span class="keywordtype">double</span> *s,
                                                    <span class="keywordtype">double</span> *B,<span class="keywordtype">double</span> *gradS,<span class="keywordtype">double</span> *dB)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d R(xyz);
  Vector3d b,dbdx,dbdy,dbdz,gs;

  *s = mc.getdBGradsxyz(R,b,dbdx,dbdy,dbdz,gs);
  b.copyTo(B);
  gs.copyTo(gradS);
<span class="comment">//#define DB(row,col)  dB[(col)*3 + (row)] // Fortran77 style addressing</span>
  dbdx.copyTo(dB);  <span class="comment">// dB(i,j) = dB_i/dx_j</span>
  dbdy.copyTo(dB+3);
  dbdz.copyTo(dB+6);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// get B and derivatives dB/dx,dB/dy,dB/dz in point xyz</span>
<span class="comment">//  Input:</span>
<span class="comment">//    Real *8 xyz(3) -- cartesian coordinates</span>
<span class="comment">//  Output:</span>
<span class="comment">//    Real *8 B(3) -- cartesian coordinates of B</span>
<span class="comment">//    Real *8 dB(9)</span>
<span class="comment">//    dB(1:3) -- dB/dx, where dB(1)=dBx/dx, dB(2)=dBy/dx, dB(3)=dBz/dx</span>
<span class="comment">//    dB(4:6) -- dB/dy, where dB(4)=dBx/dy, dB(5)=dBy/dy, dB(6)=dBz/dy</span>
<span class="comment">//    dB(7:9) -- dB/dz, where dB(7)=dBx/dz, dB(8)=dBy/dz, dB(9)=dBz/dz</span>
<span class="comment">//</span>
<span class="comment"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a113"></a><a class="code" href="cpp2for_8cpp.html#3e2c8e877120672f3dd76f4886839b51">MCM3DGETALLXYZ</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *xyz,<span class="keywordtype">double</span> *S,
                                                    <span class="keywordtype">double</span> *B,<span class="keywordtype">double</span> *gradS,<span class="keywordtype">double</span> *dB)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d R(xyz);
  Vector3d b,dbdx,dbdy,dbdz,gs;

  *S = mc.M3DgetdBGradsxyz(R,b,dbdx,dbdy,dbdz,gs);
  b.copyTo(B);
  gs.copyTo(gradS);
<span class="comment">//#define DB(row,col)  dB[(col)*3 + (row)] // Fortran77 style addressing</span>
  dbdx.copyTo(dB);  <span class="comment">// dB(i,j) = dB_i/dx_j</span>
  dbdy.copyTo(dB+3);
  dbdz.copyTo(dB+6);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Coordinate transformation using 3d mesh interpolation</span>
<span class="comment">// Find label of flux surface and B</span>
<span class="comment">// Input :</span>
<span class="comment">//  xyz -- point in cartesian coordinates</span>
<span class="comment">// Output:</span>
<span class="comment">// function returns label of flux surface -- normalized flux 's'</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a114"></a><a class="code" href="cpp2for_8cpp.html#63710dfcda7fd2f764a97943779a5692">MCM3DGETSBXYZ</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *xyz,<span class="keywordtype">double</span> *S,<span class="keywordtype">double</span> *B)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d R(xyz);

  *S = mc.M3Dxyz2s(R);
  (mc.M3DgetBxyz(R)).copyTo(B);
}

<span class="comment">//*********************************************************************</span>
<span class="comment"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a115"></a><a class="code" href="cpp2for_8cpp.html#dc4e4ce66b9ebbaa7c32f7a597e6c0ba">MCM3DGETALLCYL</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *cyl,<span class="keywordtype">double</span> *S,
                                                    <span class="keywordtype">double</span> *B,<span class="keywordtype">double</span> *gradS,<span class="keywordtype">double</span> *gradB)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d R(cyl);
  Vector3d b,dbdr,dbdfir,dbdz,gs;

  *S = mc.M3DgetdBGradscyl(R,b,dbdr,dbdfir,dbdz,gs);
  b.copyTo(B);
  gs.copyTo(gradS);
  dbdr.copyTo(gradB);  <span class="comment">// dB(i,j) = dB_i/dx_j</span>
  dbdfir.copyTo(gradB+3);
  dbdz.copyTo(gradB+6);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// Coordinate transformation using 3d mesh interpolation</span>
<span class="comment">// Find label of flux surface and B</span>
<span class="comment">// Input :</span>
<span class="comment">//  xyz -- point in cartesian coordinates</span>
<span class="comment">// Output:</span>
<span class="comment">// function returns label of flux surface -- normalized flux 's'</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a116"></a><a class="code" href="cpp2for_8cpp.html#b4059341e784eba4a89a7f1d69bce82e">MCM3DGETSBCYL</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *cyl,<span class="keywordtype">double</span> *S,<span class="keywordtype">double</span> *B)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d R(cyl);
  *S = mc.M3Dcyl2s(R);
  <span class="keywordflow">if</span>(*S&lt;0) *S = mc.cyl2s(R);
  (mc.M3DgetBcyl(R)).copyTo(B);
}


<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a117"></a><a class="code" href="cpp2for_8cpp.html#68766f42eab5ece18850245dadfc75a5">MCGETBMINMAX</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s,<span class="keywordtype">double</span> *Bmin,<span class="keywordtype">double</span> *Bmax )
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">if</span>(*s&gt;=0) {
    *Bmin=mc.Bmin(*s);
    *Bmax=mc.Bmax(*s);
  }
  <span class="keywordflow">else</span> {
    *Bmin=mc.Bmin();  <span class="comment">// global minimum</span>
    *Bmax=mc.Bmax();
  }
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a118"></a><a class="code" href="cpp2for_8cpp.html#ee5a0cced18d33e6f2f0fb2ba5aaf8d2">MCGETBMINMAXGLOBAL</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *Bmin,<span class="keywordtype">double</span> *Bmax )
{
  C3dMesh &amp;mc = **mConf;
  *Bmin=mc.Bmin();  <span class="comment">// global minimum</span>
  *Bmax=mc.Bmax();
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a119"></a><a class="code" href="cpp2for_8cpp.html#aeb2ba6c7723696fd8a5e3ebcd026544">MCBMIN</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">if</span>(*s&gt;=0) <span class="keywordflow">return</span> mc.Bmin(*s);
  <span class="keywordflow">else</span>      <span class="keywordflow">return</span> mc.Bmin();
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a120"></a><a class="code" href="cpp2for_8cpp.html#b9d3e29bca38bea4e541bfae7c947db1">MCBMAX</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">if</span>(*s&gt;=0) <span class="keywordflow">return</span> mc.Bmax(*s);
  <span class="keywordflow">else</span>      <span class="keywordflow">return</span> mc.Bmax();
}


<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a121"></a><a class="code" href="cpp2for_8cpp.html#18327e81a491bf12fecc7c1c2f78a06e">MCRAXIS</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *ficyl)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> (mc.mixcoord2cyl(0,0,*ficyl))[0];
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a122"></a><a class="code" href="cpp2for_8cpp.html#0c92068701fcc7919285dd23c556a19a">MCMAG2CYL</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *magCoord,<span class="keywordtype">double</span> *cyl)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d mag(magCoord);
  Vector3d c = mc.mag2cyl(mag);
  c.copyTo(cyl);               <span class="comment">// copy to array cyl</span>
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a123"></a><a class="code" href="cpp2for_8cpp.html#3f32407f19ba81f82c9a44c97a840218">MCMAG2XYZ</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *magCoord,<span class="keywordtype">double</span> *cyl)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d mag(magCoord);
  Vector3d c = mc.mag2xyz(mag);
  c.copyTo(cyl);               <span class="comment">// copy to array cyl</span>
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// input:</span>
<span class="comment">//    mixCoord = (s,theta,ficyl) coincides with magnetic for VMEC and tokamak symmetry flux coordinates</span>
<span class="comment">//    mixCoord = (s,theta,ficyl) s,theta coincide with boozer coordinates for bc-files</span>
<span class="comment">//     ficyl is the cylindrical angle</span>
<span class="comment">// output:</span>
<span class="comment">//    cyl  cylindrical coordinates</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a124"></a><a class="code" href="cpp2for_8cpp.html#484809c04f13b076d70e8e47fffb202d">MCMIXCOORD2CYL</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *mixCoord,<span class="keywordtype">double</span> *cyl)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d mCoord(mixCoord);
  Vector3d c = mc.mixcoord2cyl(mCoord);
  c.copyTo(cyl);               <span class="comment">// copy to array cyl</span>
}

<span class="comment">//*********************************************************************</span>
<span class="comment">// input:</span>
<span class="comment">//    mixCoord = (s,theta,ficyl) coincides with magnetic for VMEC and tokamak symmetry flux coordinates</span>
<span class="comment">//    mixCoord = (s,theta,ficyl) s,theta coincide with boozer coordinates for bc-files</span>
<span class="comment">// output:</span>
<span class="comment">//    xyz  cartesian coordinates</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a125"></a><a class="code" href="cpp2for_8cpp.html#ce4cfc1d39bdf81f9c508fc7691a91be">MCMIXCOORD2XYZ</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *mixCoord,<span class="keywordtype">double</span> *xyz)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d mCoord(mixCoord);
  Vector3d r = mc.mixcoord2xyz(mCoord);
  r.copyTo(xyz);               <span class="comment">// copy to array xyz</span>
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//  Return the sizes of a rectangle circumscribed about the cross section of the surface s at cylindrical angle fi.</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a126"></a><a class="code" href="cpp2for_8cpp.html#e0591744d03d2a3836f53c3a5a2e99cc">MCGETEXTENT</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s,<span class="keywordtype">double</span> *fi,
                                                 <span class="keywordtype">double</span> *Rmin,<span class="keywordtype">double</span> *Rmax,<span class="keywordtype">double</span> *Zmin,<span class="keywordtype">double</span> *Zmax)
{
  C3dMesh &amp;mc = **mConf;
  mc.getExtent(*Rmin,*Rmax,*Zmin,*Zmax,*s,*fi);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//  Return the sizes of a rectangle circumscribed about the cross section of the LCMS.</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a127"></a><a class="code" href="cpp2for_8cpp.html#5603f2e6821afbf4075fe37e81395326">MCGETEXTENTLCMS</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *Rmin,<span class="keywordtype">double</span> *Rmax,
                                                     <span class="keywordtype">double</span> *Zmin,<span class="keywordtype">double</span> *Zmax)
{
  C3dMesh &amp;mc = **mConf;
  mc.getExtentLCMS(*Rmin,*Rmax,*Zmin,*Zmax);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a128"></a><a class="code" href="cpp2for_8cpp.html#0f2680e814a83a7551eb99fe99a50b50">MCM3DSETSMAX</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *sMax)
{
  C3dMesh &amp;mc = **mConf;
  mc.setsMax(*sMax);
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">double</span> STDCALL <a name="a129"></a><a class="code" href="cpp2for_8cpp.html#b8de926280835547666b97fbee3e3fee">MCM3DGETSMAX</a>(C3dMesh **mConf)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.getsMax();
}

<span class="comment">//*********************************************************************</span>
<span class="comment"></span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a130"></a><a class="code" href="cpp2for_8cpp.html#a4767e373314843ac41fba978153db0e" title="The function transforms the current magnetic configuration to new volume or to new...">MCSAVEREDUCED</a>(C3dMesh **mConf, <span class="keywordtype">int</span> *nsmax, <span class="keywordtype">double</span> *eps, <span class="keywordtype">int</span> *appendWrite, 
                                                  <span class="keywordtype">char</span> * fname,<span class="keywordtype">int</span> i)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordtype">char</span> *fn = <span class="keyword">new</span> <span class="keywordtype">char</span>[i+2];
  <a class="code" href="cpp2for_8cpp.html#643dc94e8c4da8dd5e46205950d9aba4">strtrim</a>(fn,fname,i);
   
  <span class="keywordtype">double</span>  truncSav =mc.truncate();
  mc.truncate(*eps);

  <span class="keywordtype">bool</span> append = appendWrite!=0;

  <span class="keywordtype">bool</span> ok= mc.writeasciiReduced(fn, *nsmax,0,1,<span class="keyword">true</span>,<span class="keyword">false</span>,<span class="keyword">false</span>,append);

  <span class="keywordflow">if</span>(!ok) cerr &lt;&lt; <span class="stringliteral">"mcSaveReduced: writing error\n"</span>;
  mc.truncate(truncSav);
  <span class="keyword">delete</span> fn;
  <span class="keywordflow">return</span> ok?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//*********************************************************************</span>
<span class="comment"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a131"></a><a class="code" href="cpp2for_8cpp.html#2d33cb2cff7fb985f42d17254ff24a51" title="The methods return the bounce-averade gradB drift velocity of trapped particles averaged...">MCGETGFACTORS</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s,<span class="keywordtype">double</span> *Gw,<span class="keywordtype">double</span> *Gs,<span class="keywordtype">double</span> *Gv)
{
  C3dMesh &amp;mc = **mConf;
  *Gw = mc.Gw(*s);
  *Gs = mc.Gs(*s);
  *Gv = mc.Gv(*s);
}

<span class="comment">//*********************************************************************</span>
<span class="comment"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a132"></a><a class="code" href="cpp2for_8cpp.html#27915aa91a0d31f75388bed6721767a1" title="The method returns the effective helical ripple for  transport.">MCGETEPSEFF</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *s,<span class="keywordtype">double</span> *epsEffGraz,
                                                      <span class="keywordtype">double</span> *epsEffDkes,<span class="keywordtype">double</span> *epsEffVmec)
{
  C3dMesh &amp;mc = **mConf;
  *epsEffGraz = mc.epsEffGraz(*s);
  *epsEffDkes = mc.epsEffDkes(*s);
  *epsEffVmec = mc.epsEffVmec(*s);
}


<span class="comment">//*********************************************************************</span>
<span class="comment"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a133"></a><a class="code" href="cpp2for_8cpp.html#57cd8204ec1c3e49c4689e0b323a6064" title="The method sets parameters for calculating eps_eff and Gw, Gs, Gv.">MCEPSEFFPARAMS</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *xmin,<span class="keywordtype">double</span> *xmax, <span class="keywordtype">int</span> *maxPoints)
{
  C3dMesh &amp;mc = **mConf;
  mc.epsEffSetXeffParam(*xmin, *xmax, *maxPoints);
}

<span class="comment">//*********************************************************************</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a134"></a><a class="code" href="cpp2for_8cpp.html#1de313736cae1405ee713d186898343b">MCISVMEC</a>(C3dMesh **mConf)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.isVmecCoordinates()?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//*********************************************************************</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">int</span> STDCALL <a name="a135"></a><a class="code" href="cpp2for_8cpp.html#132597f99ac3e23162648d50d028cc14">MCISTOKPEST</a>(C3dMesh **mConf)
{
  C3dMesh &amp;mc = **mConf;
  <span class="keywordflow">return</span> mc.isTokamakSymmetryFluxCoordinates()?<a class="code" href="cpp2for_8cpp.html#cbf03ae8c87e9012e8672dafcd43fe17">True</a>:<a class="code" href="cpp2for_8cpp.html#c24531c0377dc8fa65d2023bd88f2fe2">False</a>;
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a136"></a><a class="code" href="cpp2for_8cpp.html#5e5f2a0376dca86b4d5d6b4516e9df76">MCPEST2VMEC</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *pest,<span class="keywordtype">double</span> *vmec)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d p(pest);
  Vector3d v = mc.Pest2Vmec(p);
  v.copyTo(vmec);              
}

<span class="comment">//****************************************************************************</span>
<span class="comment">// @param[in]  vmec is the  VMEC coordinates =(s,theta,phi)</span>
<span class="comment">// @param[out] pest  is the PEST coordinates</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a137"></a><a class="code" href="cpp2for_8cpp.html#d717b9d2829c503cd28a64dfc77b9163">MCVMEC2PEST</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *vmec,<span class="keywordtype">double</span> *pest)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d v(vmec);
  Vector3d p = mc.Vmec2Pest(v);
  p.copyTo(pest);              
}

<span class="comment">//*********************************************************************</span>
<span class="comment">//</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a138"></a><a class="code" href="cpp2for_8cpp.html#5dc9e47f35ac06d417780550b051c3fa">MCBOOZER2VMEC</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *boozer,<span class="keywordtype">double</span> *vmec)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d b(boozer);
  Vector3d v = mc.Boozer2Vmec(b);
  v.copyTo(vmec);               <span class="comment">// copy to array vmec</span>
}

<span class="comment">//****************************************************************************</span>
<span class="comment">// @param[in]  vmec is the  VMEC coordinates =(s,theta,phi)</span>
<span class="comment">// @param[out] boozer is the  Boozer coordinates</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a139"></a><a class="code" href="cpp2for_8cpp.html#99d24a19f69e145f5a5f76ae5e3e9111">MCVMEC2BOOZER</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *vmec,<span class="keywordtype">double</span> *boozer)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d v(vmec);
  Vector3d b = mc.Vmec2Boozer(v);
  b.copyTo(boozer);               <span class="comment">// copy to array boozer</span>
}

<span class="comment">//****************************************************************************</span>
<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a140"></a><a class="code" href="cpp2for_8cpp.html#98352df6a8acf514138f21d6c067412f">SETARGV</a>(<span class="keywordtype">int</span> n,<span class="keywordtype">char</span> * opt, <span class="keywordtype">int</span> i)
{
  <span class="keywordtype">char</span> *op = <span class="keyword">new</span> <span class="keywordtype">char</span>[i+2];
  <a class="code" href="cpp2for_8cpp.html#643dc94e8c4da8dd5e46205950d9aba4">strtrim</a>(op,opt,i);
  <span class="keyword">static</span> std::vector&lt;std::string&gt; argv;
  std::string str=op;

  <span class="keywordflow">if</span>(n==0) {
    argv.clear();
    argv.push_back(str);
  }
  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(n&gt;0) {
    argv.push_back(str);
  }
  <span class="keywordflow">else</span> {
    <span class="keyword">const</span> <span class="keywordtype">char</span> **arg = <span class="keyword">new</span> <span class="keyword">const</span> <span class="keywordtype">char</span>*[argv.size()];
    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;argv.size(); i++) {
      arg[i] = argv[i].c_str();
    }
    <span class="comment">// call c_main(argv.size(),arg);</span>
  }
}


<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a141"></a><a class="code" href="cpp2for_8cpp.html#cf0d6e134a246d4a1813bbd4c92fa3dc" title="The method returns the parallel adiabatic invariant with the integral taken between...">MCJINVARIANT</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *mag,<span class="keywordtype">double</span> *dphi, <span class="keywordtype">int</span> *iotaDenominator, 
                                                      <span class="keywordtype">double</span> *Jinv, <span class="keywordtype">double</span> *Tbounce, <span class="keywordtype">double</span> *Bt)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d v(mag);
  std::vector&lt;double&gt; j = mc.Jinvariant(v,*dphi,*iotaDenominator);
  Jinv[0] = j[0];
  Jinv[1] = j[1];
  Jinv[2] = j[2];
  *Tbounce = j[3];
  *Bt      = j[4];
}

<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a142"></a><a class="code" href="cpp2for_8cpp.html#62f7b51a335021438f5ff00b95f1d9dd" title="The method returns the magnetic coordinates of the point (that belongs to the given...">MCGETMAGCOORDATB</a>(C3dMesh **mConf,<span class="keywordtype">double</span> *mag,<span class="keywordtype">double</span> *Bt,<span class="keywordtype">double</span> *magBt)
{
  C3dMesh &amp;mc = **mConf;
  Vector3d v(mag);
  Vector3d m = mc.getMagCoordAtB(v, *Bt);
  m.copyTo(magBt);               <span class="comment">// copy to array magBt</span>
}

<span class="keyword">extern</span> <span class="stringliteral">"C"</span> <a class="code" href="mconf__matlab_8h.html#fddebb4c234739845eee0fac51a51932">WINDLLEXPORT</a> <span class="keywordtype">void</span> STDCALL <a name="a143"></a><a class="code" href="cpp2for_8cpp.html#7e18366b989d9efb312e49061e46c7f5" title="If yesNo&amp;gt;0 then the method forces to use Jacobian=dX/dFlux*(dX/dtheta^dX/dphi)...">MCUSEMIXEDPRODUCTFORJACOBIAN</a>(C3dMesh **mConf,<span class="keywordtype">int</span> *yesNo)
{
  C3dMesh &amp;mc = **mConf;
  mc.useMixedProductForJacobian(*yesNo&gt;0?<span class="keyword">true</span>:<span class="keyword">false</span>);
}
</pre></div> </div>
    <p><a class="anchor" name="BottomOfPage"></a></p>
    <div class="no-print" align="right">
      <table border="0">
        <tr>
        <td>[ <a class="el" href="#TopOfPage">top</a> ]</td>
        <td>[ <a class="el" href="javascript:history.back(-1);"><b>back</b></a> ]</td> 
        </tr>
      </table>
    </div>
    <hr class="separator">
    <div class="ippAddress" align="right">
      <table border="0">
        <tr>
          <td class="ippAddress">13 Oct 2021 &nbsp;&nbsp;&nbsp;&nbsp;</td>
          <td class="ippAddress">
            <a href="http://www.ipp.mpg.de"><img src="IPP.png" alt="www.ipp.mpg.de" border="0"></a>
          </td>
          <td class="ippAddress">
            <!-- Copyright &copy; 2005-2008<br> --> 
            Max-Planck-Institut<br>f&uuml;r Plasmaphysik
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>
</body>
</html>
