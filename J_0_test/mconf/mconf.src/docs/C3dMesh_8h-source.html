<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>MConf: C3dMesh.h Source File</title>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <meta name="author" content="Yuriy Turkin">
  <meta name="keywords" content="stellarator, w7x, W7-X, W7-X software">
  <meta name="description" content="W7-X Software">
  <link href="myCss.css" rel="stylesheet" type="text/css">
  <link href="tabs.css" rel="stylesheet" type="text/css" >
</head>
<body>
  <div class="centerAll" id="TopOfPage">
    <div class="bodyForAll">
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_8a58aa3034da50da28943871e9137c86.html">include</a>
  </div>
</div>
<div class="contents">
<h1>C3dMesh.h</h1><a href="C3dMesh_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef MC_C3DMESH_</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define MC_C3DMESH_</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include "<a class="code" href="threadtypes_8h.html">threadtypes.h</a>"</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include "<a class="code" href="CRayTrace_8h.html">CRayTrace.h</a>"</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include "<a class="code" href="CArray1d_8h.html">CArray1d.h</a>"</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include "<a class="code" href="CArray3d_8h.html">CArray3d.h</a>"</span>
<a name="l00008"></a>00008 
<a name="l00009"></a><a class="code" href="namespaceMConf.html">00009</a> <span class="keyword">namespace </span>MConf {
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="comment">//****************************************************************************</span>
<a name="l00012"></a>00012 <span class="comment">//                          2004-2005,   Author: yuriy.turkin@ipp.mpg.de</span>
<a name="l00013"></a>00013 <span class="comment">// Magnetic configuration of a stellarator</span>
<a name="l00014"></a>00014 <span class="comment">// C3dMesh is derived from CStconfig and CRayTrace classes.</span>
<a name="l00015"></a>00015 <span class="comment">//  C3dMesh is used for</span>
<a name="l00016"></a>00016 <span class="comment">// Goal:</span>
<a name="l00017"></a>00017 <span class="comment">// 1. Tabulate magnetic field, flux label, grad(s) on 3d-mesh</span>
<a name="l00018"></a>00018 <span class="comment">//    in cylindrical coordinates.</span>
<a name="l00019"></a>00019 <span class="comment">// 2. Then use sequential cubic interpolation to find the magnetic field</span>
<a name="l00020"></a>00020 <span class="comment">//    in arbitrary space point.</span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00048"></a><a class="code" href="classMConf_1_1C3dMesh.html">00048</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classMConf_1_1C3dMesh.html" title="This class tabulates magnetic field, flux surface label, grad(s) on a 3d-mesh in...">C3dMesh</a> : <span class="keyword">public</span> <a class="code" href="classMConf_1_1CRayTrace.html" title="Find intersections of straight ray with the flux surfaces, this class is obsolete...">CRayTrace</a> {
<a name="l00049"></a>00049   <span class="keywordtype">bool</span> meshOK;        
<a name="l00050"></a>00050   <span class="keywordtype">double</span> BnormMesh;   
<a name="l00051"></a>00051   <span class="keywordtype">double</span> B0new;       
<a name="l00052"></a>00052   <span class="keywordtype">double</span> B0mesh;      
<a name="l00053"></a>00053   <span class="keywordtype">double</span> cfi [4],cr [4],cz [4];  
<a name="l00054"></a>00054   <span class="keywordtype">double</span> cfid[4],crd[4],czd [4]; 
<a name="l00055"></a>00055   <span class="keywordtype">double</span> Rmin, Rmax, Zmin, Zmax, Fmin, Fmax;   
<a name="l00056"></a>00056   <span class="keywordtype">double</span> dR;                  
<a name="l00057"></a>00057   <span class="keywordtype">double</span> dZ;                  
<a name="l00058"></a>00058   <span class="keywordtype">double</span> dFi;                 
<a name="l00059"></a>00059   <span class="keywordtype">double</span> edR, edZ, edFi;      
<a name="l00060"></a>00060   <span class="keywordtype">double</span> sMax;                
<a name="l00061"></a>00061   <span class="keywordtype">double</span> truncationLevel;     
<a name="l00062"></a>00062   <span class="keywordtype">double</span> epsALevel;           
<a name="l00063"></a>00063   <span class="keywordtype">int</span> i0;                     
<a name="l00064"></a>00064   <span class="keywordtype">int</span> j0;                     
<a name="l00065"></a>00065   <span class="keywordtype">int</span> k0;                     
<a name="l00066"></a>00066   <span class="keywordtype">int</span> nR;                     
<a name="l00067"></a>00067   <span class="keywordtype">int</span> nZ;                     
<a name="l00068"></a>00068   <span class="keywordtype">int</span> nFi;                    
<a name="l00069"></a>00069   <a class="code" href="classMConf_1_1CArray1d.html">CArray1d&lt;double&gt;</a> R;   
<a name="l00070"></a>00070   <a class="code" href="classMConf_1_1CArray1d.html">CArray1d&lt;double&gt;</a> Z;   
<a name="l00071"></a>00071   <a class="code" href="classMConf_1_1CArray1d.html">CArray1d&lt;double&gt;</a> Fi;  
<a name="l00072"></a>00072 
<a name="l00073"></a>00073   <a class="code" href="classMConf_1_1CArray3d.html">CArray3d&lt;Vector3d&gt;</a> mgrads;     
<a name="l00074"></a>00074   <a class="code" href="classMConf_1_1CArray3d.html">CArray3d&lt;Vector3d&gt;</a> mgradB;     
<a name="l00075"></a>00075   <a class="code" href="classMConf_1_1CArray3d.html">CArray3d&lt;Vector3d&gt;</a> mBfield;    
<a name="l00076"></a>00076   <a class="code" href="classMConf_1_1CArray3d.html">CArray3d&lt;double&gt;</a>   mNormFlux;  
<a name="l00077"></a>00077   <a class="code" href="classMConf_1_1CArray3d.html">CArray3d&lt;char&gt;</a>     mWhere;     
<a name="l00078"></a>00078 <span class="comment">//CArray3d&lt;double&gt;   mJacobian;  ///&lt; mesh array double mJacobian(-1:nFi,nRc,nZc),2nd and 3rd dimentions depend on 1st</span>
<a name="l00079"></a>00079   <a class="code" href="classMConf_1_1CArray2d.html">CArray2d&lt;Vector3d&gt;</a> sMaxSurface;
<a name="l00080"></a>00080   <span class="keywordtype">double</span> shift;
<a name="l00081"></a>00081 
<a name="l00082"></a>00082   <span class="keywordtype">bool</span>   hasGradB;            
<a name="l00083"></a>00083   <span class="keywordtype">bool</span>   fullMesh;            
<a name="l00084"></a>00084   <span class="keywordtype">bool</span>   useSymmetry;         
<a name="l00085"></a>00085   <span class="keywordtype">bool</span>   tokamakSymmetry;     
<a name="l00086"></a>00086   <span class="keywordtype">bool</span>   symmetryActivated;   
<a name="l00087"></a>00087   <span class="keywordtype">bool</span>   doPositionCheck;     
<a name="l00088"></a>00088   <span class="keywordtype">bool</span>   doDivergenceCorrection;
<a name="l00089"></a>00089   <a class="code" href="threadtypes_8h.html#a88a5f4b2504d4f7799911938c624249">uiMutex</a> meshMutex;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="keyword">public</span>:
<a name="l00094"></a><a class="code" href="classMConf_1_1C3dMesh.html#320c1820b44d8d63b0afe426e1be3870">00094</a>   <a class="code" href="classMConf_1_1C3dMesh.html" title="This class tabulates magnetic field, flux surface label, grad(s) on a 3d-mesh in...">C3dMesh</a> * <a class="code" href="classMConf_1_1C3dMesh.html#320c1820b44d8d63b0afe426e1be3870" title="The method creates a clone of C3dMesh using operator new.">clone</a>() {
<a name="l00095"></a>00095     <a class="code" href="classMConf_1_1C3dMesh.html" title="This class tabulates magnetic field, flux surface label, grad(s) on a 3d-mesh in...">C3dMesh</a> *mc = <span class="keyword">new</span> <a class="code" href="classMConf_1_1C3dMesh.html" title="This class tabulates magnetic field, flux surface label, grad(s) on a 3d-mesh in...">C3dMesh</a>;
<a name="l00096"></a>00096     *mc = *<span class="keyword">this</span>; 
<a name="l00097"></a>00097     <span class="keywordflow">return</span> mc;
<a name="l00098"></a>00098   }
<a name="l00100"></a>00100   <a class="code" href="classMConf_1_1C3dMesh.html#6f48b0982e685960e61af4924e3fd998" title="The constructor creates an empty instance of C3dMesh.">C3dMesh</a>();
<a name="l00102"></a><a class="code" href="classMConf_1_1C3dMesh.html#91406971ad7c7bc2fab2606fa8e69c32">00102</a>   <span class="keyword">virtual</span> <a class="code" href="classMConf_1_1C3dMesh.html#91406971ad7c7bc2fab2606fa8e69c32" title="The destructor is a virtual method that frees all memory used.">~C3dMesh</a>() {
<a name="l00103"></a>00103     freeMesh();};
<a name="l00108"></a><a class="code" href="classMConf_1_1C3dMesh.html#5d867e153060ed9f1ebfb437b56adf47">00108</a>   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1C3dMesh.html#5d867e153060ed9f1ebfb437b56adf47" title="The method loads the 3d-mesh and/or magnetic configuration stored in the file fname...">load</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>) { <span class="keywordflow">return</span> <a class="code" href="classMConf_1_1C3dMesh.html#5d867e153060ed9f1ebfb437b56adf47" title="The method loads the 3d-mesh and/or magnetic configuration stored in the file fname...">load</a>(fname,<a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c605159e8a4c32319fd69b5d151369d93" title="file-format types, for internal use">CStconfig::UNDEFINED</a> );}  
<a name="l00109"></a>00109   <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1C3dMesh.html#5d867e153060ed9f1ebfb437b56adf47" title="The method loads the 3d-mesh and/or magnetic configuration stored in the file fname...">load</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>, <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c">CStconfig::fileFormat</a> fmt);
<a name="l00111"></a><a class="code" href="classMConf_1_1C3dMesh.html#01a5dcb5ff3f1be025394cbfe73e2ab7">00111</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1C3dMesh.html#01a5dcb5ff3f1be025394cbfe73e2ab7" title="The method returns true if no error occurs during last operation.">isMeshOK</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> meshOK;};
<a name="l00113"></a>00113   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1C3dMesh.html#35b2149d53ae6ac2af6371468dccb162" title="This method frees internal mesh arrays.">clearMesh</a>();
<a name="l00115"></a>00115   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1C3dMesh.html#ae048282c7011eedc2e0492f6421ea73" title="This method frees all internal arrays (including base classes) and makes this object...">clear</a>();
<a name="l00117"></a>00117   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1C3dMesh.html#8c7fb59fa5a46f796228b09fe762e39e" title="Restore initial value of the magnetic field.">restoreB0</a>();              <span class="comment">// restore initial value of the magnetic field on axis</span>
<a name="l00120"></a>00120 <span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1C3dMesh.html#aee132c29464033ed12721f9c0a757b8" title="Set minimum magnetic field on magnetic axis equals B.">setB0</a>(<span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>);              <span class="comment">// Set minimum magnetic field on axis equals B</span>
<a name="l00124"></a>00124 <span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1C3dMesh.html#aee132c29464033ed12721f9c0a757b8" title="Set minimum magnetic field on magnetic axis equals B.">setB0</a>(<span class="keywordtype">double</span> <a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>,<span class="keywordtype">double</span> ficyl); <span class="comment">// Set magnetic field on axis equals B at the cyl angle ficyl</span>
<a name="l00127"></a>00127 <span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1C3dMesh.html#7bd05b577d1a08f199916d7fddb1bec0" title="Set B00-component of magnetic field on magnetic axis.">setB00</a>(<span class="keywordtype">double</span> B00);
<a name="l00130"></a>00130   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1C3dMesh.html#a262287c61a35463a336f1cc418d4fbe" title="Set scaling factor for value of the magnetic field.">scaleB</a>(<span class="keywordtype">double</span> multiplier);
<a name="l00133"></a>00133   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1C3dMesh.html#5576892ac3c9b050c67d37450cc0da2a" title="Set the Ipol value of the coil currents at LCMS.">setIcoil</a>(<span class="keywordtype">double</span> I);
<a name="l00135"></a>00135   <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1C3dMesh.html#0d24cdb7d9afc0c670e31173a01bd238" title="Get the scaling factor for the magnetic field value.">getBscaleFactor</a>();
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="preprocessor">#if 0</span>
<a name="l00140"></a>00140 <span class="preprocessor">  virtual void setAverageBphi0(double Bphi0);</span>
<a name="l00141"></a>00141 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00146"></a><a class="code" href="classMConf_1_1C3dMesh.html#27dea5c9b0fff409872059eb21c560d4">00146</a> <span class="preprocessor">  void setsMax(double smax) { sMax=smax&lt;1.01?1.3:smax;};</span>
<a name="l00150"></a><a class="code" href="classMConf_1_1C3dMesh.html#12c474a2f8f0b877ab53d11f366b906d">00150</a> <span class="preprocessor">  double getsMax() const { return sMax;};</span>
<a name="l00179"></a>00179 <span class="preprocessor">  bool createMesh(double dr,double dz,double dfi,int numThreads=8);</span>
<a name="l00205"></a>00205 <span class="preprocessor">  bool createMeshUsingSymmetry(double dr,double dz,double dfi,int numThreads=4);</span>
<a name="l00215"></a>00215 <span class="preprocessor">  bool writeMesh(const char * fname) const;</span>
<a name="l00216"></a>00216 <span class="preprocessor"></span>
<a name="l00218"></a>00218   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1C3dMesh.html#b2ede1ed80da3d2c7c93cdfe83244081">writeMeshAscii</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>) <span class="keyword">const</span>;
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 <span class="comment">// Methods to retrieve data from the mesh</span>
<a name="l00222"></a>00222 <span class="comment"></span>
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 
<a name="l00230"></a>00230   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1C3dMesh.html#59c4c40d4c15abea7e79b32539ac8e87" title="The method tests whether the point cyl lies inside sMax.">M3DcylIsInsideMesh</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl, <span class="keywordtype">double</span> * distance=NULL) <span class="keyword">const</span>;
<a name="l00238"></a>00238   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1C3dMesh.html#d65aa4e2c0e4f0de1a1ad37d0a2abd82" title="The method tests whether the point xyz lies inside sMax.">M3DxyzIsInsideMesh</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz, <span class="keywordtype">double</span> * distance=NULL) <span class="keyword">const</span>;
<a name="l00246"></a><a class="code" href="classMConf_1_1C3dMesh.html#161698d0057dd1163d811f00b4df267d">00246</a>   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1C3dMesh.html#161698d0057dd1163d811f00b4df267d" title="The method enables the test of a point position before data retrieving.">M3DpositionTestOn</a>()  {doPositionCheck=<span class="keyword">true</span>;};
<a name="l00251"></a><a class="code" href="classMConf_1_1C3dMesh.html#977cf5f5cc7d97900c5dc896c1f27213">00251</a>   <span class="keywordtype">void</span> <a class="code" href="classMConf_1_1C3dMesh.html#977cf5f5cc7d97900c5dc896c1f27213" title="The method disables the test of a point position.">M3DpositionTestOff</a>() {doPositionCheck=<span class="keyword">false</span>;};
<a name="l00254"></a><a class="code" href="classMConf_1_1C3dMesh.html#ddba4f02b93fb70421920db9e7b9ed2b">00254</a>   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1C3dMesh.html#ddba4f02b93fb70421920db9e7b9ed2b" title="The method returns true if position test is enabled.">M3DpositionTest</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> doPositionCheck;};
<a name="l00262"></a>00262   <span class="keywordtype">bool</span> <a class="code" href="classMConf_1_1C3dMesh.html#258a40409ce2c81a972f8cb1c529f67f" title="The method traces the Last Closed Magnetic Surface (LCMS).">M3DgetRayEntryPoint</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;r0,<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;rd,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;entryPoint) <span class="keyword">const</span>;
<a name="l00270"></a>00270   <span class="keywordtype">double</span>   <a class="code" href="classMConf_1_1C3dMesh.html#37df81d7a97fb2d81e89ddbb2b6f07ce" title="The method finds the flux label s which corresponds to the point in space.">M3Dcyl2s</a>   (<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl) <span class="keyword">const</span>;     <span class="comment">// map cylindrical coordinates to normalized flux</span>
<a name="l00278"></a>00278 <span class="comment"></span>  <span class="keywordtype">double</span>   <a class="code" href="classMConf_1_1C3dMesh.html#dc34221e1e82bcc6f3984b61e8ef0ae2" title="The method finds the flux label s which corresponds to the point in space.">M3Dxyz2s</a>   (<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz) <span class="keyword">const</span>;     <span class="comment">// map cartesian  coordinates  to normalized flux</span>
<a name="l00283"></a>00283 <span class="comment"></span>  <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1C3dMesh.html#a4a436881f9ec3c6c21a5e9d12559af8" title="The method returns cylindrical B-vector.">M3DgetBcyl</a> (<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl) <span class="keyword">const</span>;     <span class="comment">// B-vector in cylindrical coord. in point cyl</span>
<a name="l00289"></a>00289 <span class="comment"></span>  <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1C3dMesh.html#a4a436881f9ec3c6c21a5e9d12559af8" title="The method returns cylindrical B-vector.">M3DgetBcyl</a> (<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<span class="keywordtype">double</span> &amp;s) <span class="keyword">const</span>;     <span class="comment">// B-vector in cylindrical coord. in point cyl</span>
<a name="l00294"></a>00294 <span class="comment"></span>  <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1C3dMesh.html#9ad0dd50318ce2f4ae0fda193957566e" title="The method returns cartesian B-vector.">M3DgetBxyz</a> (<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz) <span class="keyword">const</span>;     <span class="comment">// B-vector in cartesian coord.  in point xyz(cartesian)</span>
<a name="l00300"></a>00300 <span class="comment"></span>  <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1C3dMesh.html#9ad0dd50318ce2f4ae0fda193957566e" title="The method returns cartesian B-vector.">M3DgetBxyz</a> (<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz,<span class="keywordtype">double</span> &amp;s) <span class="keyword">const</span>;
<a name="l00308"></a>00308   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1C3dMesh.html#ff0574674993ae93555d10af47b29c5f" title="The method returns cylindrical vectors B and partial derivatives of B.">M3DgetdBcyl</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdr,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdfir,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdz) <span class="keyword">const</span>;
<a name="l00316"></a>00316   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1C3dMesh.html#e0e18e75be8844083ce3ee17d3ce1e86" title="The method returns cartesian vectors B and partial derivatives of B.">M3DgetdBxyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdx,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdy,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdz) <span class="keyword">const</span>;
<a name="l00329"></a>00329   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1C3dMesh.html#71879732252c84647109347096ceb495" title="The method returns cartesian vectors B, partial derivatives of B, and grad(s).">M3DgetdBGradsxyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdx,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdy, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdz, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;grads) <span class="keyword">const</span>;
<a name="l00342"></a>00342   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1C3dMesh.html#20e686891392933dfd0d605ad9421e36" title="The method returns cylindrical vectors B, partial derivatives of B, and grad(s).">M3DgetdBGradscyl</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdr,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdfir,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dBdz,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;grads) <span class="keyword">const</span>;
<a name="l00346"></a>00346   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1C3dMesh.html#294650ccff3331e1b1f351ca094b9452" title="The method returns cylindrical vector grad(s).">M3DgetGrads</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl) <span class="keyword">const</span>;
<a name="l00350"></a>00350   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1C3dMesh.html#0eec257a4783b89565dac1f6b4907d72" title="The method returns cartesian vector grad(s).">M3DgetGradsxyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz) <span class="keyword">const</span>;
<a name="l00354"></a>00354   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1C3dMesh.html#a65c1018f3e3b97c9515a17ac6ecc998" title="The method returns cylindrical vector grad(B).">M3DgetGradB</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl) <span class="keyword">const</span>; 
<a name="l00358"></a>00358   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1C3dMesh.html#71cb83a073518c6003c0839fec5d9108" title="The method returns cartesian vector grad(B).">M3DgetGradBxyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz) <span class="keyword">const</span>; 
<a name="l00369"></a>00369   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1C3dMesh.html#c0faacf2c02789181e1d3abe2d605f0d" title="The method returns cylindrical vectors B, grad(|B|), and grad(s).">M3DgetBandGradB</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#8815b83783c9f05c322d3946bb07c2ed" title="The method returns grad(|B|).">gradB</a>, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;grads) <span class="keyword">const</span>;
<a name="l00380"></a>00380   <span class="keywordtype">double</span> <a class="code" href="classMConf_1_1C3dMesh.html#f477cc1773c86ea3b2a3a568f6f3a52f" title="The method returns Cartesian vectors B, grad(|B|), and grad(s).">M3DgetBandGradBxyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;<a class="code" href="classMConf_1_1CStconfig.html#8815b83783c9f05c322d3946bb07c2ed" title="The method returns grad(|B|).">gradB</a>, <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;grads) <span class="keyword">const</span>;
<a name="l00381"></a>00381   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1C3dMesh.html#bd1b304773347c839f40081ff2fa5a34">M3Dgetdgradscyl</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dgradsdr,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dgradsdfir,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dgradsdz) <span class="keyword">const</span>;
<a name="l00382"></a>00382   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> <a class="code" href="classMConf_1_1C3dMesh.html#8653b885038504844a9c1ad1279cc1c9">M3Dgetdgradsxyz</a>(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dgradsdx,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dgradsdy,<a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;dgradsdz) <span class="keyword">const</span>;
<a name="l00383"></a>00383   
<a name="l00384"></a>00384   
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 <span class="keyword">private</span>:
<a name="l00389"></a>00389   <span class="keywordtype">void</span> freeMesh();
<a name="l00392"></a>00392   <span class="keywordtype">bool</span> resize(<span class="keywordtype">bool</span> array3d=<span class="keyword">true</span>);
<a name="l00395"></a>00395   <span class="keywordtype">bool</span> createCut(<span class="keywordtype">int</span> iCyl, <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> &amp;mc);
<a name="l00398"></a>00398   <a class="code" href="threadtypes_8h.html#0e2ab56acc0c195ad32fc075d0e7f9ff">uiThread</a> createMeshPlanes(<span class="keywordtype">int</span> i1, <span class="keywordtype">int</span> i2, <span class="keywordtype">bool</span> thread, <a class="code" href="classMConf_1_1CStconfig.html" title="Magnetic configuration of a stellarator.">CStconfig</a> &amp;mc);
<a name="l00400"></a>00400   <span class="keywordtype">void</span> copyCuts();
<a name="l00401"></a>00401   <span class="keyword">static</span> <a class="code" href="threadtypes_8h.html#64f23513b88ced6e007800b42e9f8fe3">uiThreadFunc</a> solveInThread (<span class="keywordtype">void</span> *A);
<a name="l00404"></a>00404   <span class="keywordtype">bool</span> FindMeshCoordinates(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl, <span class="keywordtype">bool</span> noDerivatives=<span class="keyword">false</span>);
<a name="l00407"></a>00407   <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c">fileFormat</a> getfileformat(<span class="keyword">const</span> <span class="keywordtype">char</span> * fullname,<span class="keyword">const</span> <span class="keywordtype">char</span> *nam,<span class="keyword">const</span> <span class="keywordtype">char</span> *ext) <span class="keyword">const</span>;
<a name="l00410"></a>00410   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">bool</span> loadMeshbin(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>, T szType, <a class="code" href="classMConf_1_1CStconfig.html#76ccb82f4fe649df3933c92031a0369c">fileFormat</a> fmt);
<a name="l00413"></a>00413   <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">bool</span> writeMeshbin(<span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="classMConf_1_1CStconfig.html#aff3bb08bb5fea4b00ee7f62650c8138" title="The method returns the name of the file loaded.">fname</a>, T szType) <span class="keyword">const</span>;
<a name="l00415"></a>00415   <span class="keywordtype">bool</span> hasNeighbourInside(<span class="keywordtype">int</span> iCyl,<span class="keywordtype">int</span> j,<span class="keywordtype">int</span> k) <span class="keyword">const</span>;
<a name="l00417"></a>00417   <span class="keywordtype">bool</span> createMeshEx(<span class="keywordtype">double</span> dr,<span class="keywordtype">double</span> dz,<span class="keywordtype">double</span> df,<span class="keywordtype">double</span> fi1,<span class="keywordtype">double</span> fi2,<span class="keywordtype">int</span> numThreads);
<a name="l00418"></a>00418 
<a name="l00419"></a>00419   <span class="keywordtype">bool</span> CreateSmaxSurface();
<a name="l00420"></a>00420 
<a name="l00421"></a>00421 
<a name="l00422"></a>00422 <span class="keyword">private</span>:  <span class="comment">// disabled methods</span>
<a name="l00423"></a>00423   <span class="comment">// not used; obsolete </span>
<a name="l00425"></a>00425 <span class="comment"></span>
<a name="l00426"></a>00426   <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> M3DgetGrads1(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl) <span class="keyword">const</span>;   <span class="comment">// grad(s)</span>
<a name="l00430"></a>00430 <span class="comment"></span>  <span class="keywordtype">bool</span> M3DcylIsInside(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;cyl); <span class="comment">// check whether point lies inside LCMS, cyl (cylindrical coord.)</span>
<a name="l00434"></a>00434 <span class="comment"></span>  <span class="keywordtype">bool</span> M3DxyzIsInside(<span class="keyword">const</span> <a class="code" href="classMConf_1_1Vector3d.html" title="This class provides 3d-vector type.">Vector3d</a> &amp;xyz); <span class="comment">// check whether point lies inside LCMS, xyz (cartesian coord.)</span>
<a name="l00436"></a>00436 <span class="comment"></span>  <span class="keywordtype">bool</span> isFullMesh()<span class="keyword"> const </span>{<span class="keywordflow">return</span> meshOK?fullMesh:<span class="keyword">false</span>;};
<a name="l00438"></a>00438   <span class="keywordtype">double</span> getFimin()<span class="keyword"> const </span>{<span class="keywordflow">return</span> fullMesh?0:Fmin;};
<a name="l00440"></a>00440   <span class="keywordtype">double</span> getFimax()<span class="keyword"> const </span>{<span class="keywordflow">return</span> fullMesh?<a class="code" href="classMConf_1_1CStconfig.html#909ffd84606c7ce005c63fd884ed691d">twopi</a>:Fmax;};
<a name="l00445"></a>00445 <span class="preprocessor">#if 0</span>
<a name="l00452"></a>00452 <span class="preprocessor">#endif</span>
<a name="l00453"></a>00453 <span class="preprocessor"></span>  <span class="keywordtype">void</span> M3DBdivergenceCorrectionOn()  {doDivergenceCorrection=<span class="keyword">true</span>;};
<a name="l00456"></a>00456   <span class="keywordtype">void</span> M3DBdivergenceCorrectionOff() {doDivergenceCorrection=<span class="keyword">false</span>;};
<a name="l00457"></a>00457   <span class="keywordtype">void</span> M3DdivergenceFree(<span class="keyword">const</span> Vector3d &amp;cyl,Vector3d &amp;<a class="code" href="classMConf_1_1CStconfig.html#71ca6daedc947973fdb6538af01c17aa" title="The function returns B=sum_mn B_mn(s)*cos(m*theta-n*Np*phi).">B</a>,Vector3d &amp;dBdr,Vector3d &amp;dBdfir,Vector3d &amp;dBdz) <span class="keyword">const</span>;
<a name="l00459"></a>00459 
<a name="l00465"></a>00465 };
<a name="l00466"></a>00466 
<a name="l00467"></a>00467 };   <span class="comment">//namespace MConf</span>
<a name="l00468"></a>00468 
<a name="l00469"></a>00469 <span class="preprocessor">#endif</span>
</pre></div></div>
    <p><a class="anchor" name="BottomOfPage"></a></p>
    <div class="no-print" align="right">
      <table border="0">
        <tr>
        <td>[ <a class="el" href="#TopOfPage">top</a> ]</td>
        <td>[ <a class="el" href="javascript:history.back(-1);"><b>back</b></a> ]</td> 
        </tr>
      </table>
    </div>
    <hr class="separator">
    <div class="ippAddress" align="right">
      <table border="0">
        <tr>
          <td class="ippAddress">13 Oct 2021 &nbsp;&nbsp;&nbsp;&nbsp;</td>
          <td class="ippAddress">
            <a href="http://www.ipp.mpg.de"><img src="IPP.png" alt="www.ipp.mpg.de" border="0"></a>
          </td>
          <td class="ippAddress">
            <!-- Copyright &copy; 2005-2008<br> --> 
            Max-Planck-Institut<br>f&uuml;r Plasmaphysik
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>
</body>
</html>
